{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./web/app/themes/saigonsiblings/resources/assets/js/app.js","webpack:///./node_modules/@stimulus/webpack-helpers/dist/index.js","webpack:///./web/app/themes/saigonsiblings/resources/assets/js/controllers/gdpr_controller.js","webpack:///./node_modules/ev-emitter/ev-emitter.js","webpack:///./web/app/themes/saigonsiblings/resources/assets/js/controllers/modal_controller.js","webpack:///./node_modules/outlayer/outlayer.js","webpack:///./node_modules/outlayer/item.js","webpack:///./web/app/themes/saigonsiblings/resources/assets/js/controllers/gallery-grid_controller.js","webpack:///./node_modules/get-size/get-size.js","webpack:///./node_modules/remove-focus-outline/outline.js","webpack:///./node_modules/@stimulus/core/dist/src/event_listener.js","webpack:///./node_modules/@stimulus/core/dist/src/dispatcher.js","webpack:///./node_modules/@stimulus/core/dist/src/action_descriptor.js","webpack:///./node_modules/@stimulus/core/dist/src/action.js","webpack:///./node_modules/@stimulus/core/dist/src/binding.js","webpack:///./node_modules/@stimulus/mutation-observers/dist/src/element_observer.js","webpack:///./node_modules/@stimulus/mutation-observers/dist/src/attribute_observer.js","webpack:///./node_modules/@stimulus/multimap/dist/src/set_operations.js","webpack:///./node_modules/@stimulus/multimap/dist/src/multimap.js","webpack:///./node_modules/@stimulus/multimap/dist/src/indexed_multimap.js","webpack:///./node_modules/@stimulus/mutation-observers/dist/src/token_list_observer.js","webpack:///./node_modules/@stimulus/mutation-observers/dist/src/value_list_observer.js","webpack:///./node_modules/@stimulus/core/dist/src/binding_observer.js","webpack:///./node_modules/@stimulus/core/dist/src/context.js","webpack:///./node_modules/@stimulus/core/dist/src/definition.js","webpack:///./node_modules/@stimulus/core/dist/src/module.js","webpack:///./node_modules/@stimulus/core/dist/src/data_map.js","webpack:///./node_modules/@stimulus/core/dist/src/selectors.js","webpack:///./node_modules/@stimulus/core/dist/src/target_set.js","webpack:///./node_modules/@stimulus/core/dist/src/scope.js","webpack:///./node_modules/@stimulus/core/dist/src/scope_observer.js","webpack:///./node_modules/@stimulus/core/dist/src/router.js","webpack:///./node_modules/@stimulus/core/dist/src/schema.js","webpack:///./node_modules/@stimulus/core/dist/src/application.js","webpack:///./node_modules/@stimulus/core/dist/src/target_properties.js","webpack:///./node_modules/@stimulus/core/dist/src/controller.js","webpack:///./node_modules/fizzy-ui-utils/utils.js","webpack:///./web/app/themes/saigonsiblings/resources/assets/js/controllers/audio_controller.js","webpack:///./web/app/themes/saigonsiblings/resources/assets/js/controllers/jump-menu_controller.js","webpack:///./node_modules/masonry-layout/masonry.js","webpack:///./web/app/themes/saigonsiblings/resources/assets/js/controllers sync \\.js$","webpack:///./node_modules/js-cookie/src/js.cookie.js","webpack:///./web/app/themes/saigonsiblings/resources/assets/js/controllers/slideshow_controller.js","webpack:///./web/app/themes/saigonsiblings/resources/assets/js/controllers/nav-mobile_controller.js","webpack:///./node_modules/imagesloaded/imagesloaded.js","webpack:///./node_modules/desandro-matches-selector/matches-selector.js","webpack:///./node_modules/retinajs/dist/retina.min.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","application","Application","start","context","require","load","keys","map","identifier","logicalName","match","replace","identifierForContextKey","controllerConstructor","default","definitionForModuleAndIdentifier","definitionForModuleWithContextAndKey","filter","definitionsFromContext","retina","Cookies","this","show","set","expires","hide","element","classList","remove","removeAttribute","add","setAttribute","Controller","window","EvEmitter","proto","on","eventName","listener","events","_events","listeners","indexOf","push","once","onceEvents","_onceEvents","off","length","index","splice","emitEvent","args","slice","onceListeners","apply","allOff","event","preventDefault","modalId","currentTarget","dataset","modal","document","getElementById","focus","data","has","keyCode","type","factory","getSize","utils","Item","console","jQuery","noop","GUID","instances","Outlayer","options","queryElement","getQueryElement","$element","extend","constructor","defaults","option","id","outlayerGUID","_create","_getOption","layout","error","namespace","containerStyle","position","initLayout","originLeft","originTop","resize","resizeContainer","transitionDuration","hiddenStyle","opacity","transform","visibleStyle","subclass","Parent","SubClass","arguments","opts","oldOption","compatOptions","undefined","horizontal","layoutInstant","reloadItems","stamps","stamp","style","bindResize","items","_itemize","children","elems","itemElems","_filterFindItemElements","item","filterFindElements","itemSelector","getItemElements","_resetLayout","_manageStamps","isInstant","_isLayoutInited","layoutItems","_init","size","_getMeasurement","measurement","elem","querySelector","HTMLElement","_getItemsForLayout","_layoutItems","_postLayout","isIgnored","_emitCompleteOnItems","queue","forEach","_getItemLayoutPosition","isLayoutInstant","_processLayoutQueue","x","y","updateStagger","obj","_positionItem","stagger","time","matches","num","unit","parseFloat","msUnits","getMilliseconds","goTo","moveTo","_getContainerSize","_setContainerMeasure","width","height","measure","isWidth","elemSize","isBorderBox","paddingLeft","paddingRight","borderLeftWidth","borderRightWidth","paddingBottom","paddingTop","borderTopWidth","borderBottomWidth","Math","max","_this","onComplete","dispatchEvent","count","doneCount","tick","emitArgs","concat","$event","Event","trigger","ignore","getItem","unignore","_find","unstamp","removeFrom","querySelectorAll","makeArray","_getBoundingRect","_manageStamp","boundingRect","getBoundingClientRect","_boundingRect","left","top","right","bottom","_getElementOffset","thisRect","marginLeft","marginTop","marginRight","marginBottom","handleEvent","addEventListener","isResizeBound","unbindResize","removeEventListener","onresize","debounceMethod","needsResizeLayout","innerWidth","addItems","appended","reveal","prepended","previousItems","revealItemElements","getItems","hideItemElements","removeItems","destroy","removeData","Layout","htmlInit","bridget","ms","docElemStyle","documentElement","transitionProperty","transition","transformProperty","transitionEndEvent","WebkitTransition","vendorProperties","transitionDelay","_transn","ingProperties","clean","onEnd","css","method","elemStyle","prop","getPosition","getComputedStyle","isOriginLeft","isOriginTop","xValue","yValue","layoutSize","isNaN","layoutPosition","xPadding","xProperty","xResetProperty","getXValue","yPadding","yProperty","yResetProperty","getYValue","isHorizontal","percentPosition","_transitionTo","curX","curY","didNotMove","setPosition","isTransitioning","transX","transY","transitionStyle","getTranslate","to","onTransitionEnd","isCleaning","_nonTransition","_removeStyles","_transition","from","offsetHeight","enableTransition","transitionProps","$1","toLowerCase","duration","staggerDelay","onwebkitTransitionEnd","ontransitionend","onotransitionend","dashedVendorProperties","target","propertyName","isEmptyObj","disableTransition","removeTransitionStyles","cleanStyle","cleanTransitionStyle","delay","removeElem","parentNode","removeChild","display","isHidden","getHideRevealTransitionEndProperty","onRevealTransitionEnd","styleProperty","optionStyle","onHideTransitionEnd","msnry","Masonry","columnWidth","imagesLoaded","getStyleSize","logError","message","measurements","measurementsLength","getStyle","isBoxSizeOuter","isSetup","div","createElement","padding","borderStyle","borderWidth","boxSizing","body","appendChild","round","setup","nodeType","innerHeight","outerWidth","outerHeight","getZeroSize","offsetWidth","paddingWidth","paddingHeight","marginWidth","marginHeight","borderHeight","isBorderBoxSizeOuter","styleWidth","styleHeight","style_element","dom_events","add_event_listener","set_css","callback","attachEvent","css_text","styleSheet","cssText","innerHTML","getElementsByTagName","EventListener","eventTarget","unorderedBindings","Set","connect","disconnect","bindingConnected","binding","bindingDisconnected","delete","extendedEvent","stopImmediatePropagation_1","stopImmediatePropagation","assign","immediatePropagationStopped","extendEvent","_i","_a","bindings","Array","sort","leftIndex","rightIndex","configurable","Dispatcher","eventListenerMaps","Map","started","eventListeners","eventListener","stop","values","reduce","fetchEventListenerForBinding","handleError","detail","fetchEventListener","eventListenerMap","fetchEventListenerMapForEventTarget","createEventListener","descriptorPattern","Action","descriptor","tagName","defaultEventNames","getDefaultEventNameForElement","methodName","forToken","token","descriptorString","content","trim","eventTargetName","toString","eventNameSuffix","e","getAttribute","Error","Binding","action","willBeInvokedByEvent","invokeWithEvent","controller","Element","contains","scope","containsElement","ElementObserver","delegate","elements","mutationObserver","MutationObserver","mutations","processMutations","observe","attributes","childList","subtree","refresh","takeRecords","matchElementsInTree","removeElement","_b","_c","addElement","mutations_1","mutation","processMutation","processAttributeChange","attributeName","processRemovedNodes","removedNodes","processAddedNodes","addedNodes","node","elementAttributeChanged","matchElement","nodes","elementFromNode","processTree","elementIsActive","tree","processor","Node","ELEMENT_NODE","isConnected","elementMatched","elementUnmatched","AttributeObserver","elementObserver","hasAttribute","selector","elementMatchedAttribute","elementUnmatchedAttribute","elementAttributeValueChanged","fetch","del","prune","extendStatics","Multimap","valuesByKey","hasKey","hasValue","some","getValuesForKey","getKeysForValue","__extends","setPrototypeOf","__proto__","b","__","_super","IndexedMultimap","keysByValue","TokenListObserver","attributeObserver","tokensByElement","tokensMatched","readTokensForElement","refreshTokensForElement","unmatchedTokens","matchedTokens","tokensUnmatched","tokens","tokenMatched","tokenUnmatched","previousTokens","currentTokens","firstDifferingIndex","_","findIndex","tokensAreEqual","tokenString","split","parseTokenString","ValueListObserver","tokenListObserver","parseResultsByToken","WeakMap","valuesByTokenByElement","fetchParseResultForToken","fetchValuesByTokenForElement","elementMatchedValue","elementUnmatchedValue","parseResult","parseToken","valuesByToken","parseValueForToken","BindingObserver","bindingsByAction","valueListObserver","actionAttribute","disconnectAllActions","schema","connectAction","disconnectAction","clear","Context","bindingObserver","dispatcher","initialize","parentElement","blessControllerConstructor","bless","extendWithReflect","_newTarget","Reflect","construct","a","Module","definition","blessDefinition","contextsByScope","connectedContexts","connectContextForScope","fetchContextForScope","disconnectContextForScope","DataMap","getFormattedKey","char","attributeValueContainsToken","TargetSet","targetName","find","targetNames","getSelectorForTargetNames","findElement","findAll","findAllElements","getSelectorForTargetName","join","targetDescriptor","targetAttribute","Scope","targets","head","tail","filterElements","closest","controllerSelector","controllerAttribute","ScopeObserver","scopesByIdentifierByElement","scopeReferenceCounts","scopesByIdentifier","fetchScopesByIdentifierForElement","referenceCount","scopeConnected","scopeDisconnected","Router","scopeObserver","modulesByIdentifier","contexts","loadDefinition","unloadIdentifier","connectModule","disconnectModule","getContextForElementAndIdentifier","defaultSchema","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","step","next","rejected","result","done","then","__generator","f","g","label","sent","trys","ops","verb","iterator","v","op","TypeError","pop","router","readyState","register","rest","definitions","isArray","unload","identifiers","getControllerForElementAndIdentifier","defineTargetProperties","ancestors","getPrototypeOf","getAncestorsForConstructor","getOwnTargetNamesForConstructor","getTargetNamesForConstructor","properties","charAt","toUpperCase","capitalize","matchesSelector","arraySlice","ary","getParent","ffElems","childElems","_class","threshold","timeoutName","timeout","clearTimeout","setTimeout","docReady","toDashed","str","$2","WidgetClass","dashedNamespace","dataAttr","dataAttrElems","jsDashElems","dataOptionsAttr","attr","JSON","parse","className","instance","elementTarget","play","pause","menu","onchange","selectedIndex","location","href","fitWidth","measureColumns","colYs","cols","maxY","horizontalColIndex","getContainerWidth","firstItem","firstItemElem","containerWidth","gutter","excess","container","remainder","colSpan","min","colPosition","horizontalOrder","col","setHeight","setMax","_getTopColPosition","colGroup","_getTopColGroup","minimumY","groupCount","_getColGroupY","groupColYs","_getHorizontalColPosition","hasSize","stampSize","offset","firstX","lastX","firstCol","floor","lastCol","stampMaxY","_getContainerFitWidth","unusedCols","previousWidth","webpackContext","req","webpackContextResolve","code","OldCookies","api","noConflict","decode","decodeURIComponent","init","converter","path","Date","toUTCString","stringify","test","write","encodeURIComponent","String","escape","stringifiedAttributes","cookie","json","jar","cookies","parts","read","getJSON","withConverter","showCurrentSlide","initAutoPlay","self","timer","setInterval","slideTargets","clearInterval","navTargets","parseInt","mobileNav","menuTarget","$","ImagesLoaded","onAlways","queryElem","getImages","jqDeferred","Deferred","check","images","addElementImages","nodeName","addImage","background","addElementBackgroundImages","elementNodeTypes","childImgs","img","child","1","9","11","LoadingImage","Background","url","Image","reURL","exec","backgroundImage","addBackground","loadingImage","onProgress","image","progress","progressedCount","hasAnyBroken","complete","isLoaded","notify","debug","log","isComplete","jqMethod","getIsImageComplete","confirm","naturalWidth","proxyImage","src","onload","unbindEvents","onerror","makeJQueryPlugin","fn","promise","matchesMethod","ElemProto","prefixes","k","naturalHeight","h","j","devicePixelRatio","retinajs"],"mappings":"aACE,IAAIA,EAAmB,GAGvB,SAASC,EAAoBC,GAG5B,GAAGF,EAAiBE,GACnB,OAAOF,EAAiBE,GAAUC,QAGnC,IAAIC,EAASJ,EAAiBE,GAAY,CACzCG,EAAGH,EACHI,GAAG,EACHH,QAAS,IAUV,OANAI,EAAQL,GAAUM,KAAKJ,EAAOD,QAASC,EAAQA,EAAOD,QAASF,GAG/DG,EAAOE,GAAI,EAGJF,EAAOD,QAKfF,EAAoBQ,EAAIF,EAGxBN,EAAoBS,EAAIV,EAGxBC,EAAoBU,EAAI,SAASR,EAASS,EAAMC,GAC3CZ,EAAoBa,EAAEX,EAASS,IAClCG,OAAOC,eAAeb,EAASS,EAAM,CAAEK,YAAY,EAAMC,IAAKL,KAKhEZ,EAAoBkB,EAAI,SAAShB,GACX,oBAAXiB,QAA0BA,OAAOC,aAC1CN,OAAOC,eAAeb,EAASiB,OAAOC,YAAa,CAAEC,MAAO,WAE7DP,OAAOC,eAAeb,EAAS,aAAc,CAAEmB,OAAO,KAQvDrB,EAAoBsB,EAAI,SAASD,EAAOE,GAEvC,GADU,EAAPA,IAAUF,EAAQrB,EAAoBqB,IAC/B,EAAPE,EAAU,OAAOF,EACpB,GAAW,EAAPE,GAA8B,iBAAVF,GAAsBA,GAASA,EAAMG,WAAY,OAAOH,EAChF,IAAII,EAAKX,OAAOY,OAAO,MAGvB,GAFA1B,EAAoBkB,EAAEO,GACtBX,OAAOC,eAAeU,EAAI,UAAW,CAAET,YAAY,EAAMK,MAAOA,IACtD,EAAPE,GAA4B,iBAATF,EAAmB,IAAI,IAAIM,KAAON,EAAOrB,EAAoBU,EAAEe,EAAIE,EAAK,SAASA,GAAO,OAAON,EAAMM,IAAQC,KAAK,KAAMD,IAC9I,OAAOF,GAIRzB,EAAoB6B,EAAI,SAAS1B,GAChC,IAAIS,EAAST,GAAUA,EAAOqB,WAC7B,WAAwB,OAAOrB,EAAgB,SAC/C,WAA8B,OAAOA,GAEtC,OADAH,EAAoBU,EAAEE,EAAQ,IAAKA,GAC5BA,GAIRZ,EAAoBa,EAAI,SAASiB,EAAQC,GAAY,OAAOjB,OAAOkB,UAAUC,eAAe1B,KAAKuB,EAAQC,IAGzG/B,EAAoBkC,EAAI,IAIjBlC,EAAoBA,EAAoBmC,EAAI,G,iJC5E/CC,EAAcC,IAAYC,QAC1BC,EAAUC,UAChBJ,EAAYK,KCRL,SAAgCF,GACnC,OAAOA,EAAQG,OACVC,KAAI,SAAUhB,GAAO,OAG9B,SAA8CY,EAASZ,GACnD,IAAIiB,EAWD,SAAiCjB,GACpC,IAAIkB,GAAelB,EAAImB,MAAM,2CAA6C,IAAI,GAC9E,GAAID,EACA,OAAOA,EAAYE,QAAQ,KAAM,KAAKA,QAAQ,MAAO,MAdxCC,CAAwBrB,GACzC,GAAIiB,EACA,OAGR,SAA0CzC,EAAQyC,GAC9C,IAAIK,EAAwB9C,EAAO+C,QACnC,GAAoC,mBAAzBD,EACP,MAAO,CAAEL,WAAYA,EAAYK,sBAAuBA,GANjDE,CAAiCZ,EAAQZ,GAAMiB,GANzBQ,CAAqCb,EAASZ,MAC1E0B,QAAO,SAAUhC,GAAS,OAAOA,KDKzBiC,CAAuBf,IAUxCgB,O,o3DEdE,WACOC,IAAQvC,IAAI,gBACfwC,KAAKC,S,oBAIT,WACEF,IAAQG,IAAI,eAAe,EAAM,CAAEC,QAAS,MAC5CH,KAAKI,S,kBAGP,WACEJ,KAAKK,QAAQC,UAAUC,OAAO,UAC9BP,KAAKK,QAAQG,gBAAgB,iB,kBAG/B,WACER,KAAKK,QAAQC,UAAUG,IAAI,UAC3BT,KAAKK,QAAQK,aAAa,eAAe,Q,8BAnBhBC,M,qBCH7B,QAsBoB,oBAAVC,QAAwBA,YATf,0BAAf,EAS6C,WAEjD,aAEA,SAASC,KAET,IAAIC,EAAQD,EAAUtC,UAiFtB,OA/EAuC,EAAMC,GAAK,SAAUC,EAAWC,GAC9B,GAAMD,GAAcC,EAApB,CAIA,IAAIC,EAASlB,KAAKmB,QAAUnB,KAAKmB,SAAW,GAExCC,EAAYF,EAAQF,GAAcE,EAAQF,IAAe,GAM7D,OAJuC,GAAlCI,EAAUC,QAASJ,IACtBG,EAAUE,KAAML,GAGXjB,OAGTc,EAAMS,KAAO,SAAUP,EAAWC,GAChC,GAAMD,GAAcC,EAApB,CAIAjB,KAAKe,GAAIC,EAAWC,GAGpB,IAAIO,EAAaxB,KAAKyB,YAAczB,KAAKyB,aAAe,GAMxD,OAJoBD,EAAYR,GAAcQ,EAAYR,IAAe,IAE1DC,IAAa,EAErBjB,OAGTc,EAAMY,IAAM,SAAUV,EAAWC,GAC/B,IAAIG,EAAYpB,KAAKmB,SAAWnB,KAAKmB,QAASH,GAC9C,GAAMI,GAAcA,EAAUO,OAA9B,CAGA,IAAIC,EAAQR,EAAUC,QAASJ,GAK/B,OAJe,GAAVW,GACHR,EAAUS,OAAQD,EAAO,GAGpB5B,OAGTc,EAAMgB,UAAY,SAAUd,EAAWe,GACrC,IAAIX,EAAYpB,KAAKmB,SAAWnB,KAAKmB,QAASH,GAC9C,GAAMI,GAAcA,EAAUO,OAA9B,CAIAP,EAAYA,EAAUY,MAAM,GAC5BD,EAAOA,GAAQ,GAIf,IAFA,IAAIE,EAAgBjC,KAAKyB,aAAezB,KAAKyB,YAAaT,GAEhDrE,EAAE,EAAGA,EAAIyE,EAAUO,OAAQhF,IAAM,CACzC,IAAIsE,EAAWG,EAAUzE,GACZsF,GAAiBA,EAAehB,KAI3CjB,KAAK0B,IAAKV,EAAWC,UAEdgB,EAAehB,IAGxBA,EAASiB,MAAOlC,KAAM+B,GAGxB,OAAO/B,OAGTc,EAAMqB,OAAS,kBACNnC,KAAKmB,eACLnB,KAAKyB,aAGPZ,IAhGY,mC,40DCVjB,SAAKuB,GACHA,EAAMC,iBACN,IAAMC,EAAUF,EAAMG,cAAcC,QAAQC,MACtCA,EAAQC,SAASC,eAAeL,GAClCG,IACFA,EAAMnC,UAAUG,IAAI,oBACpBgC,EAAM/B,aAAa,cAAe,SAClC+B,EAAMG,QACN5C,KAAK6C,KAAK3C,IAAI,KAAMoC,M,mBAIxB,SAAMF,GACJ,GACEpC,KAAK6C,KAAKC,IAAI,QACK,KAAlBV,EAAMW,SAAiC,UAAfX,EAAMY,MAC/B,CACA,IAAMV,EAAUtC,KAAK6C,KAAKrF,IAAI,MACxBiF,EAAQC,SAASC,eAAeL,GAClCG,IACFA,EAAMnC,UAAUC,OAAO,oBACvBkC,EAAM/B,aAAa,cAAe,SAEpCV,KAAK6C,KAAL,OAAiB,Y,wCAxBMlC,I,qBCF7B,SAME,SAAUC,EAAQqC,GAClB,aAKE,EAAQ,CACJ,UACA,UACA,UACA,gBAID,KAHA,WACSpC,EAAWqC,EAASC,EAAOC,GACnC,OAuBG,SAAkBxC,EAAQC,EAAWqC,EAASC,EAAOC,GAKhE,IAAIC,EAAUzC,EAAOyC,QACjBC,EAAS1C,EAAO0C,OAChBC,EAAO,aAKPC,EAAO,EAEPC,EAAY,GAQhB,SAASC,EAAUrD,EAASsD,GAC1B,IAAIC,EAAeT,EAAMU,gBAAiBxD,GAC1C,GAAMuD,EAAN,CAOA5D,KAAKK,QAAUuD,EAEVN,IACHtD,KAAK8D,SAAWR,EAAQtD,KAAKK,UAI/BL,KAAK2D,QAAUR,EAAMY,OAAQ,GAAI/D,KAAKgE,YAAYC,UAClDjE,KAAKkE,OAAQP,GAGb,IAAIQ,IAAOX,EACXxD,KAAKK,QAAQ+D,aAAeD,EAC5BV,EAAWU,GAAOnE,KAGlBA,KAAKqE,UAEcrE,KAAKsE,WAAW,eAEjCtE,KAAKuE,cA1BAlB,GACHA,EAAQmB,MAAO,mBAAqBxE,KAAKgE,YAAYS,UACnD,MAASb,GAAgBvD,IA6BjCqD,EAASe,UAAY,WACrBf,EAASN,KAAOA,EAGhBM,EAASO,SAAW,CAClBS,eAAgB,CACdC,SAAU,YAEZC,YAAY,EACZC,YAAY,EACZC,WAAW,EACXC,QAAQ,EACRC,iBAAiB,EAEjBC,mBAAoB,OACpBC,YAAa,CACXC,QAAS,EACTC,UAAW,gBAEbC,aAAc,CACZF,QAAS,EACTC,UAAW,aAIf,IAAItE,EAAQ4C,EAASnF,UAowBrB,SAAS+G,EAAUC,GACjB,SAASC,IACPD,EAAOrD,MAAOlC,KAAMyF,WAMtB,OAHAD,EAASjH,UAAYlB,OAAOY,OAAQsH,EAAOhH,WAC3CiH,EAASjH,UAAUyF,YAAcwB,EAE1BA,EA1wBTrC,EAAMY,OAAQjD,EAAOD,EAAUtC,WAM/BuC,EAAMoD,OAAS,SAAUwB,GACvBvC,EAAMY,OAAQ/D,KAAK2D,QAAS+B,IAM9B5E,EAAMwD,WAAa,SAAUJ,GAC3B,IAAIyB,EAAY3F,KAAKgE,YAAY4B,cAAe1B,GAChD,OAAOyB,QAA2CE,IAA9B7F,KAAK2D,QAASgC,GAChC3F,KAAK2D,QAASgC,GAAc3F,KAAK2D,QAASO,IAG9CR,EAASkC,cAAgB,CAEvBhB,WAAY,eACZkB,WAAY,eACZC,cAAe,kBACflB,WAAY,eACZC,UAAW,cACXC,OAAQ,gBACRC,gBAAiB,uBAGnBlE,EAAMuD,QAAU,WAEdrE,KAAKgG,cAELhG,KAAKiG,OAAS,GACdjG,KAAKkG,MAAOlG,KAAK2D,QAAQuC,OAEzB/C,EAAMY,OAAQ/D,KAAKK,QAAQ8F,MAAOnG,KAAK2D,QAAQe,gBAG3B1E,KAAKsE,WAAW,WAElCtE,KAAKoG,cAKTtF,EAAMkF,YAAc,WAElBhG,KAAKqG,MAAQrG,KAAKsG,SAAUtG,KAAKK,QAAQkG,WAS3CzF,EAAMwF,SAAW,SAAUE,GAOzB,IALA,IAAIC,EAAYzG,KAAK0G,wBAAyBF,GAC1CpD,EAAOpD,KAAKgE,YAAYZ,KAGxBiD,EAAQ,GACF1J,EAAE,EAAGA,EAAI8J,EAAU9E,OAAQhF,IAAM,CACzC,IACIgK,EAAO,IAAIvD,EADJqD,EAAU9J,GACMqD,MAC3BqG,EAAM/E,KAAMqF,GAGd,OAAON,GAQTvF,EAAM4F,wBAA0B,SAAUF,GACxC,OAAOrD,EAAMyD,mBAAoBJ,EAAOxG,KAAK2D,QAAQkD,eAOvD/F,EAAMgG,gBAAkB,WACtB,OAAO9G,KAAKqG,MAAMnH,KAAK,SAAUyH,GAC/B,OAAOA,EAAKtG,YAShBS,EAAMyD,OAAS,WACbvE,KAAK+G,eACL/G,KAAKgH,gBAGL,IAAIjB,EAAgB/F,KAAKsE,WAAW,iBAChC2C,OAA8BpB,IAAlBE,EACdA,GAAiB/F,KAAKkH,gBACxBlH,KAAKmH,YAAanH,KAAKqG,MAAOY,GAG9BjH,KAAKkH,iBAAkB,GAIzBpG,EAAMsG,MAAQtG,EAAMyD,OAKpBzD,EAAMiG,aAAe,WACnB/G,KAAKkD,WAIPpC,EAAMoC,QAAU,WACdlD,KAAKqH,KAAOnE,EAASlD,KAAKK,UAa5BS,EAAMwG,gBAAkB,SAAUC,EAAaF,GAC7C,IACIG,EADAtD,EAASlE,KAAK2D,QAAS4D,GAErBrD,GAKkB,iBAAVA,EACVsD,EAAOxH,KAAKK,QAAQoH,cAAevD,GACzBA,aAAkBwD,cAC5BF,EAAOtD,GAGTlE,KAAMuH,GAAgBC,EAAOtE,EAASsE,GAAQH,GAASnD,GATvDlE,KAAMuH,GAAgB,GAiB1BzG,EAAMqG,YAAc,SAAUd,EAAOY,GACnCZ,EAAQrG,KAAK2H,mBAAoBtB,GAEjCrG,KAAK4H,aAAcvB,EAAOY,GAE1BjH,KAAK6H,eASP/G,EAAM6G,mBAAqB,SAAUtB,GACnC,OAAOA,EAAMzG,QAAQ,SAAU+G,GAC7B,OAAQA,EAAKmB,cASjBhH,EAAM8G,aAAe,SAAUvB,EAAOY,GAGpC,GAFAjH,KAAK+H,qBAAsB,SAAU1B,GAE/BA,GAAUA,EAAM1E,OAAtB,CAKA,IAAIqG,EAAQ,GAEZ3B,EAAM4B,SAAS,SAAUtB,GAEvB,IAAIhC,EAAW3E,KAAKkI,uBAAwBvB,GAE5ChC,EAASgC,KAAOA,EAChBhC,EAASsC,UAAYA,GAAaN,EAAKwB,gBACvCH,EAAM1G,KAAMqD,KACX3E,MAEHA,KAAKoI,oBAAqBJ,KAQ5BlH,EAAMoH,uBAAyB,WAC7B,MAAO,CACLG,EAAG,EACHC,EAAG,IAUPxH,EAAMsH,oBAAsB,SAAUJ,GACpChI,KAAKuI,gBACLP,EAAMC,SAAS,SAAUO,EAAK7L,GAC5BqD,KAAKyI,cAAeD,EAAI7B,KAAM6B,EAAIH,EAAGG,EAAIF,EAAGE,EAAIvB,UAAWtK,KAC1DqD,OAILc,EAAMyH,cAAgB,WACpB,IAAIG,EAAU1I,KAAK2D,QAAQ+E,QAC3B,GAAKA,QAKL,OADA1I,KAAK0I,QAyiBP,SAA0BC,GACxB,GAAoB,iBAARA,EACV,OAAOA,EAET,IAAIC,EAAUD,EAAKtJ,MAAO,qBACtBwJ,EAAMD,GAAWA,EAAQ,GACzBE,EAAOF,GAAWA,EAAQ,GAC9B,IAAMC,EAAIlH,OACR,OAAO,EAIT,OAFAkH,EAAME,WAAYF,KACPG,EAASF,IAAU,GApjBfG,CAAiBP,GACzB1I,KAAK0I,QAJV1I,KAAK0I,QAAU,GAcnB5H,EAAM2H,cAAgB,SAAU9B,EAAM0B,EAAGC,EAAGrB,EAAWtK,GAChDsK,EAEHN,EAAKuC,KAAMb,EAAGC,IAEd3B,EAAK+B,QAAS/L,EAAIqD,KAAK0I,SACvB/B,EAAKwC,OAAQd,EAAGC,KAQpBxH,EAAM+G,YAAc,WAClB7H,KAAKgF,mBAGPlE,EAAMkE,gBAAkB,WAEtB,GAD0BhF,KAAKsE,WAAW,mBAC1C,CAGA,IAAI+C,EAAOrH,KAAKoJ,oBACX/B,IACHrH,KAAKqJ,qBAAsBhC,EAAKiC,OAAO,GACvCtJ,KAAKqJ,qBAAsBhC,EAAKkC,QAAQ,MAU5CzI,EAAMsI,kBAAoB7F,EAM1BzC,EAAMuI,qBAAuB,SAAUG,EAASC,GAC9C,QAAiB5D,IAAZ2D,EAAL,CAIA,IAAIE,EAAW1J,KAAKqH,KAEfqC,EAASC,cACZH,GAAWC,EAAUC,EAASE,YAAcF,EAASG,aACnDH,EAASI,gBAAkBJ,EAASK,iBACpCL,EAASM,cAAgBN,EAASO,WAClCP,EAASQ,eAAiBR,EAASS,mBAGvCX,EAAUY,KAAKC,IAAKb,EAAS,GAC7BxJ,KAAKK,QAAQ8F,MAAOsD,EAAU,QAAU,UAAaD,EAAU,OAQjE1I,EAAMiH,qBAAuB,SAAU/G,EAAWqF,GAChD,IAAIiE,EAAQtK,KACZ,SAASuK,IACPD,EAAME,cAAexJ,EAAY,WAAY,KAAM,CAAEqF,IAGvD,IAAIoE,EAAQpE,EAAM1E,OAClB,GAAM0E,GAAUoE,EAAhB,CAKA,IAAIC,EAAY,EAShBrE,EAAM4B,SAAS,SAAUtB,GACvBA,EAAKpF,KAAMP,EAAW2J,WAdtBJ,IAKF,SAASI,MACPD,GACkBD,GAChBF,MAgBNzJ,EAAM0J,cAAgB,SAAUxH,EAAMZ,EAAOL,GAE3C,IAAI6I,EAAWxI,EAAQ,CAAEA,GAAQyI,OAAQ9I,GAASA,EAGlD,GAFA/B,KAAK8B,UAAWkB,EAAM4H,GAEjBtH,EAGH,GADAtD,KAAK8D,SAAW9D,KAAK8D,UAAYR,EAAQtD,KAAKK,SACzC+B,EAAQ,CAEX,IAAI0I,EAASxH,EAAOyH,MAAO3I,GAC3B0I,EAAO9H,KAAOA,EACdhD,KAAK8D,SAASkH,QAASF,EAAQ/I,QAG/B/B,KAAK8D,SAASkH,QAAShI,EAAMjB,IAanCjB,EAAMmK,OAAS,SAAUzD,GACvB,IAAIb,EAAO3G,KAAKkL,QAAS1D,GACpBb,IACHA,EAAKmB,WAAY,IAQrBhH,EAAMqK,SAAW,SAAU3D,GACzB,IAAIb,EAAO3G,KAAKkL,QAAS1D,GACpBb,UACIA,EAAKmB,WAQhBhH,EAAMoF,MAAQ,SAAUM,IACtBA,EAAQxG,KAAKoL,MAAO5E,MAKpBxG,KAAKiG,OAASjG,KAAKiG,OAAO4E,OAAQrE,GAElCA,EAAMyB,QAASjI,KAAKiL,OAAQjL,QAO9Bc,EAAMuK,QAAU,SAAU7E,IACxBA,EAAQxG,KAAKoL,MAAO5E,KAKpBA,EAAMyB,SAAS,SAAUT,GAEvBrE,EAAMmI,WAAYtL,KAAKiG,OAAQuB,GAC/BxH,KAAKmL,SAAU3D,KACdxH,OAQLc,EAAMsK,MAAQ,SAAU5E,GACtB,GAAMA,EAQN,MAJqB,iBAATA,IACVA,EAAQxG,KAAKK,QAAQkL,iBAAkB/E,IAEzCA,EAAQrD,EAAMqI,UAAWhF,IAI3B1F,EAAMkG,cAAgB,WACdhH,KAAKiG,QAAWjG,KAAKiG,OAAOtE,SAIlC3B,KAAKyL,mBAELzL,KAAKiG,OAAOgC,QAASjI,KAAK0L,aAAc1L,QAI1Cc,EAAM2K,iBAAmB,WAEvB,IAAIE,EAAe3L,KAAKK,QAAQuL,wBAC5BvE,EAAOrH,KAAKqH,KAChBrH,KAAK6L,cAAgB,CACnBC,KAAMH,EAAaG,KAAOzE,EAAKuC,YAAcvC,EAAKyC,gBAClDiC,IAAKJ,EAAaI,IAAM1E,EAAK4C,WAAa5C,EAAK6C,eAC/C8B,MAAOL,EAAaK,OAAU3E,EAAKwC,aAAexC,EAAK0C,kBACvDkC,OAAQN,EAAaM,QAAW5E,EAAK2C,cAAgB3C,EAAK8C,qBAO9DrJ,EAAM4K,aAAenI,EAOrBzC,EAAMoL,kBAAoB,SAAU1E,GAClC,IAAImE,EAAenE,EAAKoE,wBACpBO,EAAWnM,KAAK6L,cAChBxE,EAAOnE,EAASsE,GAOpB,MANa,CACXsE,KAAMH,EAAaG,KAAOK,EAASL,KAAOzE,EAAK+E,WAC/CL,IAAKJ,EAAaI,IAAMI,EAASJ,IAAM1E,EAAKgF,UAC5CL,MAAOG,EAASH,MAAQL,EAAaK,MAAQ3E,EAAKiF,YAClDL,OAAQE,EAASF,OAASN,EAAaM,OAAS5E,EAAKkF,eASzDzL,EAAM0L,YAAcrJ,EAAMqJ,YAK1B1L,EAAMsF,WAAa,WACjBxF,EAAO6L,iBAAkB,SAAUzM,MACnCA,KAAK0M,eAAgB,GAMvB5L,EAAM6L,aAAe,WACnB/L,EAAOgM,oBAAqB,SAAU5M,MACtCA,KAAK0M,eAAgB,GAGvB5L,EAAM+L,SAAW,WACf7M,KAAK+E,UAGP5B,EAAM2J,eAAgBpJ,EAAU,WAAY,KAE5C5C,EAAMiE,OAAS,WAGP/E,KAAK0M,eAAkB1M,KAAK+M,qBAIlC/M,KAAKuE,UAOPzD,EAAMiM,kBAAoB,WACxB,IAAI1F,EAAOnE,EAASlD,KAAKK,SAIzB,OADeL,KAAKqH,MAAQA,GACTA,EAAK2F,aAAehN,KAAKqH,KAAK2F,YAUnDlM,EAAMmM,SAAW,SAAUzG,GACzB,IAAIH,EAAQrG,KAAKsG,SAAUE,GAK3B,OAHKH,EAAM1E,SACT3B,KAAKqG,MAAQrG,KAAKqG,MAAMwE,OAAQxE,IAE3BA,GAOTvF,EAAMoM,SAAW,SAAU1G,GACzB,IAAIH,EAAQrG,KAAKiN,SAAUzG,GACrBH,EAAM1E,SAIZ3B,KAAKmH,YAAad,GAAO,GACzBrG,KAAKmN,OAAQ9G,KAOfvF,EAAMsM,UAAY,SAAU5G,GAC1B,IAAIH,EAAQrG,KAAKsG,SAAUE,GAC3B,GAAMH,EAAM1E,OAAZ,CAIA,IAAI0L,EAAgBrN,KAAKqG,MAAMrE,MAAM,GACrChC,KAAKqG,MAAQA,EAAMwE,OAAQwC,GAE3BrN,KAAK+G,eACL/G,KAAKgH,gBAELhH,KAAKmH,YAAad,GAAO,GACzBrG,KAAKmN,OAAQ9G,GAEbrG,KAAKmH,YAAakG,KAOpBvM,EAAMqM,OAAS,SAAU9G,GAEvB,GADArG,KAAK+H,qBAAsB,SAAU1B,GAC/BA,GAAUA,EAAM1E,OAAtB,CAGA,IAAI+G,EAAU1I,KAAKuI,gBACnBlC,EAAM4B,SAAS,SAAUtB,EAAMhK,GAC7BgK,EAAK+B,QAAS/L,EAAI+L,GAClB/B,EAAKwG,cAQTrM,EAAMV,KAAO,SAAUiG,GAErB,GADArG,KAAK+H,qBAAsB,OAAQ1B,GAC7BA,GAAUA,EAAM1E,OAAtB,CAGA,IAAI+G,EAAU1I,KAAKuI,gBACnBlC,EAAM4B,SAAS,SAAUtB,EAAMhK,GAC7BgK,EAAK+B,QAAS/L,EAAI+L,GAClB/B,EAAKvG,YAQTU,EAAMwM,mBAAqB,SAAU9G,GACnC,IAAIH,EAAQrG,KAAKuN,SAAU/G,GAC3BxG,KAAKmN,OAAQ9G,IAOfvF,EAAM0M,iBAAmB,SAAUhH,GACjC,IAAIH,EAAQrG,KAAKuN,SAAU/G,GAC3BxG,KAAKI,KAAMiG,IASbvF,EAAMoK,QAAU,SAAU1D,GAExB,IAAM,IAAI7K,EAAE,EAAGA,EAAIqD,KAAKqG,MAAM1E,OAAQhF,IAAM,CAC1C,IAAIgK,EAAO3G,KAAKqG,MAAM1J,GACtB,GAAKgK,EAAKtG,SAAWmH,EAEnB,OAAOb,IAUb7F,EAAMyM,SAAW,SAAU/G,GACzBA,EAAQrD,EAAMqI,UAAWhF,GACzB,IAAIH,EAAQ,GAQZ,OAPAG,EAAMyB,SAAS,SAAUT,GACvB,IAAIb,EAAO3G,KAAKkL,QAAS1D,GACpBb,GACHN,EAAM/E,KAAMqF,KAEb3G,MAEIqG,GAOTvF,EAAMP,OAAS,SAAUiG,GACvB,IAAIiH,EAAczN,KAAKuN,SAAU/G,GAEjCxG,KAAK+H,qBAAsB,SAAU0F,GAG/BA,GAAgBA,EAAY9L,QAIlC8L,EAAYxF,SAAS,SAAUtB,GAC7BA,EAAKpG,SAEL4C,EAAMmI,WAAYtL,KAAKqG,MAAOM,KAC7B3G,OAMLc,EAAM4M,QAAU,WAEd,IAAIvH,EAAQnG,KAAKK,QAAQ8F,MACzBA,EAAMoD,OAAS,GACfpD,EAAMxB,SAAW,GACjBwB,EAAMmD,MAAQ,GAEdtJ,KAAKqG,MAAM4B,SAAS,SAAUtB,GAC5BA,EAAK+G,aAGP1N,KAAK2M,eAEL,IAAIxI,EAAKnE,KAAKK,QAAQ+D,oBACfX,EAAWU,UACXnE,KAAKK,QAAQ+D,aAEfd,GACHA,EAAOqK,WAAY3N,KAAKK,QAASL,KAAKgE,YAAYS,YAYtDf,EAASb,KAAO,SAAU2E,GAExB,IAAIrD,GADJqD,EAAOrE,EAAMU,gBAAiB2D,KACbA,EAAKpD,aACtB,OAAOD,GAAMV,EAAWU,IAU1BT,EAASzF,OAAS,SAAUwG,EAAWd,GAErC,IAAIiK,EAAStI,EAAU5B,GAwBvB,OAtBAkK,EAAO3J,SAAWd,EAAMY,OAAQ,GAAIL,EAASO,UAC7Cd,EAAMY,OAAQ6J,EAAO3J,SAAUN,GAC/BiK,EAAOhI,cAAgBzC,EAAMY,OAAQ,GAAIL,EAASkC,eAElDgI,EAAOnJ,UAAYA,EAEnBmJ,EAAO/K,KAAOa,EAASb,KAGvB+K,EAAOxK,KAAOkC,EAAUlC,GAIxBD,EAAM0K,SAAUD,EAAQnJ,GAKnBnB,GAAUA,EAAOwK,SACpBxK,EAAOwK,QAASrJ,EAAWmJ,GAGtBA,GAiBT,IAAI5E,EAAU,CACZ+E,GAAI,EACJrP,EAAG,KAyBL,OAFAgF,EAASN,KAAOA,EAETM,EAr5BQT,CAASrC,EAAQC,EAAWqC,EAASC,EAAOC,IACpD,2BAdP,CAoCGxC,S,qBC1CH,UA8BGA,OArBC,EAAQ,CACJ,UACA,gBAEK,0BADN,EAkBI,SAAkBC,EAAWqC,GACxC,aAeA,IAAI8K,EAAetL,SAASuL,gBAAgB9H,MAExC+H,EAAuD,iBAA3BF,EAAaG,WAC3C,aAAe,mBACbC,EAAqD,iBAA1BJ,EAAa5I,UAC1C,YAAc,kBAEZiJ,EAAqB,CACvBC,iBAAkB,sBAClBH,WAAY,iBACXD,GAGCK,EAAmB,CACrBnJ,UAAWgJ,EACXD,WAAYD,EACZjJ,mBAAoBiJ,EAAqB,WACzCA,mBAAoBA,EAAqB,WACzCM,gBAAiBN,EAAqB,SAKxC,SAAS9K,EAAM/C,EAASkE,GAChBlE,IAINL,KAAKK,QAAUA,EAEfL,KAAKuE,OAASA,EACdvE,KAAK2E,SAAW,CACd0D,EAAG,EACHC,EAAG,GAGLtI,KAAKqE,WAIP,IAAIvD,EAAQsC,EAAK7E,UAAYlB,OAAOY,OAAQ4C,EAAUtC,WACtDuC,EAAMkD,YAAcZ,EAEpBtC,EAAMuD,QAAU,WAEdrE,KAAKyO,QAAU,CACbC,cAAe,GACfC,MAAO,GACPC,MAAO,IAGT5O,KAAK6O,IAAI,CACPlK,SAAU,cAKd7D,EAAM0L,YAAc,SAAUpK,GAC5B,IAAI0M,EAAS,KAAO1M,EAAMY,KACrBhD,KAAM8O,IACT9O,KAAM8O,GAAU1M,IAIpBtB,EAAMoC,QAAU,WACdlD,KAAKqH,KAAOnE,EAASlD,KAAKK,UAO5BS,EAAM+N,IAAM,SAAU1I,GACpB,IAAI4I,EAAY/O,KAAKK,QAAQ8F,MAE7B,IAAM,IAAI6I,KAAQ7I,EAGhB4I,EADoBR,EAAkBS,IAAUA,GACnB7I,EAAO6I,IAKxClO,EAAMmO,YAAc,WAClB,IAAI9I,EAAQ+I,iBAAkBlP,KAAKK,SAC/B8O,EAAenP,KAAKuE,OAAOD,WAAW,cACtC8K,EAAcpP,KAAKuE,OAAOD,WAAW,aACrC+K,EAASlJ,EAAOgJ,EAAe,OAAS,SACxCG,EAASnJ,EAAOiJ,EAAc,MAAQ,UACtC/G,EAAIU,WAAYsG,GAChB/G,EAAIS,WAAYuG,GAEhBC,EAAavP,KAAKuE,OAAO8C,MACA,GAAxBgI,EAAOhO,QAAQ,OAClBgH,EAAMA,EAAI,IAAQkH,EAAWjG,QAEF,GAAxBgG,EAAOjO,QAAQ,OAClBiH,EAAMA,EAAI,IAAQiH,EAAWhG,QAG/BlB,EAAImH,MAAOnH,GAAM,EAAIA,EACrBC,EAAIkH,MAAOlH,GAAM,EAAIA,EAErBD,GAAK8G,EAAeI,EAAW3F,YAAc2F,EAAW1F,aACxDvB,GAAK8G,EAAcG,EAAWtF,WAAasF,EAAWvF,cAEtDhK,KAAK2E,SAAS0D,EAAIA,EAClBrI,KAAK2E,SAAS2D,EAAIA,GAIpBxH,EAAM2O,eAAiB,WACrB,IAAIF,EAAavP,KAAKuE,OAAO8C,KACzBlB,EAAQ,GACRgJ,EAAenP,KAAKuE,OAAOD,WAAW,cACtC8K,EAAcpP,KAAKuE,OAAOD,WAAW,aAGrCoL,EAAWP,EAAe,cAAgB,eAC1CQ,EAAYR,EAAe,OAAS,QACpCS,EAAiBT,EAAe,QAAU,OAE1C9G,EAAIrI,KAAK2E,SAAS0D,EAAIkH,EAAYG,GAEtCvJ,EAAOwJ,GAAc3P,KAAK6P,UAAWxH,GAErClC,EAAOyJ,GAAmB,GAG1B,IAAIE,EAAWV,EAAc,aAAe,gBACxCW,EAAYX,EAAc,MAAQ,SAClCY,EAAiBZ,EAAc,SAAW,MAE1C9G,EAAItI,KAAK2E,SAAS2D,EAAIiH,EAAYO,GAEtC3J,EAAO4J,GAAc/P,KAAKiQ,UAAW3H,GAErCnC,EAAO6J,GAAmB,GAE1BhQ,KAAK6O,IAAK1I,GACVnG,KAAK8B,UAAW,SAAU,CAAE9B,QAG9Bc,EAAM+O,UAAY,SAAUxH,GAC1B,IAAI6H,EAAelQ,KAAKuE,OAAOD,WAAW,cAC1C,OAAOtE,KAAKuE,OAAOZ,QAAQwM,kBAAoBD,EACzC7H,EAAIrI,KAAKuE,OAAO8C,KAAKiC,MAAU,IAAQ,IAAMjB,EAAI,MAGzDvH,EAAMmP,UAAY,SAAU3H,GAC1B,IAAI4H,EAAelQ,KAAKuE,OAAOD,WAAW,cAC1C,OAAOtE,KAAKuE,OAAOZ,QAAQwM,iBAAmBD,EACxC5H,EAAItI,KAAKuE,OAAO8C,KAAKkC,OAAW,IAAQ,IAAMjB,EAAI,MAG1DxH,EAAMsP,cAAgB,SAAU/H,EAAGC,GACjCtI,KAAKiP,cAEL,IAAIoB,EAAOrQ,KAAK2E,SAAS0D,EACrBiI,EAAOtQ,KAAK2E,SAAS2D,EAErBiI,EAAalI,GAAKrI,KAAK2E,SAAS0D,GAAKC,GAAKtI,KAAK2E,SAAS2D,EAM5D,GAHAtI,KAAKwQ,YAAanI,EAAGC,IAGhBiI,GAAevQ,KAAKyQ,gBAAzB,CAKA,IAAIC,EAASrI,EAAIgI,EACbM,EAASrI,EAAIgI,EACbM,EAAkB,GACtBA,EAAgBxL,UAAYpF,KAAK6Q,aAAcH,EAAQC,GAEvD3Q,KAAKmO,WAAW,CACd2C,GAAIF,EACJG,gBAAiB,CACf3L,UAAWpF,KAAKyP,gBAElBuB,YAAY,SAdZhR,KAAKyP,kBAkBT3O,EAAM+P,aAAe,SAAUxI,EAAGC,GAMhC,MAAO,gBAFPD,EAFmBrI,KAAKuE,OAAOD,WAAW,cAEvB+D,GAAKA,GAEI,QAD5BC,EAFkBtI,KAAKuE,OAAOD,WAAW,aAEvBgE,GAAKA,GACkB,UAI3CxH,EAAMoI,KAAO,SAAUb,EAAGC,GACxBtI,KAAKwQ,YAAanI,EAAGC,GACrBtI,KAAKyP,kBAGP3O,EAAMqI,OAASrI,EAAMsP,cAErBtP,EAAM0P,YAAc,SAAUnI,EAAGC,GAC/BtI,KAAK2E,SAAS0D,EAAIU,WAAYV,GAC9BrI,KAAK2E,SAAS2D,EAAIS,WAAYT,IAWhCxH,EAAMmQ,eAAiB,SAAUlP,GAK/B,IAAM,IAAIiN,KAJVhP,KAAK6O,IAAK9M,EAAK+O,IACV/O,EAAKiP,YACRhR,KAAKkR,cAAenP,EAAK+O,IAET/O,EAAKgP,gBACrBhP,EAAKgP,gBAAiB/B,GAAOlS,KAAMkD,OAYvCc,EAAMqN,WAAa,SAAUpM,GAE3B,GAAMgH,WAAY/I,KAAKuE,OAAOZ,QAAQsB,oBAAtC,CAKA,IAAIkM,EAAcnR,KAAKyO,QAEvB,IAAM,IAAIO,KAAQjN,EAAKgP,gBACrBI,EAAYvC,MAAOI,GAASjN,EAAKgP,gBAAiB/B,GAGpD,IAAMA,KAAQjN,EAAK+O,GACjBK,EAAYzC,cAAeM,IAAS,EAE/BjN,EAAKiP,aACRG,EAAYxC,MAAOK,IAAS,GAK3BjN,EAAKqP,OACRpR,KAAK6O,IAAK9M,EAAKqP,MAEPpR,KAAKK,QAAQgR,cAKvBrR,KAAKsR,iBAAkBvP,EAAK+O,IAE5B9Q,KAAK6O,IAAK9M,EAAK+O,IAEf9Q,KAAKyQ,iBAAkB,OA/BrBzQ,KAAKiR,eAAgBlP,IA2CzB,IAAIwP,EAAkB,WAA0BnD,EALnC9O,QAAS,YAAY,SAAUkS,GACxC,MAAO,IAAMA,EAAGC,iBAMpB3Q,EAAMwQ,iBAAmB,WAGvB,IAAKtR,KAAKyQ,gBAAV,CAcA,IAAIiB,EAAW1R,KAAKuE,OAAOZ,QAAQsB,mBACnCyM,EAA8B,iBAAZA,EAAuBA,EAAW,KAAOA,EAE3D1R,KAAK6O,IAAI,CACPX,mBAAoBqD,EACpBtM,mBAAoByM,EACpBlD,gBAAiBxO,KAAK2R,cAAgB,IAGxC3R,KAAKK,QAAQoM,iBAAkB4B,EAAoBrO,MAAM,KAK3Dc,EAAM8Q,sBAAwB,SAAUxP,GACtCpC,KAAK6R,gBAAiBzP,IAGxBtB,EAAMgR,iBAAmB,SAAU1P,GACjCpC,KAAK6R,gBAAiBzP,IAIxB,IAAI2P,EAAyB,CAC3B,oBAAqB,aAGvBjR,EAAM+Q,gBAAkB,SAAUzP,GAEhC,GAAKA,EAAM4P,SAAWhS,KAAKK,QAA3B,CAGA,IAAI8Q,EAAcnR,KAAKyO,QAEnBwD,EAAeF,EAAwB3P,EAAM6P,eAAkB7P,EAAM6P,oBAGlEd,EAAYzC,cAAeuD,GA3VpC,SAAqBzJ,GACnB,IAAM,IAAIwG,KAAQxG,EAChB,OAAO,EAGT,OAAO,EAwVF0J,CAAYf,EAAYzC,gBAE3B1O,KAAKmS,oBAGFF,KAAgBd,EAAYxC,QAE/B3O,KAAKK,QAAQ8F,MAAO/D,EAAM6P,cAAiB,UACpCd,EAAYxC,MAAOsD,IAGvBA,KAAgBd,EAAYvC,QACTuC,EAAYvC,MAAOqD,GACzBnV,KAAMkD,aACfmR,EAAYvC,MAAOqD,IAG5BjS,KAAK8B,UAAW,gBAAiB,CAAE9B,SAGrCc,EAAMqR,kBAAoB,WACxBnS,KAAKoS,yBACLpS,KAAKK,QAAQuM,oBAAqByB,EAAoBrO,MAAM,GAC5DA,KAAKyQ,iBAAkB,GAOzB3P,EAAMoQ,cAAgB,SAAU/K,GAE9B,IAAIkM,EAAa,GACjB,IAAM,IAAIrD,KAAQ7I,EAChBkM,EAAYrD,GAAS,GAEvBhP,KAAK6O,IAAKwD,IAGZ,IAAIC,EAAuB,CACzBpE,mBAAoB,GACpBjJ,mBAAoB,GACpBuJ,gBAAiB,IA6HnB,OA1HA1N,EAAMsR,uBAAyB,WAE7BpS,KAAK6O,IAAKyD,IAKZxR,EAAM4H,QAAU,SAAU6J,GACxBA,EAAQ/C,MAAO+C,GAAU,EAAIA,EAC7BvS,KAAK2R,aAAeY,EAAQ,MAM9BzR,EAAM0R,WAAa,WACjBxS,KAAKK,QAAQoS,WAAWC,YAAa1S,KAAKK,SAE1CL,KAAK6O,IAAI,CAAE8D,QAAS,KACpB3S,KAAK8B,UAAW,SAAU,CAAE9B,QAG9Bc,EAAMP,OAAS,WAEP2N,GAAuBnF,WAAY/I,KAAKuE,OAAOZ,QAAQsB,qBAM7DjF,KAAKuB,KAAM,iBAAiB,WAC1BvB,KAAKwS,gBAEPxS,KAAKI,QARHJ,KAAKwS,cAWT1R,EAAMqM,OAAS,kBACNnN,KAAK4S,SAEZ5S,KAAK6O,IAAI,CAAE8D,QAAS,KAEpB,IAAIhP,EAAU3D,KAAKuE,OAAOZ,QAEtBoN,EAAkB,GAEtBA,EAD4B/Q,KAAK6S,mCAAmC,iBACzB7S,KAAK8S,sBAEhD9S,KAAKmO,WAAW,CACdiD,KAAMzN,EAAQuB,YACd4L,GAAInN,EAAQ0B,aACZ2L,YAAY,EACZD,gBAAiBA,KAIrBjQ,EAAMgS,sBAAwB,WAGtB9S,KAAK4S,UACT5S,KAAK8B,UAAU,WASnBhB,EAAM+R,mCAAqC,SAAUE,GACnD,IAAIC,EAAchT,KAAKuE,OAAOZ,QAASoP,GAEvC,GAAKC,EAAY7N,QACf,MAAO,UAGT,IAAM,IAAI6J,KAAQgE,EAChB,OAAOhE,GAIXlO,EAAMV,KAAO,WAEXJ,KAAK4S,UAAW,EAEhB5S,KAAK6O,IAAI,CAAE8D,QAAS,KAEpB,IAAIhP,EAAU3D,KAAKuE,OAAOZ,QAEtBoN,EAAkB,GAEtBA,EAD4B/Q,KAAK6S,mCAAmC,gBACzB7S,KAAKiT,oBAEhDjT,KAAKmO,WAAW,CACdiD,KAAMzN,EAAQ0B,aACdyL,GAAInN,EAAQuB,YAEZ8L,YAAY,EACZD,gBAAiBA,KAIrBjQ,EAAMmS,oBAAsB,WAGrBjT,KAAK4S,WACR5S,KAAK6O,IAAI,CAAE8D,QAAS,SACpB3S,KAAK8B,UAAU,UAInBhB,EAAM4M,QAAU,WACd1N,KAAK6O,IAAI,CACPlK,SAAU,GACVmH,KAAM,GACNE,MAAO,GACPD,IAAK,GACLE,OAAQ,GACRkC,WAAY,GACZ/I,UAAW,MAIRhC,IA1hBM,gC,u4DCRX,WAAU,WACRpD,KAAKkT,MAAQ,IAAIC,IAAQnT,KAAKK,QAAS,CACrCwG,aAAc,mBACduM,YAAa,oBACbjD,iBAAiB,IAGnBkD,IAAarT,KAAKK,SAAS,WACzB,EAAK6S,MAAM3O,c,wBAIf,WACEvE,KAAKkT,MAAMxF,e,8BAdc/M,M,qBCJ7B,QAsBIC,YATe,0BAAf,EASQ,WACZ,aAKA,SAAS0S,EAAc1V,GACrB,IAAIiL,EAAME,WAAYnL,GAGtB,OADqC,GAAvBA,EAAMyD,QAAQ,OAAemO,MAAO3G,IAChCA,EAKpB,IAAI0K,EAA6B,oBAAXlQ,QAFtB,aAGE,SAAUmQ,GACRnQ,QAAQmB,MAAOgP,IAKfC,EAAe,CACjB,cACA,eACA,aACA,gBACA,aACA,cACA,YACA,eACA,kBACA,mBACA,iBACA,qBAGEC,EAAqBD,EAAa9R,OAwBtC,SAASgS,EAAUnM,GACjB,IAAIrB,EAAQ+I,iBAAkB1H,GAM9B,OALMrB,GACJoN,EAAU,kBAAoBpN,EAApB,6FAILA,EAKT,IAEIyN,EAFAC,GAAU,EAyCd,SAAS3Q,EAASsE,GAShB,GAzCF,WAEE,IAAKqM,EAAL,CAGAA,GAAU,EAQV,IAAIC,EAAMpR,SAASqR,cAAc,OACjCD,EAAI3N,MAAMmD,MAAQ,QAClBwK,EAAI3N,MAAM6N,QAAU,kBACpBF,EAAI3N,MAAM8N,YAAc,QACxBH,EAAI3N,MAAM+N,YAAc,kBACxBJ,EAAI3N,MAAMgO,UAAY,aAEtB,IAAIC,EAAO1R,SAAS0R,MAAQ1R,SAASuL,gBACrCmG,EAAKC,YAAaP,GAClB,IAAI3N,EAAQwN,EAAUG,GAEtBF,EAA8D,KAA7CxJ,KAAKkK,MAAOhB,EAAcnN,EAAMmD,QACjDpG,EAAQ0Q,eAAiBA,EAEzBQ,EAAK1B,YAAaoB,IAMlBS,GAGoB,iBAAR/M,IACVA,EAAO9E,SAAS+E,cAAeD,IAI3BA,GAAuB,iBAARA,GAAqBA,EAAKgN,SAA/C,CAIA,IAAIrO,EAAQwN,EAAUnM,GAGtB,GAAsB,QAAjBrB,EAAMwM,QACT,OA5FJ,WASE,IARA,IAAItL,EAAO,CACTiC,MAAO,EACPC,OAAQ,EACRyD,WAAY,EACZyH,YAAa,EACbC,WAAY,EACZC,YAAa,GAELhY,EAAE,EAAGA,EAAI+W,EAAoB/W,IAErC0K,EADkBoM,EAAa9W,IACT,EAExB,OAAO0K,EA+EEuN,GAGT,IAAIvN,EAAO,GACXA,EAAKiC,MAAQ9B,EAAKqN,YAClBxN,EAAKkC,OAAS/B,EAAK6J,aAKnB,IAHA,IAAI1H,EAActC,EAAKsC,YAAiC,cAAnBxD,EAAMgO,UAGjCxX,EAAE,EAAGA,EAAI+W,EAAoB/W,IAAM,CAC3C,IAAI4K,EAAckM,EAAa9W,GAC3BiB,EAAQuI,EAAOoB,GACfsB,EAAME,WAAYnL,GAEtByJ,EAAME,GAAiBiI,MAAO3G,GAAc,EAANA,EAGxC,IAAIiM,EAAezN,EAAKuC,YAAcvC,EAAKwC,aACvCkL,EAAgB1N,EAAK4C,WAAa5C,EAAK2C,cACvCgL,EAAc3N,EAAK+E,WAAa/E,EAAKiF,YACrC2I,EAAe5N,EAAKgF,UAAYhF,EAAKkF,aACrC2H,EAAc7M,EAAKyC,gBAAkBzC,EAAK0C,iBAC1CmL,EAAe7N,EAAK6C,eAAiB7C,EAAK8C,kBAE1CgL,EAAuBxL,GAAeiK,EAGtCwB,EAAa9B,EAAcnN,EAAMmD,QACjB,IAAf8L,IACH/N,EAAKiC,MAAQ8L,GAETD,EAAuB,EAAIL,EAAeZ,IAGhD,IAAImB,EAAc/B,EAAcnN,EAAMoD,QAatC,OAZqB,IAAhB8L,IACHhO,EAAKkC,OAAS8L,GAEVF,EAAuB,EAAIJ,EAAgBG,IAGjD7N,EAAK2F,WAAa3F,EAAKiC,OAAUwL,EAAeZ,GAChD7M,EAAKoN,YAAcpN,EAAKkC,QAAWwL,EAAgBG,GAEnD7N,EAAKqN,WAAarN,EAAKiC,MAAQ0L,EAC/B3N,EAAKsN,YAActN,EAAKkC,OAAS0L,EAE1B5N,GAGT,OAAOnE,IA/LY,mC,mBCZnB,IAAUjG,EAELqY,EACAC,EACAC,EAQAC,EAZKxY,EA6BPyF,SA3BE4S,EAAgBrY,EAAE8W,cAAc,SAChCwB,EAAa,qBAAsBtY,EACnCuY,EAAqB,SAASxS,EAAM0S,GAEnCH,EACFtY,EAAEwP,iBAAiBzJ,EAAM0S,GAEzBzY,EAAE0Y,YAAY,KAAO3S,EAAM0S,IAG1BD,EAAU,SAASG,GAEnBN,EAAcO,WAAaP,EAAcO,WAAWC,QAAUF,EAAWN,EAAcS,UAAYH,GAIvG3Y,EAAE+Y,qBAAqB,QAAQ,GAAG3B,YAAYiB,GAG9CE,EAAmB,aAAa,WAC/BC,EAAQ,qDAGTD,EAAmB,WAAW,WAC7BC,EAAQ,Q,sGC3BV,IAAIQ,EAA+B,WAC/B,SAASA,EAAcC,EAAalV,GAChChB,KAAKkW,YAAcA,EACnBlW,KAAKgB,UAAYA,EACjBhB,KAAKmW,kBAAoB,IAAIC,IAuCjC,OArCAH,EAAc1X,UAAU8X,QAAU,WAC9BrW,KAAKkW,YAAYzJ,iBAAiBzM,KAAKgB,UAAWhB,MAAM,IAE5DiW,EAAc1X,UAAU+X,WAAa,WACjCtW,KAAKkW,YAAYtJ,oBAAoB5M,KAAKgB,UAAWhB,MAAM,IAI/DiW,EAAc1X,UAAUgY,iBAAmB,SAAUC,GACjDxW,KAAKmW,kBAAkB1V,IAAI+V,IAG/BP,EAAc1X,UAAUkY,oBAAsB,SAAUD,GACpDxW,KAAKmW,kBAAkBO,OAAOF,IAElCP,EAAc1X,UAAUiO,YAAc,SAAUpK,GAE5C,IADA,IAAIuU,EAwBZ,SAAqBvU,GACjB,GAAI,gCAAiCA,EACjC,OAAOA,EAGP,IAAIwU,EAA6BxU,EAAMyU,yBACvC,OAAOxZ,OAAOyZ,OAAO1U,EAAO,CACxB2U,6BAA6B,EAC7BF,yBAA0B,WACtB7W,KAAK+W,6BAA8B,EACnCH,EAA2B9Z,KAAKkD,SAlCpBgX,CAAY5U,GACvB6U,EAAK,EAAGC,EAAKlX,KAAKmX,SAAUF,EAAKC,EAAGvV,OAAQsV,IAAM,CACvD,IAAIT,EAAUU,EAAGD,GACjB,GAAIN,EAAcI,4BACd,MAGAP,EAAQhK,YAAYmK,KAIhCtZ,OAAOC,eAAe2Y,EAAc1X,UAAW,WAAY,CACvDf,IAAK,WACD,OAAO4Z,MAAMhG,KAAKpR,KAAKmW,mBAAmBkB,MAAK,SAAUvL,EAAME,GAC3D,IAAIsL,EAAYxL,EAAKlK,MAAO2V,EAAavL,EAAMpK,MAC/C,OAAO0V,EAAYC,GAAc,EAAID,EAAYC,EAAa,EAAI,MAG1Eha,YAAY,EACZia,cAAc,IAEXvB,EA3CuB,GCClC,IAAI,EAA4B,WAC5B,SAASwB,EAAW9Y,GAChBqB,KAAKrB,YAAcA,EACnBqB,KAAK0X,kBAAoB,IAAIC,IAC7B3X,KAAK4X,SAAU,EAgEnB,OA9DAH,EAAWlZ,UAAUM,MAAQ,WACpBmB,KAAK4X,UACN5X,KAAK4X,SAAU,EACf5X,KAAK6X,eAAe5P,SAAQ,SAAU6P,GAAiB,OAAOA,EAAczB,eAGpFoB,EAAWlZ,UAAUwZ,KAAO,WACpB/X,KAAK4X,UACL5X,KAAK4X,SAAU,EACf5X,KAAK6X,eAAe5P,SAAQ,SAAU6P,GAAiB,OAAOA,EAAcxB,kBAGpFjZ,OAAOC,eAAema,EAAWlZ,UAAW,iBAAkB,CAC1Df,IAAK,WACD,OAAO4Z,MAAMhG,KAAKpR,KAAK0X,kBAAkBM,UACpCC,QAAO,SAAU7W,EAAWlC,GAAO,OAAOkC,EAAUyJ,OAAOuM,MAAMhG,KAAKlS,EAAI8Y,aAAe,KAElGza,YAAY,EACZia,cAAc,IAIlBC,EAAWlZ,UAAUgY,iBAAmB,SAAUC,GAC9CxW,KAAKkY,6BAA6B1B,GAASD,iBAAiBC,IAGhEiB,EAAWlZ,UAAUkY,oBAAsB,SAAUD,GACjDxW,KAAKkY,6BAA6B1B,GAASC,oBAAoBD,IAGnEiB,EAAWlZ,UAAU4Z,YAAc,SAAU3T,EAAOgP,EAAS4E,QAC1C,IAAXA,IAAqBA,EAAS,IAClCpY,KAAKrB,YAAYwZ,YAAY3T,EAAO,SAAWgP,EAAS4E,IAE5DX,EAAWlZ,UAAU2Z,6BAA+B,SAAU1B,GAC1D,IAAIN,EAAcM,EAAQN,YAAalV,EAAYwV,EAAQxV,UAC3D,OAAOhB,KAAKqY,mBAAmBnC,EAAalV,IAEhDyW,EAAWlZ,UAAU8Z,mBAAqB,SAAUnC,EAAalV,GAC7D,IAAIsX,EAAmBtY,KAAKuY,oCAAoCrC,GAC5D4B,EAAgBQ,EAAiB9a,IAAIwD,GAKzC,OAJK8W,IACDA,EAAgB9X,KAAKwY,oBAAoBtC,EAAalV,GACtDsX,EAAiBpY,IAAIc,EAAW8W,IAE7BA,GAEXL,EAAWlZ,UAAUia,oBAAsB,SAAUtC,EAAalV,GAC9D,IAAI8W,EAAgB,IAAI7B,EAAcC,EAAalV,GAInD,OAHIhB,KAAK4X,SACLE,EAAczB,UAEXyB,GAEXL,EAAWlZ,UAAUga,oCAAsC,SAAUrC,GACjE,IAAIoC,EAAmBtY,KAAK0X,kBAAkBla,IAAI0Y,GAKlD,OAJKoC,IACDA,EAAmB,IAAIX,IACvB3X,KAAK0X,kBAAkBxX,IAAIgW,EAAaoC,IAErCA,GAEJb,EApEoB,GCA3BgB,EAAoB,iDCAxB,IAAI,EAAwB,WACxB,SAASC,EAAOrY,EAASuB,EAAO+W,GAC5B3Y,KAAKK,QAAUA,EACfL,KAAK4B,MAAQA,EACb5B,KAAKkW,YAAcyC,EAAWzC,aAAe7V,EAC7CL,KAAKgB,UAAY2X,EAAW3X,WA6B7B,SAAuCX,GAC1C,IAAIuY,EAAUvY,EAAQuY,QAAQnH,cAC9B,GAAImH,KAAWC,EACX,OAAOA,EAAkBD,GAASvY,GAhCOyY,CAA8BzY,IAAYmE,EAAM,sBACzFxE,KAAKb,WAAawZ,EAAWxZ,YAAcqF,EAAM,sBACjDxE,KAAK+Y,WAAaJ,EAAWI,YAAcvU,EAAM,uBAgBrD,OAdAkU,EAAOM,SAAW,SAAUC,GACxB,OAAO,IAAIjZ,KAAKiZ,EAAM5Y,QAAS4Y,EAAMrX,ODTPsX,ECSoCD,EAAME,QDPxEvQ,EADSsQ,EAAiBE,OACT/Z,MAAMoZ,IAAsB,GAC1C,CACHvC,aAMkBmD,EANYzQ,EAAQ,GAOnB,UAAnByQ,EACOzY,OAEiB,YAAnByY,EACE3W,cADN,GATD1B,UAAW4H,EAAQ,GACnBzJ,WAAYyJ,EAAQ,GACpBmQ,WAAYnQ,EAAQ,MAG5B,IAA0ByQ,EAVYH,EAE9BtQ,GCSJ8P,EAAOna,UAAU+a,SAAW,WACxB,IAAIC,EAAkBvZ,KAAKqZ,gBAAkB,IAAMrZ,KAAKqZ,gBAAkB,GAC1E,MAAO,GAAKrZ,KAAKgB,UAAYuY,EAAkB,KAAOvZ,KAAKb,WAAa,IAAMa,KAAK+Y,YAEvF1b,OAAOC,eAAeob,EAAOna,UAAW,kBAAmB,CACvDf,IAAK,WACD,ODCyB0Y,ECDGlW,KAAKkW,cDEtBtV,OACR,SAEFsV,GAAexT,SACb,gBADN,EAJF,IAA8BwT,GCC7B3Y,YAAY,EACZia,cAAc,IAEXkB,EAvBgB,GA0BvBG,EAAoB,CACpB,EAAK,SAAUW,GAAK,MAAO,SAC3B,OAAU,SAAUA,GAAK,MAAO,SAChC,KAAQ,SAAUA,GAAK,MAAO,UAC9B,MAAS,SAAUA,GAAK,MAAiC,UAA1BA,EAAEC,aAAa,QAAsB,QAAU,UAC9E,OAAU,SAAUD,GAAK,MAAO,UAChC,SAAY,SAAUA,GAAK,MAAO,WAQtC,SAAShV,EAAMgP,GACX,MAAM,IAAIkG,MAAMlG,GC1CpB,IAAImG,EAAyB,WACzB,SAASA,EAAQ7a,EAAS8a,GACtB5Z,KAAKlB,QAAUA,EACfkB,KAAK4Z,OAASA,EAgGlB,OA9FAvc,OAAOC,eAAeqc,EAAQpb,UAAW,QAAS,CAC9Cf,IAAK,WACD,OAAOwC,KAAK4Z,OAAOhY,OAEvBrE,YAAY,EACZia,cAAc,IAElBna,OAAOC,eAAeqc,EAAQpb,UAAW,cAAe,CACpDf,IAAK,WACD,OAAOwC,KAAK4Z,OAAO1D,aAEvB3Y,YAAY,EACZia,cAAc,IAElBna,OAAOC,eAAeqc,EAAQpb,UAAW,aAAc,CACnDf,IAAK,WACD,OAAOwC,KAAKlB,QAAQK,YAExB5B,YAAY,EACZia,cAAc,IAElBmC,EAAQpb,UAAUiO,YAAc,SAAUpK,GAClCpC,KAAK6Z,qBAAqBzX,IAC1BpC,KAAK8Z,gBAAgB1X,IAG7B/E,OAAOC,eAAeqc,EAAQpb,UAAW,YAAa,CAClDf,IAAK,WACD,OAAOwC,KAAK4Z,OAAO5Y,WAEvBzD,YAAY,EACZia,cAAc,IAElBna,OAAOC,eAAeqc,EAAQpb,UAAW,SAAU,CAC/Cf,IAAK,WACD,IAAIsR,EAAS9O,KAAK+Z,WAAW/Z,KAAK+Y,YAClC,GAAqB,mBAAVjK,EACP,OAAOA,EAEX,MAAM,IAAI4K,MAAM,WAAc1Z,KAAK4Z,OAAS,kCAAsC5Z,KAAK+Y,WAAa,MAExGxb,YAAY,EACZia,cAAc,IAElBmC,EAAQpb,UAAUub,gBAAkB,SAAU1X,GAC1C,IACIpC,KAAK8O,OAAOhS,KAAKkD,KAAK+Z,WAAY3X,GAEtC,MAAOoC,GACH,IACI4T,EAAS,CAAEjZ,WADNa,KAAsBb,WACQ4a,WAD9B/Z,KAAkD+Z,WACI1Z,QADtDL,KAA2EK,QACHuB,MADxE5B,KAA+F4B,MACTQ,MAAOA,GACtGpC,KAAKlB,QAAQqZ,YAAY3T,EAAO,oBAAuBxE,KAAK4Z,OAAS,IAAMxB,KAGnFuB,EAAQpb,UAAUsb,qBAAuB,SAAUzX,GAC/C,IAAI8T,EAAc9T,EAAM4P,OACxB,OAAIhS,KAAKK,UAAY6V,MAGZA,aAAuB8D,SAAWha,KAAKK,QAAQ4Z,SAAS/D,KACtDlW,KAAKka,MAAMC,gBAAgBjE,KAM1C7Y,OAAOC,eAAeqc,EAAQpb,UAAW,aAAc,CACnDf,IAAK,WACD,OAAOwC,KAAKlB,QAAQib,YAExBxc,YAAY,EACZia,cAAc,IAElBna,OAAOC,eAAeqc,EAAQpb,UAAW,aAAc,CACnDf,IAAK,WACD,OAAOwC,KAAK4Z,OAAOb,YAEvBxb,YAAY,EACZia,cAAc,IAElBna,OAAOC,eAAeqc,EAAQpb,UAAW,UAAW,CAChDf,IAAK,WACD,OAAOwC,KAAKka,MAAM7Z,SAEtB9C,YAAY,EACZia,cAAc,IAElBna,OAAOC,eAAeqc,EAAQpb,UAAW,QAAS,CAC9Cf,IAAK,WACD,OAAOwC,KAAKlB,QAAQob,OAExB3c,YAAY,EACZia,cAAc,IAEXmC,EAnGiB,GCAxBS,EAAiC,WACjC,SAASA,EAAgB/Z,EAASga,GAC9B,IAAI/P,EAAQtK,KACZA,KAAKK,QAAUA,EACfL,KAAK4X,SAAU,EACf5X,KAAKqa,SAAWA,EAChBra,KAAKsa,SAAW,IAAIlE,IACpBpW,KAAKua,iBAAmB,IAAIC,kBAAiB,SAAUC,GAAa,OAAOnQ,EAAMoQ,iBAAiBD,MA+HtG,OA7HAL,EAAgB7b,UAAUM,MAAQ,WACzBmB,KAAK4X,UACN5X,KAAK4X,SAAU,EACf5X,KAAKua,iBAAiBI,QAAQ3a,KAAKK,QAAS,CAAEua,YAAY,EAAMC,WAAW,EAAMC,SAAS,IAC1F9a,KAAK+a,YAGbX,EAAgB7b,UAAUwZ,KAAO,WACzB/X,KAAK4X,UACL5X,KAAKua,iBAAiBS,cACtBhb,KAAKua,iBAAiBjE,aACtBtW,KAAK4X,SAAU,IAGvBwC,EAAgB7b,UAAUwc,QAAU,WAChC,GAAI/a,KAAK4X,QAAS,CAEd,IADA,IAAIhP,EAAU,IAAIwN,IAAIpW,KAAKib,uBAClBhE,EAAK,EAAGC,EAAKE,MAAMhG,KAAKpR,KAAKsa,UAAWrD,EAAKC,EAAGvV,OAAQsV,IAAM,CACnE,IAAI5W,EAAU6W,EAAGD,GACZrO,EAAQ9F,IAAIzC,IACbL,KAAKkb,cAAc7a,GAG3B,IAAK,IAAI8a,EAAK,EAAGC,EAAKhE,MAAMhG,KAAKxI,GAAUuS,EAAKC,EAAGzZ,OAAQwZ,IAAM,CACzD9a,EAAU+a,EAAGD,GACjBnb,KAAKqb,WAAWhb,MAK5B+Z,EAAgB7b,UAAUmc,iBAAmB,SAAUD,GACnD,GAAIza,KAAK4X,QACL,IAAK,IAAIX,EAAK,EAAGqE,EAAcb,EAAWxD,EAAKqE,EAAY3Z,OAAQsV,IAAM,CACrE,IAAIsE,EAAWD,EAAYrE,GAC3BjX,KAAKwb,gBAAgBD,KAIjCnB,EAAgB7b,UAAUid,gBAAkB,SAAUD,GAC7B,cAAjBA,EAASvY,KACThD,KAAKyb,uBAAuBF,EAASvJ,OAAQuJ,EAASG,eAEhC,aAAjBH,EAASvY,OACdhD,KAAK2b,oBAAoBJ,EAASK,cAClC5b,KAAK6b,kBAAkBN,EAASO,cAGxC1B,EAAgB7b,UAAUkd,uBAAyB,SAAUM,EAAML,GAC/D,IAAIrb,EAAU0b,EACV/b,KAAKsa,SAASxX,IAAIzC,GACdL,KAAKqa,SAAS2B,yBAA2Bhc,KAAKic,aAAa5b,GAC3DL,KAAKqa,SAAS2B,wBAAwB3b,EAASqb,GAG/C1b,KAAKkb,cAAc7a,GAGlBL,KAAKic,aAAa5b,IACvBL,KAAKqb,WAAWhb,IAGxB+Z,EAAgB7b,UAAUod,oBAAsB,SAAUO,GACtD,IAAK,IAAIjF,EAAK,EAAGC,EAAKE,MAAMhG,KAAK8K,GAAQjF,EAAKC,EAAGvV,OAAQsV,IAAM,CAC3D,IAAI8E,EAAO7E,EAAGD,GACV5W,EAAUL,KAAKmc,gBAAgBJ,GAC/B1b,GACAL,KAAKoc,YAAY/b,EAASL,KAAKkb,iBAI3Cd,EAAgB7b,UAAUsd,kBAAoB,SAAUK,GACpD,IAAK,IAAIjF,EAAK,EAAGC,EAAKE,MAAMhG,KAAK8K,GAAQjF,EAAKC,EAAGvV,OAAQsV,IAAM,CAC3D,IAAI8E,EAAO7E,EAAGD,GACV5W,EAAUL,KAAKmc,gBAAgBJ,GAC/B1b,GAAWL,KAAKqc,gBAAgBhc,IAChCL,KAAKoc,YAAY/b,EAASL,KAAKqb,cAK3CjB,EAAgB7b,UAAU0d,aAAe,SAAU5b,GAC/C,OAAOL,KAAKqa,SAAS4B,aAAa5b,IAEtC+Z,EAAgB7b,UAAU0c,oBAAsB,SAAUqB,GAEtD,YADa,IAATA,IAAmBA,EAAOtc,KAAKK,SAC5BL,KAAKqa,SAASY,oBAAoBqB,IAE7ClC,EAAgB7b,UAAU6d,YAAc,SAAUE,EAAMC,GACpD,IAAK,IAAItF,EAAK,EAAGC,EAAKlX,KAAKib,oBAAoBqB,GAAOrF,EAAKC,EAAGvV,OAAQsV,IAAM,CACxE,IAAI5W,EAAU6W,EAAGD,GACjBsF,EAAUzf,KAAKkD,KAAMK,KAG7B+Z,EAAgB7b,UAAU4d,gBAAkB,SAAUJ,GAClD,GAAIA,EAAKvH,UAAYgI,KAAKC,aACtB,OAAOV,GAGf3B,EAAgB7b,UAAU8d,gBAAkB,SAAUhc,GAClD,OAAIA,EAAQqc,aAAe1c,KAAKK,QAAQqc,aAI7B1c,KAAKK,QAAQ4Z,SAAS5Z,IAIrC+Z,EAAgB7b,UAAU8c,WAAa,SAAUhb,GACxCL,KAAKsa,SAASxX,IAAIzC,IACfL,KAAKqc,gBAAgBhc,KACrBL,KAAKsa,SAAS7Z,IAAIJ,GACdL,KAAKqa,SAASsC,gBACd3c,KAAKqa,SAASsC,eAAetc,KAK7C+Z,EAAgB7b,UAAU2c,cAAgB,SAAU7a,GAC5CL,KAAKsa,SAASxX,IAAIzC,KAClBL,KAAKsa,SAAS5D,OAAOrW,GACjBL,KAAKqa,SAASuC,kBACd5c,KAAKqa,SAASuC,iBAAiBvc,KAIpC+Z,EAtIyB,GCChC,EAAmC,WACnC,SAASyC,EAAkBxc,EAASqb,EAAerB,GAC/Cra,KAAK0b,cAAgBA,EACrB1b,KAAKqa,SAAWA,EAChBra,KAAK8c,gBAAkB,IAAI1C,EAAgB/Z,EAASL,MAwDxD,OAtDA3C,OAAOC,eAAeuf,EAAkBte,UAAW,UAAW,CAC1Df,IAAK,WACD,OAAOwC,KAAK8c,gBAAgBzc,SAEhC9C,YAAY,EACZia,cAAc,IAElBna,OAAOC,eAAeuf,EAAkBte,UAAW,WAAY,CAC3Df,IAAK,WACD,MAAO,IAAMwC,KAAK0b,cAAgB,KAEtCne,YAAY,EACZia,cAAc,IAElBqF,EAAkBte,UAAUM,MAAQ,WAChCmB,KAAK8c,gBAAgBje,SAEzBge,EAAkBte,UAAUwZ,KAAO,WAC/B/X,KAAK8c,gBAAgB/E,QAEzB8E,EAAkBte,UAAUwc,QAAU,WAClC/a,KAAK8c,gBAAgB/B,WAEzB1d,OAAOC,eAAeuf,EAAkBte,UAAW,UAAW,CAC1Df,IAAK,WACD,OAAOwC,KAAK8c,gBAAgBlF,SAEhCra,YAAY,EACZia,cAAc,IAGlBqF,EAAkBte,UAAU0d,aAAe,SAAU5b,GACjD,OAAOA,EAAQ0c,aAAa/c,KAAK0b,gBAErCmB,EAAkBte,UAAU0c,oBAAsB,SAAUqB,GACxD,IAAIjd,EAAQW,KAAKic,aAAaK,GAAQ,CAACA,GAAQ,GAC3C1T,EAAUwO,MAAMhG,KAAKkL,EAAK/Q,iBAAiBvL,KAAKgd,WACpD,OAAO3d,EAAMwL,OAAOjC,IAExBiU,EAAkBte,UAAUoe,eAAiB,SAAUtc,GAC/CL,KAAKqa,SAAS4C,yBACdjd,KAAKqa,SAAS4C,wBAAwB5c,EAASL,KAAK0b,gBAG5DmB,EAAkBte,UAAUqe,iBAAmB,SAAUvc,GACjDL,KAAKqa,SAAS6C,2BACdld,KAAKqa,SAAS6C,0BAA0B7c,EAASL,KAAK0b,gBAG9DmB,EAAkBte,UAAUyd,wBAA0B,SAAU3b,EAASqb,GACjE1b,KAAKqa,SAAS8C,8BAAgCnd,KAAK0b,eAAiBA,GACpE1b,KAAKqa,SAAS8C,6BAA6B9c,EAASqb,IAGrDmB,EA5D2B,GCD/B,SAASpc,EAAIvB,EAAKhB,EAAKN,GAC1Bwf,EAAMle,EAAKhB,GAAKuC,IAAI7C,GAEjB,SAASyf,EAAIne,EAAKhB,EAAKN,GAC1Bwf,EAAMle,EAAKhB,GAAKwY,OAAO9Y,GAWpB,SAAesB,EAAKhB,GACvB,IAAI8Z,EAAS9Y,EAAI1B,IAAIU,GACP,MAAV8Z,GAAiC,GAAfA,EAAO3Q,MACzBnI,EAAIwX,OAAOxY,GAbfof,CAAMpe,EAAKhB,GAER,SAASkf,EAAMle,EAAKhB,GACvB,IAAI8Z,EAAS9Y,EAAI1B,IAAIU,GAKrB,OAJK8Z,IACDA,EAAS,IAAI5B,IACblX,EAAIgB,IAAIhC,EAAK8Z,IAEVA,ECZX,ICAQuF,EDAJ,EAA0B,WAC1B,SAASC,IACLxd,KAAKyd,YAAc,IAAI9F,IAkD3B,OAhDAta,OAAOC,eAAekgB,EAASjf,UAAW,SAAU,CAChDf,IAAK,WAED,OADW4Z,MAAMhG,KAAKpR,KAAKyd,YAAYzF,UAC3BC,QAAO,SAAUD,EAAQ9X,GAAO,OAAO8X,EAAOnN,OAAOuM,MAAMhG,KAAKlR,MAAU,KAE1F3C,YAAY,EACZia,cAAc,IAElBna,OAAOC,eAAekgB,EAASjf,UAAW,OAAQ,CAC9Cf,IAAK,WAED,OADW4Z,MAAMhG,KAAKpR,KAAKyd,YAAYzF,UAC3BC,QAAO,SAAU5Q,EAAMnH,GAAO,OAAOmH,EAAOnH,EAAImH,OAAS,IAEzE9J,YAAY,EACZia,cAAc,IAElBgG,EAASjf,UAAUkC,IAAM,SAAUvC,EAAKN,GACpC6C,EAAIT,KAAKyd,YAAavf,EAAKN,IAE/B4f,EAASjf,UAAUmY,OAAS,SAAUxY,EAAKN,GACvCyf,EAAIrd,KAAKyd,YAAavf,EAAKN,IAE/B4f,EAASjf,UAAUuE,IAAM,SAAU5E,EAAKN,GACpC,IAAIoa,EAAShY,KAAKyd,YAAYjgB,IAAIU,GAClC,OAAiB,MAAV8Z,GAAkBA,EAAOlV,IAAIlF,IAExC4f,EAASjf,UAAUmf,OAAS,SAAUxf,GAClC,OAAO8B,KAAKyd,YAAY3a,IAAI5E,IAEhCsf,EAASjf,UAAUof,SAAW,SAAU/f,GAEpC,OADWwZ,MAAMhG,KAAKpR,KAAKyd,YAAYzF,UAC3B4F,MAAK,SAAU1d,GAAO,OAAOA,EAAI4C,IAAIlF,OAErD4f,EAASjf,UAAUsf,gBAAkB,SAAU3f,GAC3C,IAAI8Z,EAAShY,KAAKyd,YAAYjgB,IAAIU,GAClC,OAAO8Z,EAASZ,MAAMhG,KAAK4G,GAAU,IAEzCwF,EAASjf,UAAUuf,gBAAkB,SAAUlgB,GAC3C,OAAOwZ,MAAMhG,KAAKpR,KAAKyd,aAClB7d,QAAO,SAAUsX,GACRA,EAAG,GACb,OAD0BA,EAAG,GACfpU,IAAIlF,MAEjBsB,KAAI,SAAUgY,GACf,IAAIhZ,EAAMgZ,EAAG,GAAaA,EAAG,GAC7B,OAAOhZ,MAGRsf,EApDkB,GCDzBO,GACIR,EAAgBlgB,OAAO2gB,gBACtB,CAAEC,UAAW,cAAgB7G,OAAS,SAAUna,EAAGihB,GAAKjhB,EAAEghB,UAAYC,IACvE,SAAUjhB,EAAGihB,GAAK,IAAK,IAAIzf,KAAKyf,EAAOA,EAAE1f,eAAeC,KAAIxB,EAAEwB,GAAKyf,EAAEzf,KAClE,SAAUxB,EAAGihB,GAEhB,SAASC,IAAOne,KAAKgE,YAAc/G,EADnCsgB,EAActgB,EAAGihB,GAEjBjhB,EAAEsB,UAAkB,OAAN2f,EAAa7gB,OAAOY,OAAOigB,IAAMC,EAAG5f,UAAY2f,EAAE3f,UAAW,IAAI4f,KCLnF,GDUiC,SAAUC,GAE3C,SAASC,IACL,IAAI/T,EAAQ8T,EAAOthB,KAAKkD,OAASA,KAEjC,OADAsK,EAAMgU,YAAc,IAAI3G,IACjBrN,EAJXyT,EAAUM,EAAiBD,GAM3B/gB,OAAOC,eAAe+gB,EAAgB9f,UAAW,SAAU,CACvDf,IAAK,WACD,OAAO4Z,MAAMhG,KAAKpR,KAAKse,YAAYrf,SAEvC1B,YAAY,EACZia,cAAc,IAElB6G,EAAgB9f,UAAUkC,IAAM,SAAUvC,EAAKN,GAC3CwgB,EAAO7f,UAAUkC,IAAI3D,KAAKkD,KAAM9B,EAAKN,GACrC6C,EAAIT,KAAKse,YAAa1gB,EAAOM,IAEjCmgB,EAAgB9f,UAAUmY,OAAS,SAAUxY,EAAKN,GAC9CwgB,EAAO7f,UAAUmY,OAAO5Z,KAAKkD,KAAM9B,EAAKN,GACxCyf,EAAIrd,KAAKse,YAAa1gB,EAAOM,IAEjCmgB,EAAgB9f,UAAUof,SAAW,SAAU/f,GAC3C,OAAOoC,KAAKse,YAAYxb,IAAIlF,IAEhCygB,EAAgB9f,UAAUuf,gBAAkB,SAAUlgB,GAClD,IAAIsC,EAAMF,KAAKse,YAAY9gB,IAAII,GAC/B,OAAOsC,EAAMkX,MAAMhG,KAAKlR,GAAO,IA3BH,CA8BlC,GCxCqC,WACnC,SAASqe,EAAkBle,EAASqb,EAAerB,GAC/Cra,KAAKwe,kBAAoB,IAAI,EAAkBne,EAASqb,EAAe1b,MACvEA,KAAKqa,SAAWA,EAChBra,KAAKye,gBAAkB,IAAI,EAgF/B,OA9EAphB,OAAOC,eAAeihB,EAAkBhgB,UAAW,UAAW,CAC1Df,IAAK,WACD,OAAOwC,KAAKwe,kBAAkB5G,SAElCra,YAAY,EACZia,cAAc,IAElB+G,EAAkBhgB,UAAUM,MAAQ,WAChCmB,KAAKwe,kBAAkB3f,SAE3B0f,EAAkBhgB,UAAUwZ,KAAO,WAC/B/X,KAAKwe,kBAAkBzG,QAE3BwG,EAAkBhgB,UAAUwc,QAAU,WAClC/a,KAAKwe,kBAAkBzD,WAE3B1d,OAAOC,eAAeihB,EAAkBhgB,UAAW,UAAW,CAC1Df,IAAK,WACD,OAAOwC,KAAKwe,kBAAkBne,SAElC9C,YAAY,EACZia,cAAc,IAElBna,OAAOC,eAAeihB,EAAkBhgB,UAAW,gBAAiB,CAChEf,IAAK,WACD,OAAOwC,KAAKwe,kBAAkB9C,eAElCne,YAAY,EACZia,cAAc,IAGlB+G,EAAkBhgB,UAAU0e,wBAA0B,SAAU5c,GAC5DL,KAAK0e,cAAc1e,KAAK2e,qBAAqBte,KAEjDke,EAAkBhgB,UAAU4e,6BAA+B,SAAU9c,GACjE,IAAI6W,EAAKlX,KAAK4e,wBAAwBve,GAAUwe,EAAkB3H,EAAG,GAAI4H,EAAgB5H,EAAG,GAC5FlX,KAAK+e,gBAAgBF,GACrB7e,KAAK0e,cAAcI,IAEvBP,EAAkBhgB,UAAU2e,0BAA4B,SAAU7c,GAC9DL,KAAK+e,gBAAgB/e,KAAKye,gBAAgBZ,gBAAgBxd,KAE9Dke,EAAkBhgB,UAAUmgB,cAAgB,SAAUM,GAClD,IAAI1U,EAAQtK,KACZgf,EAAO/W,SAAQ,SAAUgR,GAAS,OAAO3O,EAAM2U,aAAahG,OAEhEsF,EAAkBhgB,UAAUwgB,gBAAkB,SAAUC,GACpD,IAAI1U,EAAQtK,KACZgf,EAAO/W,SAAQ,SAAUgR,GAAS,OAAO3O,EAAM4U,eAAejG,OAElEsF,EAAkBhgB,UAAU0gB,aAAe,SAAUhG,GACjDjZ,KAAKqa,SAAS4E,aAAahG,GAC3BjZ,KAAKye,gBAAgBhe,IAAIwY,EAAM5Y,QAAS4Y,IAE5CsF,EAAkBhgB,UAAU2gB,eAAiB,SAAUjG,GACnDjZ,KAAKqa,SAAS6E,eAAejG,GAC7BjZ,KAAKye,gBAAgB/H,OAAOuC,EAAM5Y,QAAS4Y,IAE/CsF,EAAkBhgB,UAAUqgB,wBAA0B,SAAUve,GAC5D,IA0BKyL,EAAME,EACXrK,EA3BIwd,EAAiBnf,KAAKye,gBAAgBZ,gBAAgBxd,GACtD+e,EAAgBpf,KAAK2e,qBAAqBte,GAC1Cgf,GAwBCvT,EAxByBqT,EAwBnBnT,EAxBmCoT,EAyB9Czd,EAASyI,KAAKC,IAAIyB,EAAKnK,OAAQqK,EAAMrK,QAClCyV,MAAMhG,KAAK,CAAEzP,OAAQA,IAAU,SAAU2d,EAAG1d,GAAS,MAAO,CAACkK,EAAKlK,GAAQoK,EAAMpK,QAzB9E2d,WAAU,SAAUrI,GAErB,OAyBZ,SAAwBpL,EAAME,GAC1B,OAAOF,GAAQE,GAASF,EAAKlK,OAASoK,EAAMpK,OAASkK,EAAKqN,SAAWnN,EAAMmN,QA1B3DqG,CADYtI,EAAG,GAAmBA,EAAG,OAGjD,OAA4B,GAAxBmI,EACO,CAAC,GAAI,IAGL,CAACF,EAAend,MAAMqd,GAAsBD,EAAcpd,MAAMqd,KAG/Ed,EAAkBhgB,UAAUogB,qBAAuB,SAAUte,GACzD,IAAIqb,EAAgB1b,KAAK0b,cAEzB,OAKR,SAA0B+D,EAAapf,EAASqb,GAC5C,OAAO+D,EAAYrG,OAAOsG,MAAM,OAAO9f,QAAO,SAAUuZ,GAAW,OAAOA,EAAQxX,UAC7EzC,KAAI,SAAUia,EAASvX,GAAS,MAAO,CAAGvB,QAASA,EAASqb,cAAeA,EAAevC,QAASA,EAASvX,MAAOA,MAP7G+d,CADWtf,EAAQoZ,aAAaiC,IAAkB,GACpBrb,EAASqb,IAE3C6C,EApF2B,ICDtC,IAAI,EAAmC,WACnC,SAASqB,EAAkBvf,EAASqb,EAAerB,GAC/Cra,KAAK6f,kBAAoB,IAAI,EAAkBxf,EAASqb,EAAe1b,MACvEA,KAAKqa,SAAWA,EAChBra,KAAK8f,oBAAsB,IAAIC,QAC/B/f,KAAKggB,uBAAyB,IAAID,QAyEtC,OAvEA1iB,OAAOC,eAAesiB,EAAkBrhB,UAAW,UAAW,CAC1Df,IAAK,WACD,OAAOwC,KAAK6f,kBAAkBjI,SAElCra,YAAY,EACZia,cAAc,IAElBoI,EAAkBrhB,UAAUM,MAAQ,WAChCmB,KAAK6f,kBAAkBhhB,SAE3B+gB,EAAkBrhB,UAAUwZ,KAAO,WAC/B/X,KAAK6f,kBAAkB9H,QAE3B6H,EAAkBrhB,UAAUwc,QAAU,WAClC/a,KAAK6f,kBAAkB9E,WAE3B1d,OAAOC,eAAesiB,EAAkBrhB,UAAW,UAAW,CAC1Df,IAAK,WACD,OAAOwC,KAAK6f,kBAAkBxf,SAElC9C,YAAY,EACZia,cAAc,IAElBna,OAAOC,eAAesiB,EAAkBrhB,UAAW,gBAAiB,CAChEf,IAAK,WACD,OAAOwC,KAAK6f,kBAAkBnE,eAElCne,YAAY,EACZia,cAAc,IAElBoI,EAAkBrhB,UAAU0gB,aAAe,SAAUhG,GACjD,IAAI5Y,EAAU4Y,EAAM5Y,QAChBzC,EAAQoC,KAAKigB,yBAAyBhH,GAAOrb,MAC7CA,IACAoC,KAAKkgB,6BAA6B7f,GAASH,IAAI+Y,EAAOrb,GACtDoC,KAAKqa,SAAS8F,oBAAoB9f,EAASzC,KAGnDgiB,EAAkBrhB,UAAU2gB,eAAiB,SAAUjG,GACnD,IAAI5Y,EAAU4Y,EAAM5Y,QAChBzC,EAAQoC,KAAKigB,yBAAyBhH,GAAOrb,MAC7CA,IACAoC,KAAKkgB,6BAA6B7f,GAASqW,OAAOuC,GAClDjZ,KAAKqa,SAAS+F,sBAAsB/f,EAASzC,KAGrDgiB,EAAkBrhB,UAAU0hB,yBAA2B,SAAUhH,GAC7D,IAAIoH,EAAcrgB,KAAK8f,oBAAoBtiB,IAAIyb,GAK/C,OAJKoH,IACDA,EAAcrgB,KAAKsgB,WAAWrH,GAC9BjZ,KAAK8f,oBAAoB5f,IAAI+Y,EAAOoH,IAEjCA,GAEXT,EAAkBrhB,UAAU2hB,6BAA+B,SAAU7f,GACjE,IAAIkgB,EAAgBvgB,KAAKggB,uBAAuBxiB,IAAI6C,GAKpD,OAJKkgB,IACDA,EAAgB,IAAI5I,IACpB3X,KAAKggB,uBAAuB9f,IAAIG,EAASkgB,IAEtCA,GAEXX,EAAkBrhB,UAAU+hB,WAAa,SAAUrH,GAC/C,IAEI,MAAO,CAAErb,MADGoC,KAAKqa,SAASmG,mBAAmBvH,IAGjD,MAAOzU,GACH,MAAO,CAAEA,MAAOA,KAGjBob,EA9E2B,GCElC,EAAiC,WACjC,SAASa,EAAgB3hB,EAASub,GAC9Bra,KAAKlB,QAAUA,EACfkB,KAAKqa,SAAWA,EAChBra,KAAK0gB,iBAAmB,IAAI/I,IAgFhC,OA9EA8I,EAAgBliB,UAAUM,MAAQ,WACzBmB,KAAK2gB,oBACN3gB,KAAK2gB,kBAAoB,IAAI,EAAkB3gB,KAAKK,QAASL,KAAK4gB,gBAAiB5gB,MACnFA,KAAK2gB,kBAAkB9hB,UAG/B4hB,EAAgBliB,UAAUwZ,KAAO,WACzB/X,KAAK2gB,oBACL3gB,KAAK2gB,kBAAkB5I,cAChB/X,KAAK2gB,kBACZ3gB,KAAK6gB,yBAGbxjB,OAAOC,eAAemjB,EAAgBliB,UAAW,UAAW,CACxDf,IAAK,WACD,OAAOwC,KAAKlB,QAAQuB,SAExB9C,YAAY,EACZia,cAAc,IAElBna,OAAOC,eAAemjB,EAAgBliB,UAAW,aAAc,CAC3Df,IAAK,WACD,OAAOwC,KAAKlB,QAAQK,YAExB5B,YAAY,EACZia,cAAc,IAElBna,OAAOC,eAAemjB,EAAgBliB,UAAW,kBAAmB,CAChEf,IAAK,WACD,OAAOwC,KAAK8gB,OAAOF,iBAEvBrjB,YAAY,EACZia,cAAc,IAElBna,OAAOC,eAAemjB,EAAgBliB,UAAW,SAAU,CACvDf,IAAK,WACD,OAAOwC,KAAKlB,QAAQgiB,QAExBvjB,YAAY,EACZia,cAAc,IAElBna,OAAOC,eAAemjB,EAAgBliB,UAAW,WAAY,CACzDf,IAAK,WACD,OAAO4Z,MAAMhG,KAAKpR,KAAK0gB,iBAAiB1I,WAE5Cza,YAAY,EACZia,cAAc,IAElBiJ,EAAgBliB,UAAUwiB,cAAgB,SAAUnH,GAChD,IAAIpD,EAAU,IAAImD,EAAQ3Z,KAAKlB,QAAS8a,GACxC5Z,KAAK0gB,iBAAiBxgB,IAAI0Z,EAAQpD,GAClCxW,KAAKqa,SAAS9D,iBAAiBC,IAEnCiK,EAAgBliB,UAAUyiB,iBAAmB,SAAUpH,GACnD,IAAIpD,EAAUxW,KAAK0gB,iBAAiBljB,IAAIoc,GACpCpD,IACAxW,KAAK0gB,iBAAiBhK,OAAOkD,GAC7B5Z,KAAKqa,SAAS5D,oBAAoBD,KAG1CiK,EAAgBliB,UAAUsiB,qBAAuB,WAC7C,IAAIvW,EAAQtK,KACZA,KAAKmX,SAASlP,SAAQ,SAAUuO,GAAW,OAAOlM,EAAM+P,SAAS5D,oBAAoBD,MACrFxW,KAAK0gB,iBAAiBO,SAG1BR,EAAgBliB,UAAUiiB,mBAAqB,SAAUvH,GACrD,IAAIW,EAAS,EAAOZ,SAASC,GAC7B,GAAIW,EAAOza,YAAca,KAAKb,WAC1B,OAAOya,GAGf6G,EAAgBliB,UAAU4hB,oBAAsB,SAAU9f,EAASuZ,GAC/D5Z,KAAK+gB,cAAcnH,IAEvB6G,EAAgBliB,UAAU6hB,sBAAwB,SAAU/f,EAASuZ,GACjE5Z,KAAKghB,iBAAiBpH,IAEnB6G,EApFyB,GCFhC,EAAyB,WACzB,SAASS,EAAQxkB,EAAQwd,GACrBla,KAAKtD,OAASA,EACdsD,KAAKka,MAAQA,EACbla,KAAK+Z,WAAa,IAAIrd,EAAO8C,sBAAsBQ,MACnDA,KAAKmhB,gBAAkB,IAAI,EAAgBnhB,KAAMA,KAAKohB,YACtD,IACIphB,KAAK+Z,WAAWsH,aAEpB,MAAO7c,GACHxE,KAAKmY,YAAY3T,EAAO,4BAsEhC,OAnEA0c,EAAQ3iB,UAAU8X,QAAU,WACxBrW,KAAKmhB,gBAAgBtiB,QACrB,IACImB,KAAK+Z,WAAW1D,UAEpB,MAAO7R,GACHxE,KAAKmY,YAAY3T,EAAO,2BAGhC0c,EAAQ3iB,UAAU+X,WAAa,WAC3B,IACItW,KAAK+Z,WAAWzD,aAEpB,MAAO9R,GACHxE,KAAKmY,YAAY3T,EAAO,4BAE5BxE,KAAKmhB,gBAAgBpJ,QAEzB1a,OAAOC,eAAe4jB,EAAQ3iB,UAAW,cAAe,CACpDf,IAAK,WACD,OAAOwC,KAAKtD,OAAOiC,aAEvBpB,YAAY,EACZia,cAAc,IAElBna,OAAOC,eAAe4jB,EAAQ3iB,UAAW,aAAc,CACnDf,IAAK,WACD,OAAOwC,KAAKtD,OAAOyC,YAEvB5B,YAAY,EACZia,cAAc,IAElBna,OAAOC,eAAe4jB,EAAQ3iB,UAAW,SAAU,CAC/Cf,IAAK,WACD,OAAOwC,KAAKrB,YAAYmiB,QAE5BvjB,YAAY,EACZia,cAAc,IAElBna,OAAOC,eAAe4jB,EAAQ3iB,UAAW,aAAc,CACnDf,IAAK,WACD,OAAOwC,KAAKrB,YAAYyiB,YAE5B7jB,YAAY,EACZia,cAAc,IAElBna,OAAOC,eAAe4jB,EAAQ3iB,UAAW,UAAW,CAChDf,IAAK,WACD,OAAOwC,KAAKka,MAAM7Z,SAEtB9C,YAAY,EACZia,cAAc,IAElBna,OAAOC,eAAe4jB,EAAQ3iB,UAAW,gBAAiB,CACtDf,IAAK,WACD,OAAOwC,KAAKK,QAAQihB,eAExB/jB,YAAY,EACZia,cAAc,IAGlB0J,EAAQ3iB,UAAU4Z,YAAc,SAAU3T,EAAOgP,EAAS4E,QACvC,IAAXA,IAAqBA,EAAS,IAClC,IAAejZ,EAANa,KAAsBb,WAAY4a,EAAlC/Z,KAAkD+Z,WAAY1Z,EAA9DL,KAA2EK,QACpF+X,EAAS/a,OAAOyZ,OAAO,CAAE3X,WAAYA,EAAY4a,WAAYA,EAAY1Z,QAASA,GAAW+X,GAC7FpY,KAAKrB,YAAYwZ,YAAY3T,EAAO,SAAWgP,EAAS4E,IAErD8I,EAhFiB,GCDxB,EAAwC,WACxC,IAAI3D,EAAgBlgB,OAAO2gB,gBACtB,CAAEC,UAAW,cAAgB7G,OAAS,SAAUna,EAAGihB,GAAKjhB,EAAEghB,UAAYC,IACvE,SAAUjhB,EAAGihB,GAAK,IAAK,IAAIzf,KAAKyf,EAAOA,EAAE1f,eAAeC,KAAIxB,EAAEwB,GAAKyf,EAAEzf,KACzE,OAAO,SAAUxB,EAAGihB,GAEhB,SAASC,IAAOne,KAAKgE,YAAc/G,EADnCsgB,EAActgB,EAAGihB,GAEjBjhB,EAAEsB,UAAkB,OAAN2f,EAAa7gB,OAAOY,OAAOigB,IAAMC,EAAG5f,UAAY2f,EAAE3f,UAAW,IAAI4f,IAP3C,GAiB5C,SAASoD,EAA2B/hB,GAChC,IAAIwE,EAAcD,EAAOvE,GAEzB,OADAwE,EAAYwd,QACLxd,EAEX,IAAID,EAAS,WACT,SAAS0d,EAAkBzd,GACvB,SAASrD,IACL,IAAI+gB,EAAa1hB,MAAQA,gBAAgBW,EAAaX,KAAKgE,iBAAc,EACzE,OAAO2d,QAAQC,UAAU5d,EAAayB,UAAWic,GAMrD,OAJA/gB,EAAWpC,UAAYlB,OAAOY,OAAO+F,EAAYzF,UAAW,CACxDyF,YAAa,CAAEpG,MAAO+C,KAE1BghB,QAAQ3D,eAAerd,EAAYqD,GAC5BrD,EAQX,IAEI,OANIud,EAAIuD,GADA,WAAczhB,KAAK6hB,EAAE/kB,KAAKkD,UAEhCzB,UAAUsjB,EAAI,aACT,IAAI3D,EAIJuD,EAEX,MAAOjd,GACH,OAAO,SAAUR,GAAe,OAAsB,SAAUoa,GAE5D,SAASzd,IACL,OAAkB,OAAXyd,GAAmBA,EAAOlc,MAAMlC,KAAMyF,YAAczF,KAE/D,OAJA,EAAUW,EAAYyd,GAIfzd,EAL0C,CAMnDqD,IAjBN,IAEQka,EAdC,GCpBT,EAAwB,WACxB,SAAS4D,EAAOnjB,EAAaojB,GACzB/hB,KAAKrB,YAAcA,EACnBqB,KAAK+hB,WDMN,SAAyBA,GAC5B,MAAO,CACH5iB,WAAY4iB,EAAW5iB,WACvBK,sBAAuB+hB,EAA2BQ,EAAWviB,wBCT3CwiB,CAAgBD,GAClC/hB,KAAKiiB,gBAAkB,IAAIlC,QAC3B/f,KAAKkiB,kBAAoB,IAAI9L,IA2CjC,OAzCA/Y,OAAOC,eAAewkB,EAAOvjB,UAAW,aAAc,CAClDf,IAAK,WACD,OAAOwC,KAAK+hB,WAAW5iB,YAE3B5B,YAAY,EACZia,cAAc,IAElBna,OAAOC,eAAewkB,EAAOvjB,UAAW,wBAAyB,CAC7Df,IAAK,WACD,OAAOwC,KAAK+hB,WAAWviB,uBAE3BjC,YAAY,EACZia,cAAc,IAElBna,OAAOC,eAAewkB,EAAOvjB,UAAW,WAAY,CAChDf,IAAK,WACD,OAAO4Z,MAAMhG,KAAKpR,KAAKkiB,oBAE3B3kB,YAAY,EACZia,cAAc,IAElBsK,EAAOvjB,UAAU4jB,uBAAyB,SAAUjI,GAChD,IAAIpb,EAAUkB,KAAKoiB,qBAAqBlI,GACxCla,KAAKkiB,kBAAkBzhB,IAAI3B,GAC3BA,EAAQuX,WAEZyL,EAAOvjB,UAAU8jB,0BAA4B,SAAUnI,GACnD,IAAIpb,EAAUkB,KAAKiiB,gBAAgBzkB,IAAI0c,GACnCpb,IACAkB,KAAKkiB,kBAAkBxL,OAAO5X,GAC9BA,EAAQwX,eAGhBwL,EAAOvjB,UAAU6jB,qBAAuB,SAAUlI,GAC9C,IAAIpb,EAAUkB,KAAKiiB,gBAAgBzkB,IAAI0c,GAKvC,OAJKpb,IACDA,EAAU,IAAI,EAAQkB,KAAMka,GAC5Bla,KAAKiiB,gBAAgB/hB,IAAIga,EAAOpb,IAE7BA,GAEJgjB,EAhDgB,GCFvBQ,EAAyB,WACzB,SAASA,EAAQpI,GACbla,KAAKka,MAAQA,EA0CjB,OAxCA7c,OAAOC,eAAeglB,EAAQ/jB,UAAW,UAAW,CAChDf,IAAK,WACD,OAAOwC,KAAKka,MAAM7Z,SAEtB9C,YAAY,EACZia,cAAc,IAElBna,OAAOC,eAAeglB,EAAQ/jB,UAAW,aAAc,CACnDf,IAAK,WACD,OAAOwC,KAAKka,MAAM/a,YAEtB5B,YAAY,EACZia,cAAc,IAElB8K,EAAQ/jB,UAAUf,IAAM,SAAUU,GAE9B,OADAA,EAAM8B,KAAKuiB,gBAAgBrkB,GACpB8B,KAAKK,QAAQoZ,aAAavb,IAErCokB,EAAQ/jB,UAAU2B,IAAM,SAAUhC,EAAKN,GAGnC,OAFAM,EAAM8B,KAAKuiB,gBAAgBrkB,GAC3B8B,KAAKK,QAAQK,aAAaxC,EAAKN,GACxBoC,KAAKxC,IAAIU,IAEpBokB,EAAQ/jB,UAAUuE,IAAM,SAAU5E,GAE9B,OADAA,EAAM8B,KAAKuiB,gBAAgBrkB,GACpB8B,KAAKK,QAAQ0c,aAAa7e,IAErCokB,EAAQ/jB,UAAUmY,OAAS,SAAUxY,GACjC,QAAI8B,KAAK8C,IAAI5E,KACTA,EAAM8B,KAAKuiB,gBAAgBrkB,GAC3B8B,KAAKK,QAAQG,gBAAgBtC,IACtB,IAMfokB,EAAQ/jB,UAAUgkB,gBAAkB,SAAUrkB,GAC1C,MAAO,QAAU8B,KAAKb,WAAa,IAAgBjB,EAM1CoB,QAAQ,YAAY,SAAUggB,EAAGkD,GAAQ,MAAO,IAAMA,EAAK/Q,kBAJjE6Q,EA5CiB,GCCrB,SAASG,EAA4B/G,EAAezC,GACvD,MAAO,IAAMyC,EAAgB,MAASzC,EAAQ,KCDlD,IAAI,EAA2B,WAC3B,SAASyJ,EAAUxI,GACfla,KAAKka,MAAQA,EAkDjB,OAhDA7c,OAAOC,eAAeolB,EAAUnkB,UAAW,UAAW,CAClDf,IAAK,WACD,OAAOwC,KAAKka,MAAM7Z,SAEtB9C,YAAY,EACZia,cAAc,IAElBna,OAAOC,eAAeolB,EAAUnkB,UAAW,aAAc,CACrDf,IAAK,WACD,OAAOwC,KAAKka,MAAM/a,YAEtB5B,YAAY,EACZia,cAAc,IAElBna,OAAOC,eAAeolB,EAAUnkB,UAAW,SAAU,CACjDf,IAAK,WACD,OAAOwC,KAAKka,MAAM4G,QAEtBvjB,YAAY,EACZia,cAAc,IAElBkL,EAAUnkB,UAAUuE,IAAM,SAAU6f,GAChC,OAAgC,MAAzB3iB,KAAK4iB,KAAKD,IAErBD,EAAUnkB,UAAUqkB,KAAO,WAEvB,IADA,IAAIC,EAAc,GACT5L,EAAK,EAAGA,EAAKxR,UAAU9D,OAAQsV,IACpC4L,EAAY5L,GAAMxR,UAAUwR,GAEhC,IAAI+F,EAAWhd,KAAK8iB,0BAA0BD,GAC9C,OAAO7iB,KAAKka,MAAM6I,YAAY/F,IAElC0F,EAAUnkB,UAAUykB,QAAU,WAE1B,IADA,IAAIH,EAAc,GACT5L,EAAK,EAAGA,EAAKxR,UAAU9D,OAAQsV,IACpC4L,EAAY5L,GAAMxR,UAAUwR,GAEhC,IAAI+F,EAAWhd,KAAK8iB,0BAA0BD,GAC9C,OAAO7iB,KAAKka,MAAM+I,gBAAgBjG,IAEtC0F,EAAUnkB,UAAUukB,0BAA4B,SAAUD,GACtD,IAAIvY,EAAQtK,KACZ,OAAO6iB,EAAY3jB,KAAI,SAAUyjB,GAAc,OAAOrY,EAAM4Y,yBAAyBP,MAAgBQ,KAAK,OAE9GT,EAAUnkB,UAAU2kB,yBAA2B,SAAUP,GACrD,IAAIS,EAAmBpjB,KAAKb,WAAa,IAAMwjB,EAC/C,OAAOF,EAA4BziB,KAAK8gB,OAAOuC,gBAAiBD,IAE7DV,EApDmB,GCE1B,EAAuB,WACvB,SAASY,EAAMxC,EAAQ3hB,EAAYkB,GAC/BL,KAAK8gB,OAASA,EACd9gB,KAAKb,WAAaA,EAClBa,KAAKK,QAAUA,EACfL,KAAKujB,QAAU,IAAI,EAAUvjB,MAC7BA,KAAK6C,KAAO,IAAIyf,EAAQtiB,MAwB5B,OAtBAsjB,EAAM/kB,UAAUwkB,YAAc,SAAU/F,GACpC,OAAOhd,KAAKijB,gBAAgBjG,GAAU,IAE1CsG,EAAM/kB,UAAU0kB,gBAAkB,SAAUjG,GACxC,IAAIwG,EAAOxjB,KAAKK,QAAQuI,QAAQoU,GAAY,CAAChd,KAAKK,SAAW,GACzDojB,EAAOzjB,KAAK0jB,eAAetM,MAAMhG,KAAKpR,KAAKK,QAAQkL,iBAAiByR,KACxE,OAAOwG,EAAK3Y,OAAO4Y,IAEvBH,EAAM/kB,UAAUmlB,eAAiB,SAAUpJ,GACvC,IAAIhQ,EAAQtK,KACZ,OAAOsa,EAAS1a,QAAO,SAAUS,GAAW,OAAOiK,EAAM6P,gBAAgB9Z,OAE7EijB,EAAM/kB,UAAU4b,gBAAkB,SAAU9Z,GACxC,OAAOA,EAAQsjB,QAAQ3jB,KAAK4jB,sBAAwB5jB,KAAKK,SAE7DhD,OAAOC,eAAegmB,EAAM/kB,UAAW,qBAAsB,CACzDf,IAAK,WACD,OAAOilB,EAA4BziB,KAAK8gB,OAAO+C,oBAAqB7jB,KAAKb,aAE7E5B,YAAY,EACZia,cAAc,IAEX8L,EA9Be,GCDtB,EAA+B,WAC/B,SAASQ,EAAczjB,EAASygB,EAAQzG,GACpCra,KAAKK,QAAUA,EACfL,KAAK8gB,OAASA,EACd9gB,KAAKqa,SAAWA,EAChBra,KAAK2gB,kBAAoB,IAAI,EAAkB3gB,KAAKK,QAASL,KAAK6jB,oBAAqB7jB,MACvFA,KAAK+jB,4BAA8B,IAAIhE,QACvC/f,KAAKgkB,qBAAuB,IAAIjE,QAqDpC,OAnDA+D,EAAcvlB,UAAUM,MAAQ,WAC5BmB,KAAK2gB,kBAAkB9hB,SAE3BilB,EAAcvlB,UAAUwZ,KAAO,WAC3B/X,KAAK2gB,kBAAkB5I,QAE3B1a,OAAOC,eAAewmB,EAAcvlB,UAAW,sBAAuB,CAClEf,IAAK,WACD,OAAOwC,KAAK8gB,OAAO+C,qBAEvBtmB,YAAY,EACZia,cAAc,IAIlBsM,EAAcvlB,UAAUiiB,mBAAqB,SAAUvH,GACnD,IAAI5Y,EAAU4Y,EAAM5Y,QAASlB,EAAa8Z,EAAME,QAC5C8K,EAAqBjkB,KAAKkkB,kCAAkC7jB,GAC5D6Z,EAAQ+J,EAAmBzmB,IAAI2B,GAKnC,OAJK+a,IACDA,EAAQ,IAAI,EAAMla,KAAK8gB,OAAQ3hB,EAAYkB,GAC3C4jB,EAAmB/jB,IAAIf,EAAY+a,IAEhCA,GAGX4J,EAAcvlB,UAAU4hB,oBAAsB,SAAU9f,EAASzC,GAC7D,IAAIumB,GAAkBnkB,KAAKgkB,qBAAqBxmB,IAAII,IAAU,GAAK,EACnEoC,KAAKgkB,qBAAqB9jB,IAAItC,EAAOumB,GACf,GAAlBA,GACAnkB,KAAKqa,SAAS+J,eAAexmB,IAIrCkmB,EAAcvlB,UAAU6hB,sBAAwB,SAAU/f,EAASzC,GAC/D,IAAIumB,EAAiBnkB,KAAKgkB,qBAAqBxmB,IAAII,GAC/CumB,IACAnkB,KAAKgkB,qBAAqB9jB,IAAItC,EAAOumB,EAAiB,GAChC,GAAlBA,GACAnkB,KAAKqa,SAASgK,kBAAkBzmB,KAI5CkmB,EAAcvlB,UAAU2lB,kCAAoC,SAAU7jB,GAClE,IAAI4jB,EAAqBjkB,KAAK+jB,4BAA4BvmB,IAAI6C,GAK9D,OAJK4jB,IACDA,EAAqB,IAAItM,IACzB3X,KAAK+jB,4BAA4B7jB,IAAIG,EAAS4jB,IAE3CA,GAEJH,EA5DuB,GCC9B,EAAwB,WACxB,SAASQ,EAAO3lB,GACZqB,KAAKrB,YAAcA,EACnBqB,KAAKukB,cAAgB,IAAI,EAAcvkB,KAAKK,QAASL,KAAK8gB,OAAQ9gB,MAClEA,KAAKikB,mBAAqB,IAAI,EAC9BjkB,KAAKwkB,oBAAsB,IAAI7M,IA6FnC,OA3FAta,OAAOC,eAAegnB,EAAO/lB,UAAW,UAAW,CAC/Cf,IAAK,WACD,OAAOwC,KAAKrB,YAAY0B,SAE5B9C,YAAY,EACZia,cAAc,IAElBna,OAAOC,eAAegnB,EAAO/lB,UAAW,SAAU,CAC9Cf,IAAK,WACD,OAAOwC,KAAKrB,YAAYmiB,QAE5BvjB,YAAY,EACZia,cAAc,IAElBna,OAAOC,eAAegnB,EAAO/lB,UAAW,sBAAuB,CAC3Df,IAAK,WACD,OAAOwC,KAAK8gB,OAAO+C,qBAEvBtmB,YAAY,EACZia,cAAc,IAElBna,OAAOC,eAAegnB,EAAO/lB,UAAW,UAAW,CAC/Cf,IAAK,WACD,OAAO4Z,MAAMhG,KAAKpR,KAAKwkB,oBAAoBxM,WAE/Cza,YAAY,EACZia,cAAc,IAElBna,OAAOC,eAAegnB,EAAO/lB,UAAW,WAAY,CAChDf,IAAK,WACD,OAAOwC,KAAKnD,QAAQob,QAAO,SAAUwM,EAAU/nB,GAAU,OAAO+nB,EAAS5Z,OAAOnO,EAAO+nB,YAAc,KAEzGlnB,YAAY,EACZia,cAAc,IAElB8M,EAAO/lB,UAAUM,MAAQ,WACrBmB,KAAKukB,cAAc1lB,SAEvBylB,EAAO/lB,UAAUwZ,KAAO,WACpB/X,KAAKukB,cAAcxM,QAEvBuM,EAAO/lB,UAAUmmB,eAAiB,SAAU3C,GACxC/hB,KAAK2kB,iBAAiB5C,EAAW5iB,YACjC,IAAIzC,EAAS,IAAI,EAAOsD,KAAKrB,YAAaojB,GAC1C/hB,KAAK4kB,cAAcloB,IAEvB4nB,EAAO/lB,UAAUomB,iBAAmB,SAAUxlB,GAC1C,IAAIzC,EAASsD,KAAKwkB,oBAAoBhnB,IAAI2B,GACtCzC,GACAsD,KAAK6kB,iBAAiBnoB,IAG9B4nB,EAAO/lB,UAAUumB,kCAAoC,SAAUzkB,EAASlB,GACpE,IAAIzC,EAASsD,KAAKwkB,oBAAoBhnB,IAAI2B,GAC1C,GAAIzC,EACA,OAAOA,EAAO+nB,SAAS7B,MAAK,SAAU9jB,GAAW,OAAOA,EAAQuB,SAAWA,MAKnFikB,EAAO/lB,UAAU4Z,YAAc,SAAU3T,EAAOgP,EAAS4E,GACrDpY,KAAKrB,YAAYwZ,YAAY3T,EAAOgP,EAAS4E,IAIjDkM,EAAO/lB,UAAU6lB,eAAiB,SAAUlK,GACxCla,KAAKikB,mBAAmBxjB,IAAIyZ,EAAM/a,WAAY+a,GAC9C,IAAIxd,EAASsD,KAAKwkB,oBAAoBhnB,IAAI0c,EAAM/a,YAC5CzC,GACAA,EAAOylB,uBAAuBjI,IAItCoK,EAAO/lB,UAAU8lB,kBAAoB,SAAUnK,GAC3Cla,KAAKikB,mBAAmBvN,OAAOwD,EAAM/a,WAAY+a,GACjD,IAAIxd,EAASsD,KAAKwkB,oBAAoBhnB,IAAI0c,EAAM/a,YAC5CzC,GACAA,EAAO2lB,0BAA0BnI,IAIzCoK,EAAO/lB,UAAUqmB,cAAgB,SAAUloB,GACvCsD,KAAKwkB,oBAAoBtkB,IAAIxD,EAAOyC,WAAYzC,GACnCsD,KAAKikB,mBAAmBpG,gBAAgBnhB,EAAOyC,YACrD8I,SAAQ,SAAUiS,GAAS,OAAOxd,EAAOylB,uBAAuBjI,OAE3EoK,EAAO/lB,UAAUsmB,iBAAmB,SAAUnoB,GAC1CsD,KAAKwkB,oBAAoB9N,OAAOha,EAAOyC,YAC1Ba,KAAKikB,mBAAmBpG,gBAAgBnhB,EAAOyC,YACrD8I,SAAQ,SAAUiS,GAAS,OAAOxd,EAAO2lB,0BAA0BnI,OAEvEoK,EAlGgB,GCHhBS,EAAgB,CACvBlB,oBAAqB,kBACrBjD,gBAAiB,cACjByC,gBAAiB,eCHjB2B,EAAwC,SAAUC,EAASC,EAAYC,EAAGC,GAC1E,OAAO,IAAKD,IAAMA,EAAIE,WAAU,SAAUC,EAASC,GAC/C,SAASC,EAAU5nB,GAAS,IAAM6nB,EAAKL,EAAUM,KAAK9nB,IAAW,MAAO4b,GAAK+L,EAAO/L,IACpF,SAASmM,EAAS/nB,GAAS,IAAM6nB,EAAKL,EAAiB,MAAExnB,IAAW,MAAO4b,GAAK+L,EAAO/L,IACvF,SAASiM,EAAKG,GAAUA,EAAOC,KAAOP,EAAQM,EAAOhoB,OAAS,IAAIunB,GAAE,SAAUG,GAAWA,EAAQM,EAAOhoB,UAAWkoB,KAAKN,EAAWG,GACnIF,GAAML,EAAYA,EAAUljB,MAAM+iB,EAASC,GAAc,KAAKQ,YAGlEK,EAA4C,SAAUd,EAAS7Q,GAC/D,IAAsG4R,EAAG1d,EAAGzK,EAAGooB,EAA3G3G,EAAI,CAAE4G,MAAO,EAAGC,KAAM,WAAa,GAAW,EAAPtoB,EAAE,GAAQ,MAAMA,EAAE,GAAI,OAAOA,EAAE,IAAOuoB,KAAM,GAAIC,IAAK,IAChG,OAAOJ,EAAI,CAAEP,KAAMY,EAAK,GAAI,MAASA,EAAK,GAAI,OAAUA,EAAK,IAAwB,mBAAX5oB,SAA0BuoB,EAAEvoB,OAAO6oB,UAAY,WAAa,OAAOvmB,OAAUimB,EACvJ,SAASK,EAAKloB,GAAK,OAAO,SAAUooB,GAAK,OACzC,SAAcC,GACV,GAAIT,EAAG,MAAM,IAAIU,UAAU,mCAC3B,KAAOpH,GAAG,IACN,GAAI0G,EAAI,EAAG1d,IAAMzK,EAAIyK,EAAU,EAARme,EAAG,GAAS,SAAWA,EAAG,GAAK,QAAU,YAAc5oB,EAAIA,EAAEf,KAAKwL,EAAGme,EAAG,KAAKZ,KAAM,OAAOhoB,EAEjH,OADIyK,EAAI,EAAGzK,IAAG4oB,EAAK,CAAC,EAAG5oB,EAAED,QACjB6oB,EAAG,IACP,KAAK,EAAG,KAAK,EAAG5oB,EAAI4oB,EAAI,MACxB,KAAK,EAAc,OAAXnH,EAAE4G,QAAgB,CAAEtoB,MAAO6oB,EAAG,GAAIZ,MAAM,GAChD,KAAK,EAAGvG,EAAE4G,QAAS5d,EAAIme,EAAG,GAAIA,EAAK,CAAC,GAAI,SACxC,KAAK,EAAGA,EAAKnH,EAAE+G,IAAIM,MAAOrH,EAAE8G,KAAKO,MAAO,SACxC,QACI,KAAM9oB,EAAIyhB,EAAE8G,MAAMvoB,EAAIA,EAAE8D,OAAS,GAAK9D,EAAEA,EAAE8D,OAAS,KAAkB,IAAV8kB,EAAG,IAAsB,IAAVA,EAAG,IAAW,CAAEnH,EAAI,EAAG,SACjG,GAAc,IAAVmH,EAAG,MAAc5oB,GAAM4oB,EAAG,GAAK5oB,EAAE,IAAM4oB,EAAG,GAAK5oB,EAAE,IAAM,CAAEyhB,EAAE4G,MAAQO,EAAG,GAAI,MAC9E,GAAc,IAAVA,EAAG,IAAYnH,EAAE4G,MAAQroB,EAAE,GAAI,CAAEyhB,EAAE4G,MAAQroB,EAAE,GAAIA,EAAI4oB,EAAI,MAC7D,GAAI5oB,GAAKyhB,EAAE4G,MAAQroB,EAAE,GAAI,CAAEyhB,EAAE4G,MAAQroB,EAAE,GAAIyhB,EAAE+G,IAAI/kB,KAAKmlB,GAAK,MACvD5oB,EAAE,IAAIyhB,EAAE+G,IAAIM,MAChBrH,EAAE8G,KAAKO,MAAO,SAEtBF,EAAKrS,EAAKtX,KAAKmoB,EAAS3F,GAC1B,MAAO9F,GAAKiN,EAAK,CAAC,EAAGjN,GAAIlR,EAAI,EAAK,QAAU0d,EAAInoB,EAAI,EACtD,GAAY,EAAR4oB,EAAG,GAAQ,MAAMA,EAAG,GAAI,MAAO,CAAE7oB,MAAO6oB,EAAG,GAAKA,EAAG,QAAK,EAAQZ,MAAM,GArB9BJ,CAAK,CAACrnB,EAAGooB,OA2BzD,EAA6B,WAC7B,SAAS5nB,EAAYyB,EAASygB,QACV,IAAZzgB,IAAsBA,EAAUqC,SAASuL,sBAC9B,IAAX6S,IAAqBA,EAASiE,GAClC/kB,KAAKK,QAAUA,EACfL,KAAK8gB,OAASA,EACd9gB,KAAKohB,WAAa,IAAI,EAAWphB,MACjCA,KAAK4mB,OAAS,IAAI,EAAO5mB,MA8D7B,OA5DApB,EAAYC,MAAQ,SAAUwB,EAASygB,GACnC,IAAIniB,EAAc,IAAIC,EAAYyB,EAASygB,GAE3C,OADAniB,EAAYE,QACLF,GAEXC,EAAYL,UAAUM,MAAQ,WAC1B,OAAOmmB,EAAUhlB,UAAM,OAAQ,GAAQ,WACnC,OAAO+lB,EAAY/lB,MAAM,SAAUkX,GAC/B,OAAQA,EAAGgP,OACP,KAAK,EAAG,MAAO,CAAC,EAuDzB,IAAIb,SAAQ,SAAUC,GACE,WAAvB5iB,SAASmkB,WACTnkB,SAAS+J,iBAAiB,mBAAoB6Y,GAG9CA,QA3DQ,KAAK,EAID,OAHApO,EAAGiP,OACHnmB,KAAK4mB,OAAO/nB,QACZmB,KAAKohB,WAAWviB,QACT,CAAC,WAK5BD,EAAYL,UAAUwZ,KAAO,WACzB/X,KAAK4mB,OAAO7O,OACZ/X,KAAKohB,WAAWrJ,QAEpBnZ,EAAYL,UAAUuoB,SAAW,SAAU3nB,EAAYK,GACnDQ,KAAKhB,KAAK,CAAEG,WAAYA,EAAYK,sBAAuBA,KAE/DZ,EAAYL,UAAUS,KAAO,SAAUwkB,GAGnC,IAFA,IAAIlZ,EAAQtK,KACR+mB,EAAO,GACF9P,EAAK,EAAGA,EAAKxR,UAAU9D,OAAQsV,IACpC8P,EAAK9P,EAAK,GAAKxR,UAAUwR,GAE7B,IAAI+P,EAAc5P,MAAM6P,QAAQzD,GAAQA,EAAO,CAACA,GAAM3Y,OAAOkc,GAC7DC,EAAY/e,SAAQ,SAAU8Z,GAAc,OAAOzX,EAAMsc,OAAOlC,eAAe3C,OAEnFnjB,EAAYL,UAAU2oB,OAAS,SAAU1D,GAGrC,IAFA,IAAIlZ,EAAQtK,KACR+mB,EAAO,GACF9P,EAAK,EAAGA,EAAKxR,UAAU9D,OAAQsV,IACpC8P,EAAK9P,EAAK,GAAKxR,UAAUwR,GAE7B,IAAIkQ,EAAc/P,MAAM6P,QAAQzD,GAAQA,EAAO,CAACA,GAAM3Y,OAAOkc,GAC7DI,EAAYlf,SAAQ,SAAU9I,GAAc,OAAOmL,EAAMsc,OAAOjC,iBAAiBxlB,OAErF9B,OAAOC,eAAesB,EAAYL,UAAW,cAAe,CAExDf,IAAK,WACD,OAAOwC,KAAK4mB,OAAOnC,SAASvlB,KAAI,SAAUJ,GAAW,OAAOA,EAAQib,eAExExc,YAAY,EACZia,cAAc,IAElB5Y,EAAYL,UAAU6oB,qCAAuC,SAAU/mB,EAASlB,GAC5E,IAAIL,EAAUkB,KAAK4mB,OAAO9B,kCAAkCzkB,EAASlB,GACrE,OAAOL,EAAUA,EAAQib,WAAa,MAG1Cnb,EAAYL,UAAU4Z,YAAc,SAAU3T,EAAOgP,EAAS4E,GAC1D/U,QAAQmB,MAAM,iBAAkBgP,EAAShP,EAAO4T,IAE7CxZ,EArEqB,GCrCzB,SAASyoB,EAAuBrjB,GACnC,IAAIzF,EAAYyF,EAAYzF,WA6BhC,SAAsCyF,GAClC,IAAIsjB,EAMR,SAAoCtjB,GAChC,IAAIsjB,EAAY,GAChB,KAAOtjB,GACHsjB,EAAUhmB,KAAK0C,GACfA,EAAc3G,OAAOkqB,eAAevjB,GAExC,OAAOsjB,EAZSE,CAA2BxjB,GAC3C,OAAOoT,MAAMhG,KAAKkW,EAAUrP,QAAO,SAAU4K,EAAa7e,GAEtD,OAWR,SAAyCA,GACrC,IAAI+d,EAAa/d,EAAqB,QACtC,OAAOoT,MAAM6P,QAAQlF,GAAcA,EAAa,GAd5C0F,CAAgCzjB,GAAaiE,SAAQ,SAAU/K,GAAQ,OAAO2lB,EAAYpiB,IAAIvD,MACvF2lB,IACR,IAAIzM,OAjCWsR,CAA6B1jB,GACnCiE,SAAQ,SAAU/K,GAC1B,IAAIga,EA6CoB7Y,EAAQspB,EA5ChC,OA4CwBtpB,EA5CME,GAAY2Y,EAAK,IACxCha,EAAO,UAAY,CAClBM,IAAK,WACD,IAAIwU,EAAShS,KAAKujB,QAAQX,KAAK1lB,GAC/B,GAAI8U,EACA,OAAOA,EAGP,MAAM,IAAI0H,MAAM,2BAA8B1Z,KAAKb,WAAa,IAAMjC,EAAO,OAIzFga,EAAGha,EAAO,WAAa,CACnBM,IAAK,WACD,OAAOwC,KAAKujB,QAAQP,QAAQ9lB,KAGpCga,EAAG,MAmCf,SAAoBha,GAChB,OAAOA,EAAK0qB,OAAO,GAAGC,cAAgB3qB,EAAK8E,MAAM,GApC9B8lB,CAAW5qB,GAAQ,UAAY,CACtCM,IAAK,WACD,OAAOwC,KAAKujB,QAAQzgB,IAAI5F,KAyBJyqB,EAtB5BzQ,OAuBR7Z,OAAO4B,KAAK0oB,GAAY1f,SAAQ,SAAU/K,GACtC,KAAMA,KAAQmB,GAAS,CACnB,IAAIsa,EAAagP,EAAWzqB,GAC5BG,OAAOC,eAAee,EAAQnB,EAAMyb,UCrDhD,IAAI,EAA4B,WAC5B,SAAShY,EAAW7B,GAChBkB,KAAKlB,QAAUA,EAyDnB,OAvDA6B,EAAW6gB,MAAQ,WACf6F,EAAuBrnB,OAE3B3C,OAAOC,eAAeqD,EAAWpC,UAAW,cAAe,CACvDf,IAAK,WACD,OAAOwC,KAAKlB,QAAQH,aAExBpB,YAAY,EACZia,cAAc,IAElBna,OAAOC,eAAeqD,EAAWpC,UAAW,QAAS,CACjDf,IAAK,WACD,OAAOwC,KAAKlB,QAAQob,OAExB3c,YAAY,EACZia,cAAc,IAElBna,OAAOC,eAAeqD,EAAWpC,UAAW,UAAW,CACnDf,IAAK,WACD,OAAOwC,KAAKka,MAAM7Z,SAEtB9C,YAAY,EACZia,cAAc,IAElBna,OAAOC,eAAeqD,EAAWpC,UAAW,aAAc,CACtDf,IAAK,WACD,OAAOwC,KAAKka,MAAM/a,YAEtB5B,YAAY,EACZia,cAAc,IAElBna,OAAOC,eAAeqD,EAAWpC,UAAW,UAAW,CACnDf,IAAK,WACD,OAAOwC,KAAKka,MAAMqJ,SAEtBhmB,YAAY,EACZia,cAAc,IAElBna,OAAOC,eAAeqD,EAAWpC,UAAW,OAAQ,CAChDf,IAAK,WACD,OAAOwC,KAAKka,MAAMrX,MAEtBtF,YAAY,EACZia,cAAc,IAElB7W,EAAWpC,UAAU8iB,WAAa,aAGlC1gB,EAAWpC,UAAU8X,QAAU,aAG/B1V,EAAWpC,UAAU+X,WAAa,aAGlC3V,EAAW4iB,QAAU,GACd5iB,EA3DoB,I,qBCD/B,SAOE,SAAUC,EAAQqC,GAMhB,EAAQ,CACN,gBAGD,KAFE,EAAF,SAAY8kB,GACX,OAgBK,SAAkBnnB,EAAQmnB,GAErC,aAEA,IAAI5kB,EAAQ,CAKZ,OAAe,SAAU0e,EAAG3D,GAC1B,IAAM,IAAIlP,KAAQkP,EAChB2D,EAAG7S,GAASkP,EAAGlP,GAEjB,OAAO6S,GAKT,OAAe,SAAUhZ,EAAKiL,GAC5B,OAAWjL,EAAMiL,EAAQA,GAAQA,IAK/BkU,EAAa5Q,MAAM7Y,UAAUyD,MAGjCmB,EAAMqI,UAAY,SAAUhD,GAC1B,OAAK4O,MAAM6P,QAASze,GAEXA,EAGJA,QACI,GAGuB,iBAAPA,GAAwC,iBAAdA,EAAI7G,OAG9CqmB,EAAWlrB,KAAM0L,GAInB,CAAEA,IAKXrF,EAAMmI,WAAa,SAAU2c,EAAKzf,GAChC,IAAI5G,EAAQqmB,EAAI5mB,QAASmH,IACV,GAAV5G,GACHqmB,EAAIpmB,OAAQD,EAAO,IAMvBuB,EAAM+kB,UAAY,SAAU1gB,EAAMwV,GAChC,KAAQxV,EAAKiL,YAAcjL,GAAQ9E,SAAS0R,MAE1C,GADA5M,EAAOA,EAAKiL,WACPsV,EAAiBvgB,EAAMwV,GAC1B,OAAOxV,GAQbrE,EAAMU,gBAAkB,SAAU2D,GAChC,MAAoB,iBAARA,EACH9E,SAAS+E,cAAeD,GAE1BA,GAMTrE,EAAMqJ,YAAc,SAAUpK,GAC5B,IAAI0M,EAAS,KAAO1M,EAAMY,KACrBhD,KAAM8O,IACT9O,KAAM8O,GAAU1M,IAMpBe,EAAMyD,mBAAqB,SAAUJ,EAAOwW,GAE1CxW,EAAQrD,EAAMqI,UAAWhF,GACzB,IAAI2hB,EAAU,GAyBd,OAvBA3hB,EAAMyB,SAAS,SAAUT,GAEvB,GAAQA,aAAgBE,YAIxB,GAAMsV,EAAN,CAMK+K,EAAiBvgB,EAAMwV,IAC1BmL,EAAQ7mB,KAAMkG,GAKhB,IAFA,IAAI4gB,EAAa5gB,EAAK+D,iBAAkByR,GAE9BrgB,EAAE,EAAGA,EAAIyrB,EAAWzmB,OAAQhF,IACpCwrB,EAAQ7mB,KAAM8mB,EAAWzrB,SAZzBwrB,EAAQ7mB,KAAMkG,MAgBX2gB,GAKThlB,EAAM2J,eAAiB,SAAUub,EAAQtP,EAAYuP,GACnDA,EAAYA,GAAa,IAEzB,IAAIxZ,EAASuZ,EAAO9pB,UAAWwa,GAC3BwP,EAAcxP,EAAa,UAE/BsP,EAAO9pB,UAAWwa,GAAe,WAC/B,IAAIyP,EAAUxoB,KAAMuoB,GACpBE,aAAcD,GAEd,IAAIzmB,EAAO0D,UACP6E,EAAQtK,KACZA,KAAMuoB,GAAgBG,YAAY,WAChC5Z,EAAO5M,MAAOoI,EAAOvI,UACduI,EAAOie,KACbD,KAMPnlB,EAAMwlB,SAAW,SAAUjT,GACzB,IAAImR,EAAankB,SAASmkB,WACP,YAAdA,GAA0C,eAAdA,EAE/B6B,WAAYhT,GAEZhT,SAAS+J,iBAAkB,mBAAoBiJ,IAOnDvS,EAAMylB,SAAW,SAAUC,GACzB,OAAOA,EAAIvpB,QAAS,eAAe,SAAUD,EAAOmS,EAAIsX,GACtD,OAAOtX,EAAK,IAAMsX,KACjBrX,eAGL,IAAIpO,EAAUzC,EAAOyC,QA4CrB,OAtCAF,EAAM0K,SAAW,SAAUkb,EAAatkB,GACtCtB,EAAMwlB,UAAU,WACd,IAAIK,EAAkB7lB,EAAMylB,SAAUnkB,GAClCwkB,EAAW,QAAUD,EACrBE,EAAgBxmB,SAAS6I,iBAAkB,IAAM0d,EAAW,KAC5DE,EAAczmB,SAAS6I,iBAAkB,OAASyd,GAClDxiB,EAAQrD,EAAMqI,UAAW0d,GAC1Bre,OAAQ1H,EAAMqI,UAAW2d,IACxBC,EAAkBH,EAAW,WAC7B3lB,EAAS1C,EAAO0C,OAEpBkD,EAAMyB,SAAS,SAAUT,GACvB,IAEI7D,EAFA0lB,EAAO7hB,EAAKiS,aAAcwP,IAC5BzhB,EAAKiS,aAAc2P,GAErB,IACEzlB,EAAU0lB,GAAQC,KAAKC,MAAOF,GAC9B,MAAQ7kB,GAMR,YAJKnB,GACHA,EAAQmB,MAAO,iBAAmBykB,EAAW,OAASzhB,EAAKgiB,UAC3D,KAAOhlB,IAKX,IAAIilB,EAAW,IAAIV,EAAavhB,EAAM7D,GAEjCL,GACHA,EAAOT,KAAM2E,EAAM/C,EAAWglB,UAS/BtmB,EA9NMF,CAASrC,EAAQmnB,IACzB,2BAVL,CAyBGnnB,S,u2DC3BD,WACEZ,KAAK0pB,cAAcC,S,mBAGrB,WACE3pB,KAAK0pB,cAAcE,a,wCARMjpB,G,EACV,CAAC,Y,27DCAlB,WACE,IAAMkpB,EAAO7pB,KAAKK,QAClBwpB,EAAKC,SAAW,WACiC,KAA3CD,EAAKlmB,QAAQkmB,EAAKE,eAAensB,QACnCosB,SAASC,KAAOJ,EAAKlmB,QAAQkmB,EAAKE,eAAensB,a,wCAL5B+C,I,qBCF7B,UAgCGC,OAnBC,EAAQ,CACJ,UACA,gBAEK,0BADN,EAgBI,SAAkB8C,EAAUR,GAEvC,aAKE,IAAIiQ,EAAUzP,EAASzF,OAAO,WAE9BkV,EAAQvN,cAAcskB,SAAW,aAEjC,IAAIppB,EAAQqS,EAAQ5U,UAiMpB,OA/LAuC,EAAMiG,aAAe,WACnB/G,KAAKkD,UACLlD,KAAKsH,gBAAiB,cAAe,cACrCtH,KAAKsH,gBAAiB,SAAU,cAChCtH,KAAKmqB,iBAGLnqB,KAAKoqB,MAAQ,GACb,IAAM,IAAIztB,EAAE,EAAGA,EAAIqD,KAAKqqB,KAAM1tB,IAC5BqD,KAAKoqB,MAAM9oB,KAAM,GAGnBtB,KAAKsqB,KAAO,EACZtqB,KAAKuqB,mBAAqB,GAG5BzpB,EAAMqpB,eAAiB,WAGrB,GAFAnqB,KAAKwqB,qBAECxqB,KAAKoT,YAAc,CACvB,IAAIqX,EAAYzqB,KAAKqG,MAAM,GACvBqkB,EAAgBD,GAAaA,EAAUpqB,QAE3CL,KAAKoT,YAAcsX,GAAiBxnB,EAASwnB,GAAgBhW,YAE3D1U,KAAK2qB,eAGT,IAAIvX,EAAcpT,KAAKoT,aAAepT,KAAK4qB,OAGvCD,EAAiB3qB,KAAK2qB,eAAiB3qB,KAAK4qB,OAC5CP,EAAOM,EAAiBvX,EAExByX,EAASzX,EAAcuX,EAAiBvX,EAG5CiX,EAAOjgB,KADUygB,GAAUA,EAAS,EAAI,QAAU,SACvBR,GAC3BrqB,KAAKqqB,KAAOjgB,KAAKC,IAAKggB,EAAM,IAG9BvpB,EAAM0pB,kBAAoB,WAExB,IACIM,EADa9qB,KAAKsE,WAAW,YACJtE,KAAKK,QAAQoS,WAAazS,KAAKK,QAGxDgH,EAAOnE,EAAS4nB,GACpB9qB,KAAK2qB,eAAiBtjB,GAAQA,EAAK2F,YAGrClM,EAAMoH,uBAAyB,SAAUvB,GACvCA,EAAKzD,UAEL,IAAI6nB,EAAYpkB,EAAKU,KAAKqN,WAAa1U,KAAKoT,YAGxC4X,EAAU5gB,KAFG2gB,GAAaA,EAAY,EAAI,QAAU,QAEtBpkB,EAAKU,KAAKqN,WAAa1U,KAAKoT,aAC9D4X,EAAU5gB,KAAK6gB,IAAKD,EAAShrB,KAAKqqB,MAalC,IAXA,IAEIa,EAAclrB,KAFCA,KAAK2D,QAAQwnB,gBAC9B,4BAA8B,sBACQH,EAASrkB,GAE7ChC,EAAW,CACb0D,EAAGrI,KAAKoT,YAAc8X,EAAYE,IAClC9iB,EAAG4iB,EAAY5iB,GAGb+iB,EAAYH,EAAY5iB,EAAI3B,EAAKU,KAAKsN,YACtC2W,EAASN,EAAUE,EAAYE,IACzBzuB,EAAIuuB,EAAYE,IAAKzuB,EAAI2uB,EAAQ3uB,IACzCqD,KAAKoqB,MAAMztB,GAAK0uB,EAGlB,OAAO1mB,GAGT7D,EAAMyqB,mBAAqB,SAAUP,GACnC,IAAIQ,EAAWxrB,KAAKyrB,gBAAiBT,GAEjCU,EAAWthB,KAAK6gB,IAAI/oB,MAAOkI,KAAMohB,GAErC,MAAO,CACLJ,IAAKI,EAASnqB,QAASqqB,GACvBpjB,EAAGojB,IAQP5qB,EAAM2qB,gBAAkB,SAAUT,GAChC,GAAKA,EAAU,EAEb,OAAOhrB,KAAKoqB,MAOd,IAJA,IAAIoB,EAAW,GAEXG,EAAa3rB,KAAKqqB,KAAO,EAAIW,EAEvBruB,EAAI,EAAGA,EAAIgvB,EAAYhvB,IAC/B6uB,EAAS7uB,GAAKqD,KAAK4rB,cAAejvB,EAAGquB,GAEvC,OAAOQ,GAGT1qB,EAAM8qB,cAAgB,SAAUR,EAAKJ,GACnC,GAAKA,EAAU,EACb,OAAOhrB,KAAKoqB,MAAOgB,GAGrB,IAAIS,EAAa7rB,KAAKoqB,MAAMpoB,MAAOopB,EAAKA,EAAMJ,GAE9C,OAAO5gB,KAAKC,IAAInI,MAAOkI,KAAMyhB,IAI/B/qB,EAAMgrB,0BAA4B,SAAUd,EAASrkB,GACnD,IAAIykB,EAAMprB,KAAKuqB,mBAAqBvqB,KAAKqqB,KAGzCe,EAFaJ,EAAU,GAAKI,EAAMJ,EAAUhrB,KAAKqqB,KAElC,EAAIe,EAEnB,IAAIW,EAAUplB,EAAKU,KAAKqN,YAAc/N,EAAKU,KAAKsN,YAGhD,OAFA3U,KAAKuqB,mBAAqBwB,EAAUX,EAAMJ,EAAUhrB,KAAKuqB,mBAElD,CACLa,IAAKA,EACL9iB,EAAGtI,KAAK4rB,cAAeR,EAAKJ,KAIhClqB,EAAM4K,aAAe,SAAUxF,GAC7B,IAAI8lB,EAAY9oB,EAASgD,GACrB+lB,EAASjsB,KAAKkM,kBAAmBhG,GAGjCgmB,EADelsB,KAAKsE,WAAW,cACP2nB,EAAOngB,KAAOmgB,EAAOjgB,MAC7CmgB,EAAQD,EAASF,EAAUtX,WAC3B0X,EAAWhiB,KAAKiiB,MAAOH,EAASlsB,KAAKoT,aACzCgZ,EAAWhiB,KAAKC,IAAK,EAAG+hB,GACxB,IAAIE,EAAUliB,KAAKiiB,MAAOF,EAAQnsB,KAAKoT,aAEvCkZ,GAAWH,EAAQnsB,KAAKoT,YAAc,EAAI,EAC1CkZ,EAAUliB,KAAK6gB,IAAKjrB,KAAKqqB,KAAO,EAAGiC,GAMnC,IAHA,IACIC,GADcvsB,KAAKsE,WAAW,aACF2nB,EAAOlgB,IAAMkgB,EAAOhgB,QAClD+f,EAAUrX,YACFhY,EAAIyvB,EAAUzvB,GAAK2vB,EAAS3vB,IACpCqD,KAAKoqB,MAAMztB,GAAKyN,KAAKC,IAAKkiB,EAAWvsB,KAAKoqB,MAAMztB,KAIpDmE,EAAMsI,kBAAoB,WACxBpJ,KAAKsqB,KAAOlgB,KAAKC,IAAInI,MAAOkI,KAAMpK,KAAKoqB,OACvC,IAAI/iB,EAAO,CACTkC,OAAQvJ,KAAKsqB,MAOf,OAJKtqB,KAAKsE,WAAW,cACnB+C,EAAKiC,MAAQtJ,KAAKwsB,yBAGbnlB,GAGTvG,EAAM0rB,sBAAwB,WAI5B,IAHA,IAAIC,EAAa,EAEb9vB,EAAIqD,KAAKqqB,OACH1tB,GACe,IAAlBqD,KAAKoqB,MAAMztB,IAGhB8vB,IAGF,OAASzsB,KAAKqqB,KAAOoC,GAAezsB,KAAKoT,YAAcpT,KAAK4qB,QAG9D9pB,EAAMiM,kBAAoB,WACxB,IAAI2f,EAAgB1sB,KAAK2qB,eAEzB,OADA3qB,KAAKwqB,oBACEkC,GAAiB1sB,KAAK2qB,gBAGxBxX,IA3NI,gC,qBCjBb,IAAIjU,EAAM,CACT,wBAAyB,OACzB,+BAAgC,OAChC,uBAAwB,OACxB,4BAA6B,OAC7B,wBAAyB,OACzB,6BAA8B,OAC9B,4BAA6B,QAI9B,SAASytB,EAAeC,GACvB,IAAIzoB,EAAK0oB,EAAsBD,GAC/B,OAAOrwB,EAAoB4H,GAE5B,SAAS0oB,EAAsBD,GAC9B,IAAIrwB,EAAoBa,EAAE8B,EAAK0tB,GAAM,CACpC,IAAIpT,EAAI,IAAIE,MAAM,uBAAyBkT,EAAM,KAEjD,MADApT,EAAEsT,KAAO,mBACHtT,EAEP,OAAOta,EAAI0tB,GAEZD,EAAe1tB,KAAO,WACrB,OAAO5B,OAAO4B,KAAKC,IAEpBytB,EAAerH,QAAUuH,EACzBnwB,EAAOD,QAAUkwB,EACjBA,EAAexoB,GAAK,Q,qBC5BpB,SAOE,SAAUlB,GAUX,QAPe,0BAAd,KAAc,mCACa,EAG3BvG,EAAOD,QAAUwG,MACU,EAEG,CAC9B,IAAI8pB,EAAansB,OAAOb,QACpBitB,EAAMpsB,OAAOb,QAAUkD,IAC3B+pB,EAAIC,WAAa,WAEhB,OADArsB,OAAOb,QAAUgtB,EACVC,IAfT,EAkBC,WACD,SAASjpB,IAGR,IAFA,IAAIpH,EAAI,EACJipB,EAAS,GACNjpB,EAAI8I,UAAU9D,OAAQhF,IAAK,CACjC,IAAIie,EAAanV,UAAW9I,GAC5B,IAAK,IAAIuB,KAAO0c,EACfgL,EAAO1nB,GAAO0c,EAAW1c,GAG3B,OAAO0nB,EAGR,SAASsH,EAAQxuB,GAChB,OAAOA,EAAEY,QAAQ,mBAAoB6tB,oBA0HtC,OAvHA,SAASC,EAAMC,GACd,SAASL,KAET,SAAS9sB,EAAKhC,EAAKN,EAAOgd,GACzB,GAAwB,oBAAblY,SAAX,CAQkC,iBAJlCkY,EAAa7W,EAAO,CACnBupB,KAAM,KACJN,EAAI/oB,SAAU2W,IAEKza,UACrBya,EAAWza,QAAU,IAAIotB,KAAkB,EAAb,IAAIA,KAAkC,MAArB3S,EAAWza,UAI3Dya,EAAWza,QAAUya,EAAWza,QAAUya,EAAWza,QAAQqtB,cAAgB,GAE7E,IACC,IAAI5H,EAAS0D,KAAKmE,UAAU7vB,GACxB,UAAU8vB,KAAK9H,KAClBhoB,EAAQgoB,GAER,MAAOpM,IAET5b,EAAQyvB,EAAUM,MACjBN,EAAUM,MAAM/vB,EAAOM,GACvB0vB,mBAAmBC,OAAOjwB,IACxB0B,QAAQ,4DAA6D6tB,oBAExEjvB,EAAM0vB,mBAAmBC,OAAO3vB,IAC9BoB,QAAQ,2BAA4B6tB,oBACpC7tB,QAAQ,UAAWwuB,QAErB,IAAIC,EAAwB,GAC5B,IAAK,IAAIrS,KAAiBd,EACpBA,EAAWc,KAGhBqS,GAAyB,KAAOrS,GACE,IAA9Bd,EAAWc,KAWfqS,GAAyB,IAAMnT,EAAWc,GAAegE,MAAM,KAAK,KAGrE,OAAQhd,SAASsrB,OAAS9vB,EAAM,IAAMN,EAAQmwB,GAG/C,SAASvwB,EAAKU,EAAK+vB,GAClB,GAAwB,oBAAbvrB,SAAX,CAUA,IANA,IAAIwrB,EAAM,GAGNC,EAAUzrB,SAASsrB,OAAStrB,SAASsrB,OAAOtO,MAAM,MAAQ,GAC1D/iB,EAAI,EAEDA,EAAIwxB,EAAQxsB,OAAQhF,IAAK,CAC/B,IAAIyxB,EAAQD,EAAQxxB,GAAG+iB,MAAM,KACzBsO,EAASI,EAAMpsB,MAAM,GAAGmhB,KAAK,KAE5B8K,GAA6B,MAArBD,EAAOpG,OAAO,KAC1BoG,EAASA,EAAOhsB,MAAM,GAAI,IAG3B,IACC,IAAI9E,EAAOgwB,EAAOkB,EAAM,IAIxB,GAHAJ,GAAUX,EAAUgB,MAAQhB,GAAWW,EAAQ9wB,IAC9CgwB,EAAOc,GAEJC,EACH,IACCD,EAAS1E,KAAKC,MAAMyE,GACnB,MAAOxU,IAKV,GAFA0U,EAAIhxB,GAAQ8wB,EAER9vB,IAAQhB,EACX,MAEA,MAAOsc,KAGV,OAAOtb,EAAMgwB,EAAIhwB,GAAOgwB,GAoBzB,OAjBAlB,EAAI9sB,IAAMA,EACV8sB,EAAIxvB,IAAM,SAAUU,GACnB,OAAOV,EAAIU,GAAK,IAEjB8uB,EAAIsB,QAAU,SAAUpwB,GACvB,OAAOV,EAAIU,GAAK,IAEjB8uB,EAAIzsB,OAAS,SAAUrC,EAAK0c,GAC3B1a,EAAIhC,EAAK,GAAI6F,EAAO6W,EAAY,CAC/Bza,SAAU,MAIZ6sB,EAAI/oB,SAAW,GAEf+oB,EAAIuB,cAAgBnB,EAEbJ,EAGDI,EAAK,mB,s1DC5JX,WACEptB,KAAKwuB,mBACLxuB,KAAKyuB,iB,0BAGP,WACE,IAAMC,EAAO1uB,KACb0uB,EAAKC,MAAQC,aAAY,WACvBF,EAAK9sB,QACD8sB,EAAK9sB,QAAU8sB,EAAKG,aAAaltB,SACnC+sB,EAAK9sB,MAAQ,KAEd,O,uBAGL,SAAUQ,GACRpC,KAAK4B,MAAQQ,EAAMG,cAAcC,QAAQZ,MACzCktB,cAAc9uB,KAAK2uB,OACnB3uB,KAAKyuB,iB,8BAGP,WAAmB,WACjBzuB,KAAK6uB,aAAa5mB,SAAQ,SAAC5H,EAASuB,GAC9BA,IAAU,EAAKA,OACjBvB,EAAQC,UAAUhB,QAAQ,YAAa,WACvCe,EAAQC,UAAUhB,QAAQ,YAAa,iBAEvCe,EAAQC,UAAUhB,QAAQ,UAAW,aACrCe,EAAQC,UAAUhB,QAAQ,cAAe,iBAG7CU,KAAK+uB,WAAW9mB,SAAQ,SAAC5H,EAASuB,GAC5BA,IAAU,EAAKA,MACjBvB,EAAQC,UAAUG,IAAI,YAEtBJ,EAAQC,UAAUC,OAAO,iB,uBAK/B,WACMP,KAAK4B,MAAQ5B,KAAK6uB,aAAaltB,OAAS,GAC1C3B,KAAK4B,U,2BAIT,WACM5B,KAAK4B,MAAQ,GACf5B,KAAK4B,U,iBAIT,WACE,OAAO5B,KAAK6C,KAAKC,IAAI,SAAWksB,SAAShvB,KAAK6C,KAAKrF,IAAI,UAAY,G,IAGrE,SAAUI,GACRoC,KAAK6C,KAAK3C,IAAI,QAAStC,GACvBoC,KAAKwuB,wB,wCA7DoB7tB,G,EACV,CAAC,QAAS,Q,27DCE3B,WACE,IAAMsuB,EAAYjvB,KAAKkvB,WACvBD,EAAUvuB,aAAa,cAAe,SACtCuuB,EAAU3uB,UAAUG,IAAI,yBACxBwuB,EAAUrsB,U,mBAGZ,SAAMR,GACJ,GAAsB,KAAlBA,EAAMW,SAAiC,UAAfX,EAAMY,KAAkB,CAClD,IAAMisB,EAAYjvB,KAAKkvB,WACvBD,EAAUvuB,aAAa,cAAe,QACtCuuB,EAAU3uB,UAAUC,OAAO,+B,wCAdJI,G,EACV,CAAC,S,gICHpB,SAMA,SAAYC,EAAQqC,GAAY,aAO5B,EAAQ,CACN,gBAGD,KAFE,EAAF,SAAYpC,GACX,OAoBN,SAAkBD,EAAQC,GAI1B,IAAIsuB,EAAIvuB,EAAO0C,OACXD,EAAUzC,EAAOyC,QAKrB,SAASU,EAAQ8d,EAAG3D,GAClB,IAAM,IAAIlP,KAAQkP,EAChB2D,EAAG7S,GAASkP,EAAGlP,GAEjB,OAAO6S,EAGT,IAAImG,EAAa5Q,MAAM7Y,UAAUyD,MA0BjC,SAASotB,EAAc5nB,EAAM7D,EAAS0rB,GAEpC,KAAQrvB,gBAAgBovB,GACtB,OAAO,IAAIA,EAAc5nB,EAAM7D,EAAS0rB,GAG1C,IA7BkB7mB,EA6Bd8mB,EAAY9nB,GACI,iBAARA,IACV8nB,EAAY5sB,SAAS6I,iBAAkB/D,IAGnC8nB,IAKNtvB,KAAKsa,UAvCa9R,EAuCS8mB,EAtCtBlY,MAAM6P,QAASze,GAEXA,EAGuB,iBAAPA,GAAwC,iBAAdA,EAAI7G,OAG9CqmB,EAAWlrB,KAAM0L,GAInB,CAAEA,IA2BTxI,KAAK2D,QAAUI,EAAQ,GAAI/D,KAAK2D,SAET,mBAAXA,EACV0rB,EAAW1rB,EAEXI,EAAQ/D,KAAK2D,QAASA,GAGnB0rB,GACHrvB,KAAKe,GAAI,SAAUsuB,GAGrBrvB,KAAKuvB,YAEAJ,IAEHnvB,KAAKwvB,WAAa,IAAIL,EAAEM,UAI1B/G,WAAY1oB,KAAK0vB,MAAMvxB,KAAM6B,QAzB3BqD,EAAQmB,MAAO,iCAAoC8qB,GAAa9nB,IA4BpE4nB,EAAa7wB,UAAYlB,OAAOY,OAAQ4C,EAAUtC,WAElD6wB,EAAa7wB,UAAUoF,QAAU,GAEjCyrB,EAAa7wB,UAAUgxB,UAAY,WACjCvvB,KAAK2vB,OAAS,GAGd3vB,KAAKsa,SAASrS,QAASjI,KAAK4vB,iBAAkB5vB,OAMhDovB,EAAa7wB,UAAUqxB,iBAAmB,SAAUpoB,GAE5B,OAAjBA,EAAKqoB,UACR7vB,KAAK8vB,SAAUtoB,IAGgB,IAA5BxH,KAAK2D,QAAQosB,YAChB/vB,KAAKgwB,2BAA4BxoB,GAKnC,IAAIgN,EAAWhN,EAAKgN,SACpB,GAAMA,GAAayb,EAAkBzb,GAArC,CAKA,IAFA,IAAI0b,EAAY1oB,EAAK+D,iBAAiB,OAE5B5O,EAAE,EAAGA,EAAIuzB,EAAUvuB,OAAQhF,IAAM,CACzC,IAAIwzB,EAAMD,EAAUvzB,GACpBqD,KAAK8vB,SAAUK,GAIjB,GAAuC,iBAA3BnwB,KAAK2D,QAAQosB,WAAyB,CAChD,IAAIxpB,EAAWiB,EAAK+D,iBAAkBvL,KAAK2D,QAAQosB,YACnD,IAAMpzB,EAAE,EAAGA,EAAI4J,EAAS5E,OAAQhF,IAAM,CACpC,IAAIyzB,EAAQ7pB,EAAS5J,GACrBqD,KAAKgwB,2BAA4BI,OAKvC,IAAIH,EAAmB,CACrBI,GAAG,EACHC,GAAG,EACHC,IAAI,GAwFN,SAASC,EAAcL,GACrBnwB,KAAKmwB,IAAMA,EAiEb,SAASM,EAAYC,EAAKrwB,GACxBL,KAAK0wB,IAAMA,EACX1wB,KAAKK,QAAUA,EACfL,KAAKmwB,IAAM,IAAIQ,MAgDjB,OA1MAvB,EAAa7wB,UAAUyxB,2BAA6B,SAAUxoB,GAC5D,IAAIrB,EAAQ+I,iBAAkB1H,GAC9B,GAAMrB,EAON,IAFA,IAAIyqB,EAAQ,0BACRhoB,EAAUgoB,EAAMC,KAAM1qB,EAAM2qB,iBACZ,OAAZloB,GAAmB,CACzB,IAAI8nB,EAAM9nB,GAAWA,EAAQ,GACxB8nB,GACH1wB,KAAK+wB,cAAeL,EAAKlpB,GAE3BoB,EAAUgoB,EAAMC,KAAM1qB,EAAM2qB,mBAOhC1B,EAAa7wB,UAAUuxB,SAAW,SAAUK,GAC1C,IAAIa,EAAe,IAAIR,EAAcL,GACrCnwB,KAAK2vB,OAAOruB,KAAM0vB,IAGpB5B,EAAa7wB,UAAUwyB,cAAgB,SAAUL,EAAKlpB,GACpD,IAAIuoB,EAAa,IAAIU,EAAYC,EAAKlpB,GACtCxH,KAAK2vB,OAAOruB,KAAMyuB,IAGpBX,EAAa7wB,UAAUmxB,MAAQ,WAC7B,IAAIplB,EAAQtK,KASZ,SAASixB,EAAYC,EAAO1pB,EAAMgM,GAEhCkV,YAAY,WACVpe,EAAM6mB,SAAUD,EAAO1pB,EAAMgM,MAXjCxT,KAAKoxB,gBAAkB,EACvBpxB,KAAKqxB,cAAe,EAEdrxB,KAAK2vB,OAAOhuB,OAYlB3B,KAAK2vB,OAAO1nB,SAAS,SAAU+oB,GAC7BA,EAAazvB,KAAM,WAAY0vB,GAC/BD,EAAatB,WAbb1vB,KAAKsxB,YAiBTlC,EAAa7wB,UAAU4yB,SAAW,SAAUD,EAAO1pB,EAAMgM,GACvDxT,KAAKoxB,kBACLpxB,KAAKqxB,aAAerxB,KAAKqxB,eAAiBH,EAAMK,SAEhDvxB,KAAK8B,UAAW,WAAY,CAAE9B,KAAMkxB,EAAO1pB,IACtCxH,KAAKwvB,YAAcxvB,KAAKwvB,WAAWgC,QACtCxxB,KAAKwvB,WAAWgC,OAAQxxB,KAAMkxB,GAG3BlxB,KAAKoxB,iBAAmBpxB,KAAK2vB,OAAOhuB,QACvC3B,KAAKsxB,WAGFtxB,KAAK2D,QAAQ8tB,OAASpuB,GACzBA,EAAQquB,IAAK,aAAele,EAAS0d,EAAO1pB,IAIhD4nB,EAAa7wB,UAAU+yB,SAAW,WAChC,IAAItwB,EAAYhB,KAAKqxB,aAAe,OAAS,OAI7C,GAHArxB,KAAK2xB,YAAa,EAClB3xB,KAAK8B,UAAWd,EAAW,CAAEhB,OAC7BA,KAAK8B,UAAW,SAAU,CAAE9B,OACvBA,KAAKwvB,WAAa,CACrB,IAAIoC,EAAW5xB,KAAKqxB,aAAe,SAAW,UAC9CrxB,KAAKwvB,WAAYoC,GAAY5xB,QAUjCwwB,EAAajyB,UAAYlB,OAAOY,OAAQ4C,EAAUtC,WAElDiyB,EAAajyB,UAAUmxB,MAAQ,WAGZ1vB,KAAK6xB,qBAGpB7xB,KAAK8xB,QAAmC,IAA1B9xB,KAAKmwB,IAAI4B,aAAoB,iBAK7C/xB,KAAKgyB,WAAa,IAAIrB,MACtB3wB,KAAKgyB,WAAWvlB,iBAAkB,OAAQzM,MAC1CA,KAAKgyB,WAAWvlB,iBAAkB,QAASzM,MAE3CA,KAAKmwB,IAAI1jB,iBAAkB,OAAQzM,MACnCA,KAAKmwB,IAAI1jB,iBAAkB,QAASzM,MACpCA,KAAKgyB,WAAWC,IAAMjyB,KAAKmwB,IAAI8B,MAGjCzB,EAAajyB,UAAUszB,mBAAqB,WAG1C,OAAO7xB,KAAKmwB,IAAImB,UAAYtxB,KAAKmwB,IAAI4B,cAGvCvB,EAAajyB,UAAUuzB,QAAU,SAAUP,EAAU/d,GACnDxT,KAAKuxB,SAAWA,EAChBvxB,KAAK8B,UAAW,WAAY,CAAE9B,KAAMA,KAAKmwB,IAAK3c,KAMhDgd,EAAajyB,UAAUiO,YAAc,SAAUpK,GAC7C,IAAI0M,EAAS,KAAO1M,EAAMY,KACrBhD,KAAM8O,IACT9O,KAAM8O,GAAU1M,IAIpBouB,EAAajyB,UAAU2zB,OAAS,WAC9BlyB,KAAK8xB,SAAS,EAAM,UACpB9xB,KAAKmyB,gBAGP3B,EAAajyB,UAAU6zB,QAAU,WAC/BpyB,KAAK8xB,SAAS,EAAO,WACrB9xB,KAAKmyB,gBAGP3B,EAAajyB,UAAU4zB,aAAe,WACpCnyB,KAAKgyB,WAAWplB,oBAAqB,OAAQ5M,MAC7CA,KAAKgyB,WAAWplB,oBAAqB,QAAS5M,MAC9CA,KAAKmwB,IAAIvjB,oBAAqB,OAAQ5M,MACtCA,KAAKmwB,IAAIvjB,oBAAqB,QAAS5M,OAYzCywB,EAAWlyB,UAAYlB,OAAOY,OAAQuyB,EAAajyB,WAEnDkyB,EAAWlyB,UAAUmxB,MAAQ,WAC3B1vB,KAAKmwB,IAAI1jB,iBAAkB,OAAQzM,MACnCA,KAAKmwB,IAAI1jB,iBAAkB,QAASzM,MACpCA,KAAKmwB,IAAI8B,IAAMjyB,KAAK0wB,IAEH1wB,KAAK6xB,uBAEpB7xB,KAAK8xB,QAAmC,IAA1B9xB,KAAKmwB,IAAI4B,aAAoB,gBAC3C/xB,KAAKmyB,iBAIT1B,EAAWlyB,UAAU4zB,aAAe,WAClCnyB,KAAKmwB,IAAIvjB,oBAAqB,OAAQ5M,MACtCA,KAAKmwB,IAAIvjB,oBAAqB,QAAS5M,OAGzCywB,EAAWlyB,UAAUuzB,QAAU,SAAUP,EAAU/d,GACjDxT,KAAKuxB,SAAWA,EAChBvxB,KAAK8B,UAAW,WAAY,CAAE9B,KAAMA,KAAKK,QAASmT,KAKpD4b,EAAaiD,iBAAmB,SAAU/uB,IACxCA,EAASA,GAAU1C,EAAO0C,WAK1B6rB,EAAI7rB,GAEFgvB,GAAGjf,aAAe,SAAU1P,EAAS+R,GAErC,OADe,IAAI0Z,EAAcpvB,KAAM2D,EAAS+R,GAChC8Z,WAAW+C,QAASpD,EAAEnvB,UAI1CovB,EAAaiD,mBAINjD,EAtWMnsB,CAASrC,EAAQC,IACzB,2BAXL,CA0BsB,oBAAXD,OAAyBA,OAASZ,O,qBChC7C,SAQE,SAAUY,EAAQqC,GAElB,kBAIiB,0BAAf,KAAe,kCANnB,CAeGrC,QAAQ,WACT,aAEA,IAAI4xB,EAAgB,WAClB,IAAIC,EAAY7xB,OAAOoZ,QAAQzb,UAE/B,GAAKk0B,EAAU7pB,QACb,MAAO,UAGT,GAAK6pB,EAAU1K,gBACb,MAAO,kBAKT,IAFA,IAAI2K,EAAW,CAAE,SAAU,MAAO,KAAM,KAE9B/1B,EAAE,EAAGA,EAAI+1B,EAAS/wB,OAAQhF,IAAM,CACxC,IACImS,EADS4jB,EAAS/1B,GACA,kBACtB,GAAK81B,EAAW3jB,GACd,OAAOA,GAjBO,GAsBpB,OAAO,SAA0BtH,EAAMwV,GACrC,OAAOxV,EAAMgrB,GAAiBxV,Q,qBC/C3BtgB,EAAOD,QAEL,WACP,aACA,SAASolB,EAAEA,GACT,OAAOzK,MAAM7Y,UAAUyD,MAAMlF,KAAK+kB,GAEpC,SAAS3D,EAAE2D,GACT,IAAI3D,EAAI8Q,SAASnN,EAAG,IACpB,OAAO8Q,EAAIzU,EAAIyU,EAAIzU,EAWrB,SAASjhB,EAAE4kB,EAAG3D,GACZ,IAAIjhB,EAAI4kB,EAAEgO,SAASpe,cACjB+H,EAAI9W,SAASqR,cAAc,OAC7ByF,EAAE/M,iBAAiB,QAAQ,WACzB,QAAUxP,EAbd,SAAW4kB,GACT,OACEA,EAAE9E,aAAa,oBACZ,IAAM8E,EAAEhN,aAAe,IAAMgN,EAAExQ,cAC3BwQ,EAAEnhB,aAAa,QAASmhB,EAAEkQ,cAAelQ,EAAEnhB,aAAa,SAAUmhB,EAAE+Q,iBACpE/Q,EAAEnhB,aAAa,QAASmhB,EAAEhN,aAAcgN,EAAEnhB,aAAa,SAAUmhB,EAAExQ,gBAC1EwQ,EAOc7kB,CAAE6kB,GAAGnhB,aAAa,MAAOwd,GAAM2D,EAAE1b,MAAM2qB,gBAAkB,OAAS5S,EAAI,OAEpF1E,EAAE9Y,aAAa,MAAOwd,GACtB2D,EAAEnhB,aAAatD,GAAG,GAEtB,SAASoc,EAAEqI,EAAG7kB,GACZ,IAAIwc,EAAI,EAAI/T,UAAU9D,aAAU,IAAW8D,UAAU,GAAKA,UAAU,GAAK,EACvEugB,EAAI9H,EAAE1E,GACR,GAAIxc,GAAK,EAAIgpB,EAAG,CACd,IAAIC,EAAIjpB,EAAEsC,QAAQ1C,EAAG,IAAMopB,EAAI,OAC/B/oB,EAAE4kB,EAAGoE,IAGT,SAASD,EAAEnE,EAAG3D,EAAGlhB,GACf,EAAI21B,GAAK11B,EAAE4kB,EAAG7kB,GAEhB,SAASipB,EAAE/H,GACT,OAAOA,EACH,mBAAqBA,EAAEjW,QAAUiW,EAAI2D,EAAE3D,GACvC,oBAAsBxb,SAAW,GAAKmf,EAAEnf,SAAS6I,iBAAiBnN,IAKxE,SAASzB,EAAEklB,GACToE,EAAEpE,GAAG5Z,SAAQ,SAAS4Z,GACpB,IAAKA,EAAEpI,aAAarc,GAAI,CACtB,IACEJ,EADM,QAAU6kB,EAAEgO,SAASpe,cACnBoQ,EAAEpI,aAAa,OAP/B,SAAWoI,GACT,OAAOA,EAAE1b,MAAM2qB,gBAAgBxxB,QAAQvC,EAAG,MAMJ81B,CAAEhR,GAClC5kB,EAAI4kB,EAAEpI,aAAa,YACnBwM,GAAKzW,MAAMwf,SAAS/xB,EAAG,KACzB,GAAI,OAASA,EAAG,OAChBgpB,EAAIzM,EAAEqI,EAAG7kB,EAAGC,GAAK+oB,EAAEnE,EAAG7kB,EAAGC,OAI/B,IAAI61B,EAAI,oBAAsBlyB,OAC5B+xB,EAAIvoB,KAAKkK,MAAMwe,GAAIlyB,OAAOmyB,kBAAwB,GAClDn2B,EAAI,4BACJG,EAAI,gCACJqB,EAAI,aACJhB,EAAI,qBACN,OACE01B,IACGlyB,OAAO6L,iBAAiB,QAAQ,WAC/B9P,OAEDiE,OAAOoyB,SAAWr2B,GACrBA,EAxEoBuhB","file":"/js/app.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","import 'remove-focus-outline'\nimport { Application } from 'stimulus'\nimport { definitionsFromContext } from 'stimulus/webpack-helpers'\n// import Turbolinks from 'turbolinks'\nimport retina from 'retinajs'\n\nconst application = Application.start()\nconst context = require.context('./controllers', true, /\\.js$/)\napplication.load(definitionsFromContext(context))\n\n/*\nTurbolinks.start()\n\ndocument.addEventListener('turbolinks:load', function() {\n  retina()\n})\n*/\n\nretina()\n","export function definitionsFromContext(context) {\n    return context.keys()\n        .map(function (key) { return definitionForModuleWithContextAndKey(context, key); })\n        .filter(function (value) { return value; });\n}\nfunction definitionForModuleWithContextAndKey(context, key) {\n    var identifier = identifierForContextKey(key);\n    if (identifier) {\n        return definitionForModuleAndIdentifier(context(key), identifier);\n    }\n}\nfunction definitionForModuleAndIdentifier(module, identifier) {\n    var controllerConstructor = module.default;\n    if (typeof controllerConstructor == \"function\") {\n        return { identifier: identifier, controllerConstructor: controllerConstructor };\n    }\n}\nexport function identifierForContextKey(key) {\n    var logicalName = (key.match(/^(?:\\.\\/)?(.+)(?:[_-]controller\\..+?)$/) || [])[1];\n    if (logicalName) {\n        return logicalName.replace(/_/g, \"-\").replace(/\\//g, \"--\");\n    }\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9pbmRleC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFPQSxNQUFNLGlDQUFpQyxPQUEwQztJQUMvRSxPQUFPLE9BQU8sQ0FBQyxJQUFJLEVBQUU7U0FDbEIsR0FBRyxDQUFDLFVBQUEsR0FBRyxJQUFJLE9BQUEsb0NBQW9DLENBQUMsT0FBTyxFQUFFLEdBQUcsQ0FBQyxFQUFsRCxDQUFrRCxDQUFDO1NBQzlELE1BQU0sQ0FBQyxVQUFBLEtBQUssSUFBSSxPQUFBLEtBQUssRUFBTCxDQUFLLENBQWlCLENBQUE7QUFDM0MsQ0FBQztBQUVELDhDQUE4QyxPQUEwQyxFQUFFLEdBQVc7SUFDbkcsSUFBTSxVQUFVLEdBQUcsdUJBQXVCLENBQUMsR0FBRyxDQUFDLENBQUE7SUFDL0MsSUFBSSxVQUFVLEVBQUU7UUFDZCxPQUFPLGdDQUFnQyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsRUFBRSxVQUFVLENBQUMsQ0FBQTtLQUNsRTtBQUNILENBQUM7QUFFRCwwQ0FBMEMsTUFBd0IsRUFBRSxVQUFrQjtJQUNwRixJQUFNLHFCQUFxQixHQUFHLE1BQU0sQ0FBQyxPQUFPLENBQUE7SUFDNUMsSUFBSSxPQUFPLHFCQUFxQixJQUFJLFVBQVUsRUFBRTtRQUM5QyxPQUFPLEVBQUUsVUFBVSxZQUFBLEVBQUUscUJBQXFCLHVCQUFBLEVBQUUsQ0FBQTtLQUM3QztBQUNILENBQUM7QUFFRCxNQUFNLGtDQUFrQyxHQUFXO0lBQ2pELElBQU0sV0FBVyxHQUFHLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyx3Q0FBd0MsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFBO0lBQ2xGLElBQUksV0FBVyxFQUFFO1FBQ2YsT0FBTyxXQUFXLENBQUMsT0FBTyxDQUFDLElBQUksRUFBRSxHQUFHLENBQUMsQ0FBQyxPQUFPLENBQUMsS0FBSyxFQUFFLElBQUksQ0FBQyxDQUFBO0tBQzNEO0FBQ0gsQ0FBQyJ9","import { Controller } from 'stimulus'\nimport Cookies from 'js-cookie'\n\nexport default class extends Controller {\n  connect() {\n    if (!Cookies.get('gdpr_accept')) {\n      this.show()\n    }\n  }\n\n  accept() {\n    Cookies.set('gdpr_accept', true, { expires: 365 })\n    this.hide()\n  }\n\n  show() {\n    this.element.classList.remove('hidden')\n    this.element.removeAttribute('aria-hidden')\n  }\n\n  hide() {\n    this.element.classList.add('hidden')\n    this.element.setAttribute('aria-hidden', true)\n  }\n}\n","/**\n * EvEmitter v1.1.0\n * Lil' event emitter\n * MIT License\n */\n\n/* jshint unused: true, undef: true, strict: true */\n\n( function( global, factory ) {\n  // universal module definition\n  /* jshint strict: false */ /* globals define, module, window */\n  if ( typeof define == 'function' && define.amd ) {\n    // AMD - RequireJS\n    define( factory );\n  } else if ( typeof module == 'object' && module.exports ) {\n    // CommonJS - Browserify, Webpack\n    module.exports = factory();\n  } else {\n    // Browser globals\n    global.EvEmitter = factory();\n  }\n\n}( typeof window != 'undefined' ? window : this, function() {\n\n\"use strict\";\n\nfunction EvEmitter() {}\n\nvar proto = EvEmitter.prototype;\n\nproto.on = function( eventName, listener ) {\n  if ( !eventName || !listener ) {\n    return;\n  }\n  // set events hash\n  var events = this._events = this._events || {};\n  // set listeners array\n  var listeners = events[ eventName ] = events[ eventName ] || [];\n  // only add once\n  if ( listeners.indexOf( listener ) == -1 ) {\n    listeners.push( listener );\n  }\n\n  return this;\n};\n\nproto.once = function( eventName, listener ) {\n  if ( !eventName || !listener ) {\n    return;\n  }\n  // add event\n  this.on( eventName, listener );\n  // set once flag\n  // set onceEvents hash\n  var onceEvents = this._onceEvents = this._onceEvents || {};\n  // set onceListeners object\n  var onceListeners = onceEvents[ eventName ] = onceEvents[ eventName ] || {};\n  // set flag\n  onceListeners[ listener ] = true;\n\n  return this;\n};\n\nproto.off = function( eventName, listener ) {\n  var listeners = this._events && this._events[ eventName ];\n  if ( !listeners || !listeners.length ) {\n    return;\n  }\n  var index = listeners.indexOf( listener );\n  if ( index != -1 ) {\n    listeners.splice( index, 1 );\n  }\n\n  return this;\n};\n\nproto.emitEvent = function( eventName, args ) {\n  var listeners = this._events && this._events[ eventName ];\n  if ( !listeners || !listeners.length ) {\n    return;\n  }\n  // copy over to avoid interference if .off() in listener\n  listeners = listeners.slice(0);\n  args = args || [];\n  // once stuff\n  var onceListeners = this._onceEvents && this._onceEvents[ eventName ];\n\n  for ( var i=0; i < listeners.length; i++ ) {\n    var listener = listeners[i]\n    var isOnce = onceListeners && onceListeners[ listener ];\n    if ( isOnce ) {\n      // remove listener\n      // remove before trigger to prevent recursion\n      this.off( eventName, listener );\n      // unset once flag\n      delete onceListeners[ listener ];\n    }\n    // trigger listener\n    listener.apply( this, args );\n  }\n\n  return this;\n};\n\nproto.allOff = function() {\n  delete this._events;\n  delete this._onceEvents;\n};\n\nreturn EvEmitter;\n\n}));\n","import { Controller } from 'stimulus'\n\nexport default class extends Controller {\n  open(event) {\n    event.preventDefault()\n    const modalId = event.currentTarget.dataset.modal\n    const modal = document.getElementById(modalId)\n    if (modal) {\n      modal.classList.add('modal--is-active')\n      modal.setAttribute('aria-hidden', 'false')\n      modal.focus()\n      this.data.set('id', modalId)\n    }\n  }\n\n  close(event) {\n    if (\n      this.data.has('id') &&\n      (event.keyCode === 27 || event.type === 'click')\n    ) {\n      const modalId = this.data.get('id')\n      const modal = document.getElementById(modalId)\n      if (modal) {\n        modal.classList.remove('modal--is-active')\n        modal.setAttribute('aria-hidden', 'true')\n      }\n      this.data.delete('id')\n    }\n  }\n}\n","/*!\n * Outlayer v2.1.1\n * the brains and guts of a layout library\n * MIT license\n */\n\n( function( window, factory ) {\n  'use strict';\n  // universal module definition\n  /* jshint strict: false */ /* globals define, module, require */\n  if ( typeof define == 'function' && define.amd ) {\n    // AMD - RequireJS\n    define( [\n        'ev-emitter/ev-emitter',\n        'get-size/get-size',\n        'fizzy-ui-utils/utils',\n        './item'\n      ],\n      function( EvEmitter, getSize, utils, Item ) {\n        return factory( window, EvEmitter, getSize, utils, Item);\n      }\n    );\n  } else if ( typeof module == 'object' && module.exports ) {\n    // CommonJS - Browserify, Webpack\n    module.exports = factory(\n      window,\n      require('ev-emitter'),\n      require('get-size'),\n      require('fizzy-ui-utils'),\n      require('./item')\n    );\n  } else {\n    // browser global\n    window.Outlayer = factory(\n      window,\n      window.EvEmitter,\n      window.getSize,\n      window.fizzyUIUtils,\n      window.Outlayer.Item\n    );\n  }\n\n}( window, function factory( window, EvEmitter, getSize, utils, Item ) {\n'use strict';\n\n// ----- vars ----- //\n\nvar console = window.console;\nvar jQuery = window.jQuery;\nvar noop = function() {};\n\n// -------------------------- Outlayer -------------------------- //\n\n// globally unique identifiers\nvar GUID = 0;\n// internal store of all Outlayer intances\nvar instances = {};\n\n\n/**\n * @param {Element, String} element\n * @param {Object} options\n * @constructor\n */\nfunction Outlayer( element, options ) {\n  var queryElement = utils.getQueryElement( element );\n  if ( !queryElement ) {\n    if ( console ) {\n      console.error( 'Bad element for ' + this.constructor.namespace +\n        ': ' + ( queryElement || element ) );\n    }\n    return;\n  }\n  this.element = queryElement;\n  // add jQuery\n  if ( jQuery ) {\n    this.$element = jQuery( this.element );\n  }\n\n  // options\n  this.options = utils.extend( {}, this.constructor.defaults );\n  this.option( options );\n\n  // add id for Outlayer.getFromElement\n  var id = ++GUID;\n  this.element.outlayerGUID = id; // expando\n  instances[ id ] = this; // associate via id\n\n  // kick it off\n  this._create();\n\n  var isInitLayout = this._getOption('initLayout');\n  if ( isInitLayout ) {\n    this.layout();\n  }\n}\n\n// settings are for internal use only\nOutlayer.namespace = 'outlayer';\nOutlayer.Item = Item;\n\n// default options\nOutlayer.defaults = {\n  containerStyle: {\n    position: 'relative'\n  },\n  initLayout: true,\n  originLeft: true,\n  originTop: true,\n  resize: true,\n  resizeContainer: true,\n  // item options\n  transitionDuration: '0.4s',\n  hiddenStyle: {\n    opacity: 0,\n    transform: 'scale(0.001)'\n  },\n  visibleStyle: {\n    opacity: 1,\n    transform: 'scale(1)'\n  }\n};\n\nvar proto = Outlayer.prototype;\n// inherit EvEmitter\nutils.extend( proto, EvEmitter.prototype );\n\n/**\n * set options\n * @param {Object} opts\n */\nproto.option = function( opts ) {\n  utils.extend( this.options, opts );\n};\n\n/**\n * get backwards compatible option value, check old name\n */\nproto._getOption = function( option ) {\n  var oldOption = this.constructor.compatOptions[ option ];\n  return oldOption && this.options[ oldOption ] !== undefined ?\n    this.options[ oldOption ] : this.options[ option ];\n};\n\nOutlayer.compatOptions = {\n  // currentName: oldName\n  initLayout: 'isInitLayout',\n  horizontal: 'isHorizontal',\n  layoutInstant: 'isLayoutInstant',\n  originLeft: 'isOriginLeft',\n  originTop: 'isOriginTop',\n  resize: 'isResizeBound',\n  resizeContainer: 'isResizingContainer'\n};\n\nproto._create = function() {\n  // get items from children\n  this.reloadItems();\n  // elements that affect layout, but are not laid out\n  this.stamps = [];\n  this.stamp( this.options.stamp );\n  // set container style\n  utils.extend( this.element.style, this.options.containerStyle );\n\n  // bind resize method\n  var canBindResize = this._getOption('resize');\n  if ( canBindResize ) {\n    this.bindResize();\n  }\n};\n\n// goes through all children again and gets bricks in proper order\nproto.reloadItems = function() {\n  // collection of item elements\n  this.items = this._itemize( this.element.children );\n};\n\n\n/**\n * turn elements into Outlayer.Items to be used in layout\n * @param {Array or NodeList or HTMLElement} elems\n * @returns {Array} items - collection of new Outlayer Items\n */\nproto._itemize = function( elems ) {\n\n  var itemElems = this._filterFindItemElements( elems );\n  var Item = this.constructor.Item;\n\n  // create new Outlayer Items for collection\n  var items = [];\n  for ( var i=0; i < itemElems.length; i++ ) {\n    var elem = itemElems[i];\n    var item = new Item( elem, this );\n    items.push( item );\n  }\n\n  return items;\n};\n\n/**\n * get item elements to be used in layout\n * @param {Array or NodeList or HTMLElement} elems\n * @returns {Array} items - item elements\n */\nproto._filterFindItemElements = function( elems ) {\n  return utils.filterFindElements( elems, this.options.itemSelector );\n};\n\n/**\n * getter method for getting item elements\n * @returns {Array} elems - collection of item elements\n */\nproto.getItemElements = function() {\n  return this.items.map( function( item ) {\n    return item.element;\n  });\n};\n\n// ----- init & layout ----- //\n\n/**\n * lays out all items\n */\nproto.layout = function() {\n  this._resetLayout();\n  this._manageStamps();\n\n  // don't animate first layout\n  var layoutInstant = this._getOption('layoutInstant');\n  var isInstant = layoutInstant !== undefined ?\n    layoutInstant : !this._isLayoutInited;\n  this.layoutItems( this.items, isInstant );\n\n  // flag for initalized\n  this._isLayoutInited = true;\n};\n\n// _init is alias for layout\nproto._init = proto.layout;\n\n/**\n * logic before any new layout\n */\nproto._resetLayout = function() {\n  this.getSize();\n};\n\n\nproto.getSize = function() {\n  this.size = getSize( this.element );\n};\n\n/**\n * get measurement from option, for columnWidth, rowHeight, gutter\n * if option is String -> get element from selector string, & get size of element\n * if option is Element -> get size of element\n * else use option as a number\n *\n * @param {String} measurement\n * @param {String} size - width or height\n * @private\n */\nproto._getMeasurement = function( measurement, size ) {\n  var option = this.options[ measurement ];\n  var elem;\n  if ( !option ) {\n    // default to 0\n    this[ measurement ] = 0;\n  } else {\n    // use option as an element\n    if ( typeof option == 'string' ) {\n      elem = this.element.querySelector( option );\n    } else if ( option instanceof HTMLElement ) {\n      elem = option;\n    }\n    // use size of element, if element\n    this[ measurement ] = elem ? getSize( elem )[ size ] : option;\n  }\n};\n\n/**\n * layout a collection of item elements\n * @api public\n */\nproto.layoutItems = function( items, isInstant ) {\n  items = this._getItemsForLayout( items );\n\n  this._layoutItems( items, isInstant );\n\n  this._postLayout();\n};\n\n/**\n * get the items to be laid out\n * you may want to skip over some items\n * @param {Array} items\n * @returns {Array} items\n */\nproto._getItemsForLayout = function( items ) {\n  return items.filter( function( item ) {\n    return !item.isIgnored;\n  });\n};\n\n/**\n * layout items\n * @param {Array} items\n * @param {Boolean} isInstant\n */\nproto._layoutItems = function( items, isInstant ) {\n  this._emitCompleteOnItems( 'layout', items );\n\n  if ( !items || !items.length ) {\n    // no items, emit event with empty array\n    return;\n  }\n\n  var queue = [];\n\n  items.forEach( function( item ) {\n    // get x/y object from method\n    var position = this._getItemLayoutPosition( item );\n    // enqueue\n    position.item = item;\n    position.isInstant = isInstant || item.isLayoutInstant;\n    queue.push( position );\n  }, this );\n\n  this._processLayoutQueue( queue );\n};\n\n/**\n * get item layout position\n * @param {Outlayer.Item} item\n * @returns {Object} x and y position\n */\nproto._getItemLayoutPosition = function( /* item */ ) {\n  return {\n    x: 0,\n    y: 0\n  };\n};\n\n/**\n * iterate over array and position each item\n * Reason being - separating this logic prevents 'layout invalidation'\n * thx @paul_irish\n * @param {Array} queue\n */\nproto._processLayoutQueue = function( queue ) {\n  this.updateStagger();\n  queue.forEach( function( obj, i ) {\n    this._positionItem( obj.item, obj.x, obj.y, obj.isInstant, i );\n  }, this );\n};\n\n// set stagger from option in milliseconds number\nproto.updateStagger = function() {\n  var stagger = this.options.stagger;\n  if ( stagger === null || stagger === undefined ) {\n    this.stagger = 0;\n    return;\n  }\n  this.stagger = getMilliseconds( stagger );\n  return this.stagger;\n};\n\n/**\n * Sets position of item in DOM\n * @param {Outlayer.Item} item\n * @param {Number} x - horizontal position\n * @param {Number} y - vertical position\n * @param {Boolean} isInstant - disables transitions\n */\nproto._positionItem = function( item, x, y, isInstant, i ) {\n  if ( isInstant ) {\n    // if not transition, just set CSS\n    item.goTo( x, y );\n  } else {\n    item.stagger( i * this.stagger );\n    item.moveTo( x, y );\n  }\n};\n\n/**\n * Any logic you want to do after each layout,\n * i.e. size the container\n */\nproto._postLayout = function() {\n  this.resizeContainer();\n};\n\nproto.resizeContainer = function() {\n  var isResizingContainer = this._getOption('resizeContainer');\n  if ( !isResizingContainer ) {\n    return;\n  }\n  var size = this._getContainerSize();\n  if ( size ) {\n    this._setContainerMeasure( size.width, true );\n    this._setContainerMeasure( size.height, false );\n  }\n};\n\n/**\n * Sets width or height of container if returned\n * @returns {Object} size\n *   @param {Number} width\n *   @param {Number} height\n */\nproto._getContainerSize = noop;\n\n/**\n * @param {Number} measure - size of width or height\n * @param {Boolean} isWidth\n */\nproto._setContainerMeasure = function( measure, isWidth ) {\n  if ( measure === undefined ) {\n    return;\n  }\n\n  var elemSize = this.size;\n  // add padding and border width if border box\n  if ( elemSize.isBorderBox ) {\n    measure += isWidth ? elemSize.paddingLeft + elemSize.paddingRight +\n      elemSize.borderLeftWidth + elemSize.borderRightWidth :\n      elemSize.paddingBottom + elemSize.paddingTop +\n      elemSize.borderTopWidth + elemSize.borderBottomWidth;\n  }\n\n  measure = Math.max( measure, 0 );\n  this.element.style[ isWidth ? 'width' : 'height' ] = measure + 'px';\n};\n\n/**\n * emit eventComplete on a collection of items events\n * @param {String} eventName\n * @param {Array} items - Outlayer.Items\n */\nproto._emitCompleteOnItems = function( eventName, items ) {\n  var _this = this;\n  function onComplete() {\n    _this.dispatchEvent( eventName + 'Complete', null, [ items ] );\n  }\n\n  var count = items.length;\n  if ( !items || !count ) {\n    onComplete();\n    return;\n  }\n\n  var doneCount = 0;\n  function tick() {\n    doneCount++;\n    if ( doneCount == count ) {\n      onComplete();\n    }\n  }\n\n  // bind callback\n  items.forEach( function( item ) {\n    item.once( eventName, tick );\n  });\n};\n\n/**\n * emits events via EvEmitter and jQuery events\n * @param {String} type - name of event\n * @param {Event} event - original event\n * @param {Array} args - extra arguments\n */\nproto.dispatchEvent = function( type, event, args ) {\n  // add original event to arguments\n  var emitArgs = event ? [ event ].concat( args ) : args;\n  this.emitEvent( type, emitArgs );\n\n  if ( jQuery ) {\n    // set this.$element\n    this.$element = this.$element || jQuery( this.element );\n    if ( event ) {\n      // create jQuery event\n      var $event = jQuery.Event( event );\n      $event.type = type;\n      this.$element.trigger( $event, args );\n    } else {\n      // just trigger with type if no event available\n      this.$element.trigger( type, args );\n    }\n  }\n};\n\n// -------------------------- ignore & stamps -------------------------- //\n\n\n/**\n * keep item in collection, but do not lay it out\n * ignored items do not get skipped in layout\n * @param {Element} elem\n */\nproto.ignore = function( elem ) {\n  var item = this.getItem( elem );\n  if ( item ) {\n    item.isIgnored = true;\n  }\n};\n\n/**\n * return item to layout collection\n * @param {Element} elem\n */\nproto.unignore = function( elem ) {\n  var item = this.getItem( elem );\n  if ( item ) {\n    delete item.isIgnored;\n  }\n};\n\n/**\n * adds elements to stamps\n * @param {NodeList, Array, Element, or String} elems\n */\nproto.stamp = function( elems ) {\n  elems = this._find( elems );\n  if ( !elems ) {\n    return;\n  }\n\n  this.stamps = this.stamps.concat( elems );\n  // ignore\n  elems.forEach( this.ignore, this );\n};\n\n/**\n * removes elements to stamps\n * @param {NodeList, Array, or Element} elems\n */\nproto.unstamp = function( elems ) {\n  elems = this._find( elems );\n  if ( !elems ){\n    return;\n  }\n\n  elems.forEach( function( elem ) {\n    // filter out removed stamp elements\n    utils.removeFrom( this.stamps, elem );\n    this.unignore( elem );\n  }, this );\n};\n\n/**\n * finds child elements\n * @param {NodeList, Array, Element, or String} elems\n * @returns {Array} elems\n */\nproto._find = function( elems ) {\n  if ( !elems ) {\n    return;\n  }\n  // if string, use argument as selector string\n  if ( typeof elems == 'string' ) {\n    elems = this.element.querySelectorAll( elems );\n  }\n  elems = utils.makeArray( elems );\n  return elems;\n};\n\nproto._manageStamps = function() {\n  if ( !this.stamps || !this.stamps.length ) {\n    return;\n  }\n\n  this._getBoundingRect();\n\n  this.stamps.forEach( this._manageStamp, this );\n};\n\n// update boundingLeft / Top\nproto._getBoundingRect = function() {\n  // get bounding rect for container element\n  var boundingRect = this.element.getBoundingClientRect();\n  var size = this.size;\n  this._boundingRect = {\n    left: boundingRect.left + size.paddingLeft + size.borderLeftWidth,\n    top: boundingRect.top + size.paddingTop + size.borderTopWidth,\n    right: boundingRect.right - ( size.paddingRight + size.borderRightWidth ),\n    bottom: boundingRect.bottom - ( size.paddingBottom + size.borderBottomWidth )\n  };\n};\n\n/**\n * @param {Element} stamp\n**/\nproto._manageStamp = noop;\n\n/**\n * get x/y position of element relative to container element\n * @param {Element} elem\n * @returns {Object} offset - has left, top, right, bottom\n */\nproto._getElementOffset = function( elem ) {\n  var boundingRect = elem.getBoundingClientRect();\n  var thisRect = this._boundingRect;\n  var size = getSize( elem );\n  var offset = {\n    left: boundingRect.left - thisRect.left - size.marginLeft,\n    top: boundingRect.top - thisRect.top - size.marginTop,\n    right: thisRect.right - boundingRect.right - size.marginRight,\n    bottom: thisRect.bottom - boundingRect.bottom - size.marginBottom\n  };\n  return offset;\n};\n\n// -------------------------- resize -------------------------- //\n\n// enable event handlers for listeners\n// i.e. resize -> onresize\nproto.handleEvent = utils.handleEvent;\n\n/**\n * Bind layout to window resizing\n */\nproto.bindResize = function() {\n  window.addEventListener( 'resize', this );\n  this.isResizeBound = true;\n};\n\n/**\n * Unbind layout to window resizing\n */\nproto.unbindResize = function() {\n  window.removeEventListener( 'resize', this );\n  this.isResizeBound = false;\n};\n\nproto.onresize = function() {\n  this.resize();\n};\n\nutils.debounceMethod( Outlayer, 'onresize', 100 );\n\nproto.resize = function() {\n  // don't trigger if size did not change\n  // or if resize was unbound. See #9\n  if ( !this.isResizeBound || !this.needsResizeLayout() ) {\n    return;\n  }\n\n  this.layout();\n};\n\n/**\n * check if layout is needed post layout\n * @returns Boolean\n */\nproto.needsResizeLayout = function() {\n  var size = getSize( this.element );\n  // check that this.size and size are there\n  // IE8 triggers resize on body size change, so they might not be\n  var hasSizes = this.size && size;\n  return hasSizes && size.innerWidth !== this.size.innerWidth;\n};\n\n// -------------------------- methods -------------------------- //\n\n/**\n * add items to Outlayer instance\n * @param {Array or NodeList or Element} elems\n * @returns {Array} items - Outlayer.Items\n**/\nproto.addItems = function( elems ) {\n  var items = this._itemize( elems );\n  // add items to collection\n  if ( items.length ) {\n    this.items = this.items.concat( items );\n  }\n  return items;\n};\n\n/**\n * Layout newly-appended item elements\n * @param {Array or NodeList or Element} elems\n */\nproto.appended = function( elems ) {\n  var items = this.addItems( elems );\n  if ( !items.length ) {\n    return;\n  }\n  // layout and reveal just the new items\n  this.layoutItems( items, true );\n  this.reveal( items );\n};\n\n/**\n * Layout prepended elements\n * @param {Array or NodeList or Element} elems\n */\nproto.prepended = function( elems ) {\n  var items = this._itemize( elems );\n  if ( !items.length ) {\n    return;\n  }\n  // add items to beginning of collection\n  var previousItems = this.items.slice(0);\n  this.items = items.concat( previousItems );\n  // start new layout\n  this._resetLayout();\n  this._manageStamps();\n  // layout new stuff without transition\n  this.layoutItems( items, true );\n  this.reveal( items );\n  // layout previous items\n  this.layoutItems( previousItems );\n};\n\n/**\n * reveal a collection of items\n * @param {Array of Outlayer.Items} items\n */\nproto.reveal = function( items ) {\n  this._emitCompleteOnItems( 'reveal', items );\n  if ( !items || !items.length ) {\n    return;\n  }\n  var stagger = this.updateStagger();\n  items.forEach( function( item, i ) {\n    item.stagger( i * stagger );\n    item.reveal();\n  });\n};\n\n/**\n * hide a collection of items\n * @param {Array of Outlayer.Items} items\n */\nproto.hide = function( items ) {\n  this._emitCompleteOnItems( 'hide', items );\n  if ( !items || !items.length ) {\n    return;\n  }\n  var stagger = this.updateStagger();\n  items.forEach( function( item, i ) {\n    item.stagger( i * stagger );\n    item.hide();\n  });\n};\n\n/**\n * reveal item elements\n * @param {Array}, {Element}, {NodeList} items\n */\nproto.revealItemElements = function( elems ) {\n  var items = this.getItems( elems );\n  this.reveal( items );\n};\n\n/**\n * hide item elements\n * @param {Array}, {Element}, {NodeList} items\n */\nproto.hideItemElements = function( elems ) {\n  var items = this.getItems( elems );\n  this.hide( items );\n};\n\n/**\n * get Outlayer.Item, given an Element\n * @param {Element} elem\n * @param {Function} callback\n * @returns {Outlayer.Item} item\n */\nproto.getItem = function( elem ) {\n  // loop through items to get the one that matches\n  for ( var i=0; i < this.items.length; i++ ) {\n    var item = this.items[i];\n    if ( item.element == elem ) {\n      // return item\n      return item;\n    }\n  }\n};\n\n/**\n * get collection of Outlayer.Items, given Elements\n * @param {Array} elems\n * @returns {Array} items - Outlayer.Items\n */\nproto.getItems = function( elems ) {\n  elems = utils.makeArray( elems );\n  var items = [];\n  elems.forEach( function( elem ) {\n    var item = this.getItem( elem );\n    if ( item ) {\n      items.push( item );\n    }\n  }, this );\n\n  return items;\n};\n\n/**\n * remove element(s) from instance and DOM\n * @param {Array or NodeList or Element} elems\n */\nproto.remove = function( elems ) {\n  var removeItems = this.getItems( elems );\n\n  this._emitCompleteOnItems( 'remove', removeItems );\n\n  // bail if no items to remove\n  if ( !removeItems || !removeItems.length ) {\n    return;\n  }\n\n  removeItems.forEach( function( item ) {\n    item.remove();\n    // remove item from collection\n    utils.removeFrom( this.items, item );\n  }, this );\n};\n\n// ----- destroy ----- //\n\n// remove and disable Outlayer instance\nproto.destroy = function() {\n  // clean up dynamic styles\n  var style = this.element.style;\n  style.height = '';\n  style.position = '';\n  style.width = '';\n  // destroy items\n  this.items.forEach( function( item ) {\n    item.destroy();\n  });\n\n  this.unbindResize();\n\n  var id = this.element.outlayerGUID;\n  delete instances[ id ]; // remove reference to instance by id\n  delete this.element.outlayerGUID;\n  // remove data for jQuery\n  if ( jQuery ) {\n    jQuery.removeData( this.element, this.constructor.namespace );\n  }\n\n};\n\n// -------------------------- data -------------------------- //\n\n/**\n * get Outlayer instance from element\n * @param {Element} elem\n * @returns {Outlayer}\n */\nOutlayer.data = function( elem ) {\n  elem = utils.getQueryElement( elem );\n  var id = elem && elem.outlayerGUID;\n  return id && instances[ id ];\n};\n\n\n// -------------------------- create Outlayer class -------------------------- //\n\n/**\n * create a layout class\n * @param {String} namespace\n */\nOutlayer.create = function( namespace, options ) {\n  // sub-class Outlayer\n  var Layout = subclass( Outlayer );\n  // apply new options and compatOptions\n  Layout.defaults = utils.extend( {}, Outlayer.defaults );\n  utils.extend( Layout.defaults, options );\n  Layout.compatOptions = utils.extend( {}, Outlayer.compatOptions  );\n\n  Layout.namespace = namespace;\n\n  Layout.data = Outlayer.data;\n\n  // sub-class Item\n  Layout.Item = subclass( Item );\n\n  // -------------------------- declarative -------------------------- //\n\n  utils.htmlInit( Layout, namespace );\n\n  // -------------------------- jQuery bridge -------------------------- //\n\n  // make into jQuery plugin\n  if ( jQuery && jQuery.bridget ) {\n    jQuery.bridget( namespace, Layout );\n  }\n\n  return Layout;\n};\n\nfunction subclass( Parent ) {\n  function SubClass() {\n    Parent.apply( this, arguments );\n  }\n\n  SubClass.prototype = Object.create( Parent.prototype );\n  SubClass.prototype.constructor = SubClass;\n\n  return SubClass;\n}\n\n// ----- helpers ----- //\n\n// how many milliseconds are in each unit\nvar msUnits = {\n  ms: 1,\n  s: 1000\n};\n\n// munge time-like parameter into millisecond number\n// '0.4s' -> 40\nfunction getMilliseconds( time ) {\n  if ( typeof time == 'number' ) {\n    return time;\n  }\n  var matches = time.match( /(^\\d*\\.?\\d*)(\\w*)/ );\n  var num = matches && matches[1];\n  var unit = matches && matches[2];\n  if ( !num.length ) {\n    return 0;\n  }\n  num = parseFloat( num );\n  var mult = msUnits[ unit ] || 1;\n  return num * mult;\n}\n\n// ----- fin ----- //\n\n// back in global\nOutlayer.Item = Item;\n\nreturn Outlayer;\n\n}));\n","/**\n * Outlayer Item\n */\n\n( function( window, factory ) {\n  // universal module definition\n  /* jshint strict: false */ /* globals define, module, require */\n  if ( typeof define == 'function' && define.amd ) {\n    // AMD - RequireJS\n    define( [\n        'ev-emitter/ev-emitter',\n        'get-size/get-size'\n      ],\n      factory\n    );\n  } else if ( typeof module == 'object' && module.exports ) {\n    // CommonJS - Browserify, Webpack\n    module.exports = factory(\n      require('ev-emitter'),\n      require('get-size')\n    );\n  } else {\n    // browser global\n    window.Outlayer = {};\n    window.Outlayer.Item = factory(\n      window.EvEmitter,\n      window.getSize\n    );\n  }\n\n}( window, function factory( EvEmitter, getSize ) {\n'use strict';\n\n// ----- helpers ----- //\n\nfunction isEmptyObj( obj ) {\n  for ( var prop in obj ) {\n    return false;\n  }\n  prop = null;\n  return true;\n}\n\n// -------------------------- CSS3 support -------------------------- //\n\n\nvar docElemStyle = document.documentElement.style;\n\nvar transitionProperty = typeof docElemStyle.transition == 'string' ?\n  'transition' : 'WebkitTransition';\nvar transformProperty = typeof docElemStyle.transform == 'string' ?\n  'transform' : 'WebkitTransform';\n\nvar transitionEndEvent = {\n  WebkitTransition: 'webkitTransitionEnd',\n  transition: 'transitionend'\n}[ transitionProperty ];\n\n// cache all vendor properties that could have vendor prefix\nvar vendorProperties = {\n  transform: transformProperty,\n  transition: transitionProperty,\n  transitionDuration: transitionProperty + 'Duration',\n  transitionProperty: transitionProperty + 'Property',\n  transitionDelay: transitionProperty + 'Delay'\n};\n\n// -------------------------- Item -------------------------- //\n\nfunction Item( element, layout ) {\n  if ( !element ) {\n    return;\n  }\n\n  this.element = element;\n  // parent layout class, i.e. Masonry, Isotope, or Packery\n  this.layout = layout;\n  this.position = {\n    x: 0,\n    y: 0\n  };\n\n  this._create();\n}\n\n// inherit EvEmitter\nvar proto = Item.prototype = Object.create( EvEmitter.prototype );\nproto.constructor = Item;\n\nproto._create = function() {\n  // transition objects\n  this._transn = {\n    ingProperties: {},\n    clean: {},\n    onEnd: {}\n  };\n\n  this.css({\n    position: 'absolute'\n  });\n};\n\n// trigger specified handler for event type\nproto.handleEvent = function( event ) {\n  var method = 'on' + event.type;\n  if ( this[ method ] ) {\n    this[ method ]( event );\n  }\n};\n\nproto.getSize = function() {\n  this.size = getSize( this.element );\n};\n\n/**\n * apply CSS styles to element\n * @param {Object} style\n */\nproto.css = function( style ) {\n  var elemStyle = this.element.style;\n\n  for ( var prop in style ) {\n    // use vendor property if available\n    var supportedProp = vendorProperties[ prop ] || prop;\n    elemStyle[ supportedProp ] = style[ prop ];\n  }\n};\n\n // measure position, and sets it\nproto.getPosition = function() {\n  var style = getComputedStyle( this.element );\n  var isOriginLeft = this.layout._getOption('originLeft');\n  var isOriginTop = this.layout._getOption('originTop');\n  var xValue = style[ isOriginLeft ? 'left' : 'right' ];\n  var yValue = style[ isOriginTop ? 'top' : 'bottom' ];\n  var x = parseFloat( xValue );\n  var y = parseFloat( yValue );\n  // convert percent to pixels\n  var layoutSize = this.layout.size;\n  if ( xValue.indexOf('%') != -1 ) {\n    x = ( x / 100 ) * layoutSize.width;\n  }\n  if ( yValue.indexOf('%') != -1 ) {\n    y = ( y / 100 ) * layoutSize.height;\n  }\n  // clean up 'auto' or other non-integer values\n  x = isNaN( x ) ? 0 : x;\n  y = isNaN( y ) ? 0 : y;\n  // remove padding from measurement\n  x -= isOriginLeft ? layoutSize.paddingLeft : layoutSize.paddingRight;\n  y -= isOriginTop ? layoutSize.paddingTop : layoutSize.paddingBottom;\n\n  this.position.x = x;\n  this.position.y = y;\n};\n\n// set settled position, apply padding\nproto.layoutPosition = function() {\n  var layoutSize = this.layout.size;\n  var style = {};\n  var isOriginLeft = this.layout._getOption('originLeft');\n  var isOriginTop = this.layout._getOption('originTop');\n\n  // x\n  var xPadding = isOriginLeft ? 'paddingLeft' : 'paddingRight';\n  var xProperty = isOriginLeft ? 'left' : 'right';\n  var xResetProperty = isOriginLeft ? 'right' : 'left';\n\n  var x = this.position.x + layoutSize[ xPadding ];\n  // set in percentage or pixels\n  style[ xProperty ] = this.getXValue( x );\n  // reset other property\n  style[ xResetProperty ] = '';\n\n  // y\n  var yPadding = isOriginTop ? 'paddingTop' : 'paddingBottom';\n  var yProperty = isOriginTop ? 'top' : 'bottom';\n  var yResetProperty = isOriginTop ? 'bottom' : 'top';\n\n  var y = this.position.y + layoutSize[ yPadding ];\n  // set in percentage or pixels\n  style[ yProperty ] = this.getYValue( y );\n  // reset other property\n  style[ yResetProperty ] = '';\n\n  this.css( style );\n  this.emitEvent( 'layout', [ this ] );\n};\n\nproto.getXValue = function( x ) {\n  var isHorizontal = this.layout._getOption('horizontal');\n  return this.layout.options.percentPosition && !isHorizontal ?\n    ( ( x / this.layout.size.width ) * 100 ) + '%' : x + 'px';\n};\n\nproto.getYValue = function( y ) {\n  var isHorizontal = this.layout._getOption('horizontal');\n  return this.layout.options.percentPosition && isHorizontal ?\n    ( ( y / this.layout.size.height ) * 100 ) + '%' : y + 'px';\n};\n\nproto._transitionTo = function( x, y ) {\n  this.getPosition();\n  // get current x & y from top/left\n  var curX = this.position.x;\n  var curY = this.position.y;\n\n  var didNotMove = x == this.position.x && y == this.position.y;\n\n  // save end position\n  this.setPosition( x, y );\n\n  // if did not move and not transitioning, just go to layout\n  if ( didNotMove && !this.isTransitioning ) {\n    this.layoutPosition();\n    return;\n  }\n\n  var transX = x - curX;\n  var transY = y - curY;\n  var transitionStyle = {};\n  transitionStyle.transform = this.getTranslate( transX, transY );\n\n  this.transition({\n    to: transitionStyle,\n    onTransitionEnd: {\n      transform: this.layoutPosition\n    },\n    isCleaning: true\n  });\n};\n\nproto.getTranslate = function( x, y ) {\n  // flip cooridinates if origin on right or bottom\n  var isOriginLeft = this.layout._getOption('originLeft');\n  var isOriginTop = this.layout._getOption('originTop');\n  x = isOriginLeft ? x : -x;\n  y = isOriginTop ? y : -y;\n  return 'translate3d(' + x + 'px, ' + y + 'px, 0)';\n};\n\n// non transition + transform support\nproto.goTo = function( x, y ) {\n  this.setPosition( x, y );\n  this.layoutPosition();\n};\n\nproto.moveTo = proto._transitionTo;\n\nproto.setPosition = function( x, y ) {\n  this.position.x = parseFloat( x );\n  this.position.y = parseFloat( y );\n};\n\n// ----- transition ----- //\n\n/**\n * @param {Object} style - CSS\n * @param {Function} onTransitionEnd\n */\n\n// non transition, just trigger callback\nproto._nonTransition = function( args ) {\n  this.css( args.to );\n  if ( args.isCleaning ) {\n    this._removeStyles( args.to );\n  }\n  for ( var prop in args.onTransitionEnd ) {\n    args.onTransitionEnd[ prop ].call( this );\n  }\n};\n\n/**\n * proper transition\n * @param {Object} args - arguments\n *   @param {Object} to - style to transition to\n *   @param {Object} from - style to start transition from\n *   @param {Boolean} isCleaning - removes transition styles after transition\n *   @param {Function} onTransitionEnd - callback\n */\nproto.transition = function( args ) {\n  // redirect to nonTransition if no transition duration\n  if ( !parseFloat( this.layout.options.transitionDuration ) ) {\n    this._nonTransition( args );\n    return;\n  }\n\n  var _transition = this._transn;\n  // keep track of onTransitionEnd callback by css property\n  for ( var prop in args.onTransitionEnd ) {\n    _transition.onEnd[ prop ] = args.onTransitionEnd[ prop ];\n  }\n  // keep track of properties that are transitioning\n  for ( prop in args.to ) {\n    _transition.ingProperties[ prop ] = true;\n    // keep track of properties to clean up when transition is done\n    if ( args.isCleaning ) {\n      _transition.clean[ prop ] = true;\n    }\n  }\n\n  // set from styles\n  if ( args.from ) {\n    this.css( args.from );\n    // force redraw. http://blog.alexmaccaw.com/css-transitions\n    var h = this.element.offsetHeight;\n    // hack for JSHint to hush about unused var\n    h = null;\n  }\n  // enable transition\n  this.enableTransition( args.to );\n  // set styles that are transitioning\n  this.css( args.to );\n\n  this.isTransitioning = true;\n\n};\n\n// dash before all cap letters, including first for\n// WebkitTransform => -webkit-transform\nfunction toDashedAll( str ) {\n  return str.replace( /([A-Z])/g, function( $1 ) {\n    return '-' + $1.toLowerCase();\n  });\n}\n\nvar transitionProps = 'opacity,' + toDashedAll( transformProperty );\n\nproto.enableTransition = function(/* style */) {\n  // HACK changing transitionProperty during a transition\n  // will cause transition to jump\n  if ( this.isTransitioning ) {\n    return;\n  }\n\n  // make `transition: foo, bar, baz` from style object\n  // HACK un-comment this when enableTransition can work\n  // while a transition is happening\n  // var transitionValues = [];\n  // for ( var prop in style ) {\n  //   // dash-ify camelCased properties like WebkitTransition\n  //   prop = vendorProperties[ prop ] || prop;\n  //   transitionValues.push( toDashedAll( prop ) );\n  // }\n  // munge number to millisecond, to match stagger\n  var duration = this.layout.options.transitionDuration;\n  duration = typeof duration == 'number' ? duration + 'ms' : duration;\n  // enable transition styles\n  this.css({\n    transitionProperty: transitionProps,\n    transitionDuration: duration,\n    transitionDelay: this.staggerDelay || 0\n  });\n  // listen for transition end event\n  this.element.addEventListener( transitionEndEvent, this, false );\n};\n\n// ----- events ----- //\n\nproto.onwebkitTransitionEnd = function( event ) {\n  this.ontransitionend( event );\n};\n\nproto.onotransitionend = function( event ) {\n  this.ontransitionend( event );\n};\n\n// properties that I munge to make my life easier\nvar dashedVendorProperties = {\n  '-webkit-transform': 'transform'\n};\n\nproto.ontransitionend = function( event ) {\n  // disregard bubbled events from children\n  if ( event.target !== this.element ) {\n    return;\n  }\n  var _transition = this._transn;\n  // get property name of transitioned property, convert to prefix-free\n  var propertyName = dashedVendorProperties[ event.propertyName ] || event.propertyName;\n\n  // remove property that has completed transitioning\n  delete _transition.ingProperties[ propertyName ];\n  // check if any properties are still transitioning\n  if ( isEmptyObj( _transition.ingProperties ) ) {\n    // all properties have completed transitioning\n    this.disableTransition();\n  }\n  // clean style\n  if ( propertyName in _transition.clean ) {\n    // clean up style\n    this.element.style[ event.propertyName ] = '';\n    delete _transition.clean[ propertyName ];\n  }\n  // trigger onTransitionEnd callback\n  if ( propertyName in _transition.onEnd ) {\n    var onTransitionEnd = _transition.onEnd[ propertyName ];\n    onTransitionEnd.call( this );\n    delete _transition.onEnd[ propertyName ];\n  }\n\n  this.emitEvent( 'transitionEnd', [ this ] );\n};\n\nproto.disableTransition = function() {\n  this.removeTransitionStyles();\n  this.element.removeEventListener( transitionEndEvent, this, false );\n  this.isTransitioning = false;\n};\n\n/**\n * removes style property from element\n * @param {Object} style\n**/\nproto._removeStyles = function( style ) {\n  // clean up transition styles\n  var cleanStyle = {};\n  for ( var prop in style ) {\n    cleanStyle[ prop ] = '';\n  }\n  this.css( cleanStyle );\n};\n\nvar cleanTransitionStyle = {\n  transitionProperty: '',\n  transitionDuration: '',\n  transitionDelay: ''\n};\n\nproto.removeTransitionStyles = function() {\n  // remove transition\n  this.css( cleanTransitionStyle );\n};\n\n// ----- stagger ----- //\n\nproto.stagger = function( delay ) {\n  delay = isNaN( delay ) ? 0 : delay;\n  this.staggerDelay = delay + 'ms';\n};\n\n// ----- show/hide/remove ----- //\n\n// remove element from DOM\nproto.removeElem = function() {\n  this.element.parentNode.removeChild( this.element );\n  // remove display: none\n  this.css({ display: '' });\n  this.emitEvent( 'remove', [ this ] );\n};\n\nproto.remove = function() {\n  // just remove element if no transition support or no transition\n  if ( !transitionProperty || !parseFloat( this.layout.options.transitionDuration ) ) {\n    this.removeElem();\n    return;\n  }\n\n  // start transition\n  this.once( 'transitionEnd', function() {\n    this.removeElem();\n  });\n  this.hide();\n};\n\nproto.reveal = function() {\n  delete this.isHidden;\n  // remove display: none\n  this.css({ display: '' });\n\n  var options = this.layout.options;\n\n  var onTransitionEnd = {};\n  var transitionEndProperty = this.getHideRevealTransitionEndProperty('visibleStyle');\n  onTransitionEnd[ transitionEndProperty ] = this.onRevealTransitionEnd;\n\n  this.transition({\n    from: options.hiddenStyle,\n    to: options.visibleStyle,\n    isCleaning: true,\n    onTransitionEnd: onTransitionEnd\n  });\n};\n\nproto.onRevealTransitionEnd = function() {\n  // check if still visible\n  // during transition, item may have been hidden\n  if ( !this.isHidden ) {\n    this.emitEvent('reveal');\n  }\n};\n\n/**\n * get style property use for hide/reveal transition end\n * @param {String} styleProperty - hiddenStyle/visibleStyle\n * @returns {String}\n */\nproto.getHideRevealTransitionEndProperty = function( styleProperty ) {\n  var optionStyle = this.layout.options[ styleProperty ];\n  // use opacity\n  if ( optionStyle.opacity ) {\n    return 'opacity';\n  }\n  // get first property\n  for ( var prop in optionStyle ) {\n    return prop;\n  }\n};\n\nproto.hide = function() {\n  // set flag\n  this.isHidden = true;\n  // remove display: none\n  this.css({ display: '' });\n\n  var options = this.layout.options;\n\n  var onTransitionEnd = {};\n  var transitionEndProperty = this.getHideRevealTransitionEndProperty('hiddenStyle');\n  onTransitionEnd[ transitionEndProperty ] = this.onHideTransitionEnd;\n\n  this.transition({\n    from: options.visibleStyle,\n    to: options.hiddenStyle,\n    // keep hidden stuff hidden\n    isCleaning: true,\n    onTransitionEnd: onTransitionEnd\n  });\n};\n\nproto.onHideTransitionEnd = function() {\n  // check if still hidden\n  // during transition, item may have been un-hidden\n  if ( this.isHidden ) {\n    this.css({ display: 'none' });\n    this.emitEvent('hide');\n  }\n};\n\nproto.destroy = function() {\n  this.css({\n    position: '',\n    left: '',\n    right: '',\n    top: '',\n    bottom: '',\n    transition: '',\n    transform: ''\n  });\n};\n\nreturn Item;\n\n}));\n","import { Controller } from 'stimulus'\nimport Masonry from 'masonry-layout'\nimport imagesLoaded from 'imagesloaded'\n\nexport default class extends Controller {\n  connect() {\n    this.msnry = new Masonry(this.element, {\n      itemSelector: '[data-grid-item]',\n      columnWidth: '[data-grid-sizer]',\n      percentPosition: true,\n    })\n\n    imagesLoaded(this.element, () => {\n      this.msnry.layout()\n    })\n  }\n\n  disconnect() {\n    this.msnry.destroy()\n  }\n}\n","/*!\n * getSize v2.0.3\n * measure size of elements\n * MIT license\n */\n\n/* jshint browser: true, strict: true, undef: true, unused: true */\n/* globals console: false */\n\n( function( window, factory ) {\n  /* jshint strict: false */ /* globals define, module */\n  if ( typeof define == 'function' && define.amd ) {\n    // AMD\n    define( factory );\n  } else if ( typeof module == 'object' && module.exports ) {\n    // CommonJS\n    module.exports = factory();\n  } else {\n    // browser global\n    window.getSize = factory();\n  }\n\n})( window, function factory() {\n'use strict';\n\n// -------------------------- helpers -------------------------- //\n\n// get a number from a string, not a percentage\nfunction getStyleSize( value ) {\n  var num = parseFloat( value );\n  // not a percent like '100%', and a number\n  var isValid = value.indexOf('%') == -1 && !isNaN( num );\n  return isValid && num;\n}\n\nfunction noop() {}\n\nvar logError = typeof console == 'undefined' ? noop :\n  function( message ) {\n    console.error( message );\n  };\n\n// -------------------------- measurements -------------------------- //\n\nvar measurements = [\n  'paddingLeft',\n  'paddingRight',\n  'paddingTop',\n  'paddingBottom',\n  'marginLeft',\n  'marginRight',\n  'marginTop',\n  'marginBottom',\n  'borderLeftWidth',\n  'borderRightWidth',\n  'borderTopWidth',\n  'borderBottomWidth'\n];\n\nvar measurementsLength = measurements.length;\n\nfunction getZeroSize() {\n  var size = {\n    width: 0,\n    height: 0,\n    innerWidth: 0,\n    innerHeight: 0,\n    outerWidth: 0,\n    outerHeight: 0\n  };\n  for ( var i=0; i < measurementsLength; i++ ) {\n    var measurement = measurements[i];\n    size[ measurement ] = 0;\n  }\n  return size;\n}\n\n// -------------------------- getStyle -------------------------- //\n\n/**\n * getStyle, get style of element, check for Firefox bug\n * https://bugzilla.mozilla.org/show_bug.cgi?id=548397\n */\nfunction getStyle( elem ) {\n  var style = getComputedStyle( elem );\n  if ( !style ) {\n    logError( 'Style returned ' + style +\n      '. Are you running this code in a hidden iframe on Firefox? ' +\n      'See https://bit.ly/getsizebug1' );\n  }\n  return style;\n}\n\n// -------------------------- setup -------------------------- //\n\nvar isSetup = false;\n\nvar isBoxSizeOuter;\n\n/**\n * setup\n * check isBoxSizerOuter\n * do on first getSize() rather than on page load for Firefox bug\n */\nfunction setup() {\n  // setup once\n  if ( isSetup ) {\n    return;\n  }\n  isSetup = true;\n\n  // -------------------------- box sizing -------------------------- //\n\n  /**\n   * Chrome & Safari measure the outer-width on style.width on border-box elems\n   * IE11 & Firefox<29 measures the inner-width\n   */\n  var div = document.createElement('div');\n  div.style.width = '200px';\n  div.style.padding = '1px 2px 3px 4px';\n  div.style.borderStyle = 'solid';\n  div.style.borderWidth = '1px 2px 3px 4px';\n  div.style.boxSizing = 'border-box';\n\n  var body = document.body || document.documentElement;\n  body.appendChild( div );\n  var style = getStyle( div );\n  // round value for browser zoom. desandro/masonry#928\n  isBoxSizeOuter = Math.round( getStyleSize( style.width ) ) == 200;\n  getSize.isBoxSizeOuter = isBoxSizeOuter;\n\n  body.removeChild( div );\n}\n\n// -------------------------- getSize -------------------------- //\n\nfunction getSize( elem ) {\n  setup();\n\n  // use querySeletor if elem is string\n  if ( typeof elem == 'string' ) {\n    elem = document.querySelector( elem );\n  }\n\n  // do not proceed on non-objects\n  if ( !elem || typeof elem != 'object' || !elem.nodeType ) {\n    return;\n  }\n\n  var style = getStyle( elem );\n\n  // if hidden, everything is 0\n  if ( style.display == 'none' ) {\n    return getZeroSize();\n  }\n\n  var size = {};\n  size.width = elem.offsetWidth;\n  size.height = elem.offsetHeight;\n\n  var isBorderBox = size.isBorderBox = style.boxSizing == 'border-box';\n\n  // get all measurements\n  for ( var i=0; i < measurementsLength; i++ ) {\n    var measurement = measurements[i];\n    var value = style[ measurement ];\n    var num = parseFloat( value );\n    // any 'auto', 'medium' value will be 0\n    size[ measurement ] = !isNaN( num ) ? num : 0;\n  }\n\n  var paddingWidth = size.paddingLeft + size.paddingRight;\n  var paddingHeight = size.paddingTop + size.paddingBottom;\n  var marginWidth = size.marginLeft + size.marginRight;\n  var marginHeight = size.marginTop + size.marginBottom;\n  var borderWidth = size.borderLeftWidth + size.borderRightWidth;\n  var borderHeight = size.borderTopWidth + size.borderBottomWidth;\n\n  var isBorderBoxSizeOuter = isBorderBox && isBoxSizeOuter;\n\n  // overwrite width and height if we can get it from style\n  var styleWidth = getStyleSize( style.width );\n  if ( styleWidth !== false ) {\n    size.width = styleWidth +\n      // add padding and border unless it's already including it\n      ( isBorderBoxSizeOuter ? 0 : paddingWidth + borderWidth );\n  }\n\n  var styleHeight = getStyleSize( style.height );\n  if ( styleHeight !== false ) {\n    size.height = styleHeight +\n      // add padding and border unless it's already including it\n      ( isBorderBoxSizeOuter ? 0 : paddingHeight + borderHeight );\n  }\n\n  size.innerWidth = size.width - ( paddingWidth + borderWidth );\n  size.innerHeight = size.height - ( paddingHeight + borderHeight );\n\n  size.outerWidth = size.width + marginWidth;\n  size.outerHeight = size.height + marginHeight;\n\n  return size;\n}\n\nreturn getSize;\n\n});\n","/*! outline.js v1.2.0 - https://github.com/lindsayevans/outline.js/ */\n(function(d){\n\n\tvar style_element = d.createElement('STYLE'),\n\t    dom_events = 'addEventListener' in d,\n\t    add_event_listener = function(type, callback){\n\t\t\t// Basic cross-browser event handling\n\t\t\tif(dom_events){\n\t\t\t\td.addEventListener(type, callback);\n\t\t\t}else{\n\t\t\t\td.attachEvent('on' + type, callback);\n\t\t\t}\n\t\t},\n\t    set_css = function(css_text){\n\t\t\t// Handle setting of <style> element contents in IE8\n\t\t\t!!style_element.styleSheet ? style_element.styleSheet.cssText = css_text : style_element.innerHTML = css_text;\n\t\t}\n\t;\n\n\td.getElementsByTagName('HEAD')[0].appendChild(style_element);\n\n\t// Using mousedown instead of mouseover, so that previously focused elements don't lose focus ring on mouse move\n\tadd_event_listener('mousedown', function(){\n\t\tset_css(':focus{outline:0}::-moz-focus-inner{border:0;}');\n\t});\n\n\tadd_event_listener('keydown', function(){\n\t\tset_css('');\n\t});\n\n})(document);\n","var EventListener = /** @class */ (function () {\n    function EventListener(eventTarget, eventName) {\n        this.eventTarget = eventTarget;\n        this.eventName = eventName;\n        this.unorderedBindings = new Set;\n    }\n    EventListener.prototype.connect = function () {\n        this.eventTarget.addEventListener(this.eventName, this, false);\n    };\n    EventListener.prototype.disconnect = function () {\n        this.eventTarget.removeEventListener(this.eventName, this, false);\n    };\n    // Binding observer delegate\n    /** @hidden */\n    EventListener.prototype.bindingConnected = function (binding) {\n        this.unorderedBindings.add(binding);\n    };\n    /** @hidden */\n    EventListener.prototype.bindingDisconnected = function (binding) {\n        this.unorderedBindings.delete(binding);\n    };\n    EventListener.prototype.handleEvent = function (event) {\n        var extendedEvent = extendEvent(event);\n        for (var _i = 0, _a = this.bindings; _i < _a.length; _i++) {\n            var binding = _a[_i];\n            if (extendedEvent.immediatePropagationStopped) {\n                break;\n            }\n            else {\n                binding.handleEvent(extendedEvent);\n            }\n        }\n    };\n    Object.defineProperty(EventListener.prototype, \"bindings\", {\n        get: function () {\n            return Array.from(this.unorderedBindings).sort(function (left, right) {\n                var leftIndex = left.index, rightIndex = right.index;\n                return leftIndex < rightIndex ? -1 : leftIndex > rightIndex ? 1 : 0;\n            });\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return EventListener;\n}());\nexport { EventListener };\nfunction extendEvent(event) {\n    if (\"immediatePropagationStopped\" in event) {\n        return event;\n    }\n    else {\n        var stopImmediatePropagation_1 = event.stopImmediatePropagation;\n        return Object.assign(event, {\n            immediatePropagationStopped: false,\n            stopImmediatePropagation: function () {\n                this.immediatePropagationStopped = true;\n                stopImmediatePropagation_1.call(this);\n            }\n        });\n    }\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZXZlbnRfbGlzdGVuZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvZXZlbnRfbGlzdGVuZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBRUE7SUFLRSx1QkFBWSxXQUF3QixFQUFFLFNBQWlCO1FBQ3JELElBQUksQ0FBQyxXQUFXLEdBQUcsV0FBVyxDQUFBO1FBQzlCLElBQUksQ0FBQyxTQUFTLEdBQUcsU0FBUyxDQUFBO1FBQzFCLElBQUksQ0FBQyxpQkFBaUIsR0FBRyxJQUFJLEdBQUcsQ0FBQTtJQUNsQyxDQUFDO0lBRUQsK0JBQU8sR0FBUDtRQUNFLElBQUksQ0FBQyxXQUFXLENBQUMsZ0JBQWdCLENBQUMsSUFBSSxDQUFDLFNBQVMsRUFBRSxJQUFJLEVBQUUsS0FBSyxDQUFDLENBQUE7SUFDaEUsQ0FBQztJQUVELGtDQUFVLEdBQVY7UUFDRSxJQUFJLENBQUMsV0FBVyxDQUFDLG1CQUFtQixDQUFDLElBQUksQ0FBQyxTQUFTLEVBQUUsSUFBSSxFQUFFLEtBQUssQ0FBQyxDQUFBO0lBQ25FLENBQUM7SUFFRCw0QkFBNEI7SUFFNUIsY0FBYztJQUNkLHdDQUFnQixHQUFoQixVQUFpQixPQUFnQjtRQUMvQixJQUFJLENBQUMsaUJBQWlCLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxDQUFBO0lBQ3JDLENBQUM7SUFFRCxjQUFjO0lBQ2QsMkNBQW1CLEdBQW5CLFVBQW9CLE9BQWdCO1FBQ2xDLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUE7SUFDeEMsQ0FBQztJQUVELG1DQUFXLEdBQVgsVUFBWSxLQUFZO1FBQ3RCLElBQU0sYUFBYSxHQUFHLFdBQVcsQ0FBQyxLQUFLLENBQUMsQ0FBQTtRQUN4QyxLQUFzQixVQUFhLEVBQWIsS0FBQSxJQUFJLENBQUMsUUFBUSxFQUFiLGNBQWEsRUFBYixJQUFhLEVBQUU7WUFBaEMsSUFBTSxPQUFPLFNBQUE7WUFDaEIsSUFBSSxhQUFhLENBQUMsMkJBQTJCLEVBQUU7Z0JBQzdDLE1BQUs7YUFDTjtpQkFBTTtnQkFDTCxPQUFPLENBQUMsV0FBVyxDQUFDLGFBQWEsQ0FBQyxDQUFBO2FBQ25DO1NBQ0Y7SUFDSCxDQUFDO0lBRUQsc0JBQUksbUNBQVE7YUFBWjtZQUNFLE9BQU8sS0FBSyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsaUJBQWlCLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBQyxJQUFJLEVBQUUsS0FBSztnQkFDekQsSUFBTSxTQUFTLEdBQUcsSUFBSSxDQUFDLEtBQUssRUFBRSxVQUFVLEdBQUcsS0FBSyxDQUFDLEtBQUssQ0FBQTtnQkFDdEQsT0FBTyxTQUFTLEdBQUcsVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsU0FBUyxHQUFHLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUE7WUFDckUsQ0FBQyxDQUFDLENBQUE7UUFDSixDQUFDOzs7T0FBQTtJQUNILG9CQUFDO0FBQUQsQ0FBQyxBQWhERCxJQWdEQzs7QUFFRCxxQkFBcUIsS0FBWTtJQUMvQixJQUFJLDZCQUE2QixJQUFJLEtBQUssRUFBRTtRQUMxQyxPQUFPLEtBQUssQ0FBQTtLQUNiO1NBQU07UUFDRyxJQUFBLDJEQUF3QixDQUFVO1FBQzFDLE9BQU8sTUFBTSxDQUFDLE1BQU0sQ0FBQyxLQUFLLEVBQUU7WUFDMUIsMkJBQTJCLEVBQUUsS0FBSztZQUNsQyx3QkFBd0I7Z0JBQ3RCLElBQUksQ0FBQywyQkFBMkIsR0FBRyxJQUFJLENBQUE7Z0JBQ3ZDLDBCQUF3QixDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQTtZQUNyQyxDQUFDO1NBQ0YsQ0FBQyxDQUFBO0tBQ0g7QUFDSCxDQUFDIn0=","import { EventListener } from \"./event_listener\";\nvar Dispatcher = /** @class */ (function () {\n    function Dispatcher(application) {\n        this.application = application;\n        this.eventListenerMaps = new Map;\n        this.started = false;\n    }\n    Dispatcher.prototype.start = function () {\n        if (!this.started) {\n            this.started = true;\n            this.eventListeners.forEach(function (eventListener) { return eventListener.connect(); });\n        }\n    };\n    Dispatcher.prototype.stop = function () {\n        if (this.started) {\n            this.started = false;\n            this.eventListeners.forEach(function (eventListener) { return eventListener.disconnect(); });\n        }\n    };\n    Object.defineProperty(Dispatcher.prototype, \"eventListeners\", {\n        get: function () {\n            return Array.from(this.eventListenerMaps.values())\n                .reduce(function (listeners, map) { return listeners.concat(Array.from(map.values())); }, []);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    // Binding observer delegate\n    /** @hidden */\n    Dispatcher.prototype.bindingConnected = function (binding) {\n        this.fetchEventListenerForBinding(binding).bindingConnected(binding);\n    };\n    /** @hidden */\n    Dispatcher.prototype.bindingDisconnected = function (binding) {\n        this.fetchEventListenerForBinding(binding).bindingDisconnected(binding);\n    };\n    // Error handling\n    Dispatcher.prototype.handleError = function (error, message, detail) {\n        if (detail === void 0) { detail = {}; }\n        this.application.handleError(error, \"Error \" + message, detail);\n    };\n    Dispatcher.prototype.fetchEventListenerForBinding = function (binding) {\n        var eventTarget = binding.eventTarget, eventName = binding.eventName;\n        return this.fetchEventListener(eventTarget, eventName);\n    };\n    Dispatcher.prototype.fetchEventListener = function (eventTarget, eventName) {\n        var eventListenerMap = this.fetchEventListenerMapForEventTarget(eventTarget);\n        var eventListener = eventListenerMap.get(eventName);\n        if (!eventListener) {\n            eventListener = this.createEventListener(eventTarget, eventName);\n            eventListenerMap.set(eventName, eventListener);\n        }\n        return eventListener;\n    };\n    Dispatcher.prototype.createEventListener = function (eventTarget, eventName) {\n        var eventListener = new EventListener(eventTarget, eventName);\n        if (this.started) {\n            eventListener.connect();\n        }\n        return eventListener;\n    };\n    Dispatcher.prototype.fetchEventListenerMapForEventTarget = function (eventTarget) {\n        var eventListenerMap = this.eventListenerMaps.get(eventTarget);\n        if (!eventListenerMap) {\n            eventListenerMap = new Map;\n            this.eventListenerMaps.set(eventTarget, eventListenerMap);\n        }\n        return eventListenerMap;\n    };\n    return Dispatcher;\n}());\nexport { Dispatcher };\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGlzcGF0Y2hlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9kaXNwYXRjaGVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUdBLE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSxrQkFBa0IsQ0FBQTtBQUVoRDtJQUtFLG9CQUFZLFdBQXdCO1FBQ2xDLElBQUksQ0FBQyxXQUFXLEdBQUcsV0FBVyxDQUFBO1FBQzlCLElBQUksQ0FBQyxpQkFBaUIsR0FBRyxJQUFJLEdBQUcsQ0FBQTtRQUNoQyxJQUFJLENBQUMsT0FBTyxHQUFHLEtBQUssQ0FBQTtJQUN0QixDQUFDO0lBRUQsMEJBQUssR0FBTDtRQUNFLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFO1lBQ2pCLElBQUksQ0FBQyxPQUFPLEdBQUcsSUFBSSxDQUFBO1lBQ25CLElBQUksQ0FBQyxjQUFjLENBQUMsT0FBTyxDQUFDLFVBQUEsYUFBYSxJQUFJLE9BQUEsYUFBYSxDQUFDLE9BQU8sRUFBRSxFQUF2QixDQUF1QixDQUFDLENBQUE7U0FDdEU7SUFDSCxDQUFDO0lBRUQseUJBQUksR0FBSjtRQUNFLElBQUksSUFBSSxDQUFDLE9BQU8sRUFBRTtZQUNoQixJQUFJLENBQUMsT0FBTyxHQUFHLEtBQUssQ0FBQTtZQUNwQixJQUFJLENBQUMsY0FBYyxDQUFDLE9BQU8sQ0FBQyxVQUFBLGFBQWEsSUFBSSxPQUFBLGFBQWEsQ0FBQyxVQUFVLEVBQUUsRUFBMUIsQ0FBMEIsQ0FBQyxDQUFBO1NBQ3pFO0lBQ0gsQ0FBQztJQUVELHNCQUFJLHNDQUFjO2FBQWxCO1lBQ0UsT0FBTyxLQUFLLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxNQUFNLEVBQUUsQ0FBQztpQkFDL0MsTUFBTSxDQUFDLFVBQUMsU0FBUyxFQUFFLEdBQUcsSUFBSyxPQUFBLFNBQVMsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsTUFBTSxFQUFFLENBQUMsQ0FBQyxFQUExQyxDQUEwQyxFQUFFLEVBQXFCLENBQUMsQ0FBQTtRQUNsRyxDQUFDOzs7T0FBQTtJQUVELDRCQUE0QjtJQUU1QixjQUFjO0lBQ2QscUNBQWdCLEdBQWhCLFVBQWlCLE9BQWdCO1FBQy9CLElBQUksQ0FBQyw0QkFBNEIsQ0FBQyxPQUFPLENBQUMsQ0FBQyxnQkFBZ0IsQ0FBQyxPQUFPLENBQUMsQ0FBQTtJQUN0RSxDQUFDO0lBRUQsY0FBYztJQUNkLHdDQUFtQixHQUFuQixVQUFvQixPQUFnQjtRQUNsQyxJQUFJLENBQUMsNEJBQTRCLENBQUMsT0FBTyxDQUFDLENBQUMsbUJBQW1CLENBQUMsT0FBTyxDQUFDLENBQUE7SUFDekUsQ0FBQztJQUVELGlCQUFpQjtJQUVqQixnQ0FBVyxHQUFYLFVBQVksS0FBWSxFQUFFLE9BQWUsRUFBRSxNQUFtQjtRQUFuQix1QkFBQSxFQUFBLFdBQW1CO1FBQzVELElBQUksQ0FBQyxXQUFXLENBQUMsV0FBVyxDQUFDLEtBQUssRUFBRSxXQUFTLE9BQVMsRUFBRSxNQUFNLENBQUMsQ0FBQTtJQUNqRSxDQUFDO0lBRU8saURBQTRCLEdBQXBDLFVBQXFDLE9BQWdCO1FBQzNDLElBQUEsaUNBQVcsRUFBRSw2QkFBUyxDQUFZO1FBQzFDLE9BQU8sSUFBSSxDQUFDLGtCQUFrQixDQUFDLFdBQVcsRUFBRSxTQUFTLENBQUMsQ0FBQTtJQUN4RCxDQUFDO0lBRU8sdUNBQWtCLEdBQTFCLFVBQTJCLFdBQXdCLEVBQUUsU0FBaUI7UUFDcEUsSUFBTSxnQkFBZ0IsR0FBRyxJQUFJLENBQUMsbUNBQW1DLENBQUMsV0FBVyxDQUFDLENBQUE7UUFDOUUsSUFBSSxhQUFhLEdBQUcsZ0JBQWdCLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxDQUFBO1FBQ25ELElBQUksQ0FBQyxhQUFhLEVBQUU7WUFDbEIsYUFBYSxHQUFHLElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxXQUFXLEVBQUUsU0FBUyxDQUFDLENBQUE7WUFDaEUsZ0JBQWdCLENBQUMsR0FBRyxDQUFDLFNBQVMsRUFBRSxhQUFhLENBQUMsQ0FBQTtTQUMvQztRQUNELE9BQU8sYUFBYSxDQUFBO0lBQ3RCLENBQUM7SUFFTyx3Q0FBbUIsR0FBM0IsVUFBNEIsV0FBd0IsRUFBRSxTQUFpQjtRQUNyRSxJQUFNLGFBQWEsR0FBRyxJQUFJLGFBQWEsQ0FBQyxXQUFXLEVBQUUsU0FBUyxDQUFDLENBQUE7UUFDL0QsSUFBSSxJQUFJLENBQUMsT0FBTyxFQUFFO1lBQ2hCLGFBQWEsQ0FBQyxPQUFPLEVBQUUsQ0FBQTtTQUN4QjtRQUNELE9BQU8sYUFBYSxDQUFBO0lBQ3RCLENBQUM7SUFFTyx3REFBbUMsR0FBM0MsVUFBNEMsV0FBd0I7UUFDbEUsSUFBSSxnQkFBZ0IsR0FBRyxJQUFJLENBQUMsaUJBQWlCLENBQUMsR0FBRyxDQUFDLFdBQVcsQ0FBQyxDQUFBO1FBQzlELElBQUksQ0FBQyxnQkFBZ0IsRUFBRTtZQUNyQixnQkFBZ0IsR0FBRyxJQUFJLEdBQUcsQ0FBQTtZQUMxQixJQUFJLENBQUMsaUJBQWlCLENBQUMsR0FBRyxDQUFDLFdBQVcsRUFBRSxnQkFBZ0IsQ0FBQyxDQUFBO1NBQzFEO1FBQ0QsT0FBTyxnQkFBZ0IsQ0FBQTtJQUN6QixDQUFDO0lBQ0gsaUJBQUM7QUFBRCxDQUFDLEFBL0VELElBK0VDIn0=","// capture nos.:            12   23 4               43   1 5   56 7  76\nvar descriptorPattern = /^((.+?)(@(window|document))?->)?(.+?)(#(.+))?$/;\nexport function parseDescriptorString(descriptorString) {\n    var source = descriptorString.trim();\n    var matches = source.match(descriptorPattern) || [];\n    return {\n        eventTarget: parseEventTarget(matches[4]),\n        eventName: matches[2],\n        identifier: matches[5],\n        methodName: matches[7]\n    };\n}\nfunction parseEventTarget(eventTargetName) {\n    if (eventTargetName == \"window\") {\n        return window;\n    }\n    else if (eventTargetName == \"document\") {\n        return document;\n    }\n}\nexport function stringifyEventTarget(eventTarget) {\n    if (eventTarget == window) {\n        return \"window\";\n    }\n    else if (eventTarget == document) {\n        return \"document\";\n    }\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYWN0aW9uX2Rlc2NyaXB0b3IuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvYWN0aW9uX2Rlc2NyaXB0b3IudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBT0EsdUVBQXVFO0FBQ3ZFLElBQU0saUJBQWlCLEdBQUcsZ0RBQWdELENBQUE7QUFFMUUsTUFBTSxnQ0FBZ0MsZ0JBQXdCO0lBQzVELElBQU0sTUFBTSxHQUFHLGdCQUFnQixDQUFDLElBQUksRUFBRSxDQUFBO0lBQ3RDLElBQU0sT0FBTyxHQUFHLE1BQU0sQ0FBQyxLQUFLLENBQUMsaUJBQWlCLENBQUMsSUFBSSxFQUFFLENBQUE7SUFDckQsT0FBTztRQUNMLFdBQVcsRUFBRSxnQkFBZ0IsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDekMsU0FBUyxFQUFJLE9BQU8sQ0FBQyxDQUFDLENBQUM7UUFDdkIsVUFBVSxFQUFHLE9BQU8sQ0FBQyxDQUFDLENBQUM7UUFDdkIsVUFBVSxFQUFHLE9BQU8sQ0FBQyxDQUFDLENBQUM7S0FDeEIsQ0FBQTtBQUNILENBQUM7QUFFRCwwQkFBMEIsZUFBdUI7SUFDL0MsSUFBSSxlQUFlLElBQUksUUFBUSxFQUFFO1FBQy9CLE9BQU8sTUFBTSxDQUFBO0tBQ2Q7U0FBTSxJQUFJLGVBQWUsSUFBSSxVQUFVLEVBQUU7UUFDeEMsT0FBTyxRQUFRLENBQUE7S0FDaEI7QUFDSCxDQUFDO0FBRUQsTUFBTSwrQkFBK0IsV0FBd0I7SUFDM0QsSUFBSSxXQUFXLElBQUksTUFBTSxFQUFFO1FBQ3pCLE9BQU8sUUFBUSxDQUFBO0tBQ2hCO1NBQU0sSUFBSSxXQUFXLElBQUksUUFBUSxFQUFFO1FBQ2xDLE9BQU8sVUFBVSxDQUFBO0tBQ2xCO0FBQ0gsQ0FBQyJ9","import { parseDescriptorString, stringifyEventTarget } from \"./action_descriptor\";\nvar Action = /** @class */ (function () {\n    function Action(element, index, descriptor) {\n        this.element = element;\n        this.index = index;\n        this.eventTarget = descriptor.eventTarget || element;\n        this.eventName = descriptor.eventName || getDefaultEventNameForElement(element) || error(\"missing event name\");\n        this.identifier = descriptor.identifier || error(\"missing identifier\");\n        this.methodName = descriptor.methodName || error(\"missing method name\");\n    }\n    Action.forToken = function (token) {\n        return new this(token.element, token.index, parseDescriptorString(token.content));\n    };\n    Action.prototype.toString = function () {\n        var eventNameSuffix = this.eventTargetName ? \"@\" + this.eventTargetName : \"\";\n        return \"\" + this.eventName + eventNameSuffix + \"->\" + this.identifier + \"#\" + this.methodName;\n    };\n    Object.defineProperty(Action.prototype, \"eventTargetName\", {\n        get: function () {\n            return stringifyEventTarget(this.eventTarget);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return Action;\n}());\nexport { Action };\nvar defaultEventNames = {\n    \"a\": function (e) { return \"click\"; },\n    \"button\": function (e) { return \"click\"; },\n    \"form\": function (e) { return \"submit\"; },\n    \"input\": function (e) { return e.getAttribute(\"type\") == \"submit\" ? \"click\" : \"change\"; },\n    \"select\": function (e) { return \"change\"; },\n    \"textarea\": function (e) { return \"change\"; }\n};\nexport function getDefaultEventNameForElement(element) {\n    var tagName = element.tagName.toLowerCase();\n    if (tagName in defaultEventNames) {\n        return defaultEventNames[tagName](element);\n    }\n}\nfunction error(message) {\n    throw new Error(message);\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYWN0aW9uLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL2FjdGlvbi50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQW9CLHFCQUFxQixFQUFFLG9CQUFvQixFQUFFLE1BQU0scUJBQXFCLENBQUE7QUFHbkc7SUFZRSxnQkFBWSxPQUFnQixFQUFFLEtBQWEsRUFBRSxVQUFxQztRQUNoRixJQUFJLENBQUMsT0FBTyxHQUFPLE9BQU8sQ0FBQTtRQUMxQixJQUFJLENBQUMsS0FBSyxHQUFTLEtBQUssQ0FBQTtRQUN4QixJQUFJLENBQUMsV0FBVyxHQUFHLFVBQVUsQ0FBQyxXQUFXLElBQUksT0FBTyxDQUFBO1FBQ3BELElBQUksQ0FBQyxTQUFTLEdBQUssVUFBVSxDQUFDLFNBQVMsSUFBSSw2QkFBNkIsQ0FBQyxPQUFPLENBQUMsSUFBSSxLQUFLLENBQUMsb0JBQW9CLENBQUMsQ0FBQTtRQUNoSCxJQUFJLENBQUMsVUFBVSxHQUFJLFVBQVUsQ0FBQyxVQUFVLElBQUksS0FBSyxDQUFDLG9CQUFvQixDQUFDLENBQUE7UUFDdkUsSUFBSSxDQUFDLFVBQVUsR0FBSSxVQUFVLENBQUMsVUFBVSxJQUFJLEtBQUssQ0FBQyxxQkFBcUIsQ0FBQyxDQUFBO0lBQzFFLENBQUM7SUFYTSxlQUFRLEdBQWYsVUFBZ0IsS0FBWTtRQUMxQixPQUFPLElBQUksSUFBSSxDQUFDLEtBQUssQ0FBQyxPQUFPLEVBQUUsS0FBSyxDQUFDLEtBQUssRUFBRSxxQkFBcUIsQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQTtJQUNuRixDQUFDO0lBV0QseUJBQVEsR0FBUjtRQUNFLElBQU0sZUFBZSxHQUFHLElBQUksQ0FBQyxlQUFlLENBQUMsQ0FBQyxDQUFDLE1BQUksSUFBSSxDQUFDLGVBQWlCLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQTtRQUM5RSxPQUFPLEtBQUcsSUFBSSxDQUFDLFNBQVMsR0FBRyxlQUFlLFVBQUssSUFBSSxDQUFDLFVBQVUsU0FBSSxJQUFJLENBQUMsVUFBWSxDQUFBO0lBQ3JGLENBQUM7SUFFRCxzQkFBWSxtQ0FBZTthQUEzQjtZQUNFLE9BQU8sb0JBQW9CLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFBO1FBQy9DLENBQUM7OztPQUFBO0lBQ0gsYUFBQztBQUFELENBQUMsQUE3QkQsSUE2QkM7O0FBRUQsSUFBTSxpQkFBaUIsR0FBd0Q7SUFDN0UsR0FBRyxFQUFTLFVBQUEsQ0FBQyxJQUFJLE9BQUEsT0FBTyxFQUFQLENBQU87SUFDeEIsUUFBUSxFQUFJLFVBQUEsQ0FBQyxJQUFJLE9BQUEsT0FBTyxFQUFQLENBQU87SUFDeEIsTUFBTSxFQUFNLFVBQUEsQ0FBQyxJQUFJLE9BQUEsUUFBUSxFQUFSLENBQVE7SUFDekIsT0FBTyxFQUFLLFVBQUEsQ0FBQyxJQUFJLE9BQUEsQ0FBQyxDQUFDLFlBQVksQ0FBQyxNQUFNLENBQUMsSUFBSSxRQUFRLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsUUFBUSxFQUF2RCxDQUF1RDtJQUN4RSxRQUFRLEVBQUksVUFBQSxDQUFDLElBQUksT0FBQSxRQUFRLEVBQVIsQ0FBUTtJQUN6QixVQUFVLEVBQUUsVUFBQSxDQUFDLElBQUksT0FBQSxRQUFRLEVBQVIsQ0FBUTtDQUMxQixDQUFBO0FBRUQsTUFBTSx3Q0FBd0MsT0FBZ0I7SUFDNUQsSUFBTSxPQUFPLEdBQUcsT0FBTyxDQUFDLE9BQU8sQ0FBQyxXQUFXLEVBQUUsQ0FBQTtJQUM3QyxJQUFJLE9BQU8sSUFBSSxpQkFBaUIsRUFBRTtRQUNoQyxPQUFPLGlCQUFpQixDQUFDLE9BQU8sQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFBO0tBQzNDO0FBQ0gsQ0FBQztBQUVELGVBQWUsT0FBZTtJQUM1QixNQUFNLElBQUksS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFBO0FBQzFCLENBQUMifQ==","var Binding = /** @class */ (function () {\n    function Binding(context, action) {\n        this.context = context;\n        this.action = action;\n    }\n    Object.defineProperty(Binding.prototype, \"index\", {\n        get: function () {\n            return this.action.index;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Binding.prototype, \"eventTarget\", {\n        get: function () {\n            return this.action.eventTarget;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Binding.prototype, \"identifier\", {\n        get: function () {\n            return this.context.identifier;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Binding.prototype.handleEvent = function (event) {\n        if (this.willBeInvokedByEvent(event)) {\n            this.invokeWithEvent(event);\n        }\n    };\n    Object.defineProperty(Binding.prototype, \"eventName\", {\n        get: function () {\n            return this.action.eventName;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Binding.prototype, \"method\", {\n        get: function () {\n            var method = this.controller[this.methodName];\n            if (typeof method == \"function\") {\n                return method;\n            }\n            throw new Error(\"Action \\\"\" + this.action + \"\\\" references undefined method \\\"\" + this.methodName + \"\\\"\");\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Binding.prototype.invokeWithEvent = function (event) {\n        try {\n            this.method.call(this.controller, event);\n        }\n        catch (error) {\n            var _a = this, identifier = _a.identifier, controller = _a.controller, element = _a.element, index = _a.index;\n            var detail = { identifier: identifier, controller: controller, element: element, index: index, event: event };\n            this.context.handleError(error, \"invoking action \\\"\" + this.action + \"\\\"\", detail);\n        }\n    };\n    Binding.prototype.willBeInvokedByEvent = function (event) {\n        var eventTarget = event.target;\n        if (this.element === eventTarget) {\n            return true;\n        }\n        else if (eventTarget instanceof Element && this.element.contains(eventTarget)) {\n            return this.scope.containsElement(eventTarget);\n        }\n        else {\n            return true;\n        }\n    };\n    Object.defineProperty(Binding.prototype, \"controller\", {\n        get: function () {\n            return this.context.controller;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Binding.prototype, \"methodName\", {\n        get: function () {\n            return this.action.methodName;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Binding.prototype, \"element\", {\n        get: function () {\n            return this.scope.element;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Binding.prototype, \"scope\", {\n        get: function () {\n            return this.context.scope;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return Binding;\n}());\nexport { Binding };\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmluZGluZy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9iaW5kaW5nLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUtBO0lBSUUsaUJBQVksT0FBZ0IsRUFBRSxNQUFjO1FBQzFDLElBQUksQ0FBQyxPQUFPLEdBQUcsT0FBTyxDQUFBO1FBQ3RCLElBQUksQ0FBQyxNQUFNLEdBQUcsTUFBTSxDQUFBO0lBQ3RCLENBQUM7SUFFRCxzQkFBSSwwQkFBSzthQUFUO1lBQ0UsT0FBTyxJQUFJLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQTtRQUMxQixDQUFDOzs7T0FBQTtJQUVELHNCQUFJLGdDQUFXO2FBQWY7WUFDRSxPQUFPLElBQUksQ0FBQyxNQUFNLENBQUMsV0FBVyxDQUFBO1FBQ2hDLENBQUM7OztPQUFBO0lBRUQsc0JBQUksK0JBQVU7YUFBZDtZQUNFLE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQyxVQUFVLENBQUE7UUFDaEMsQ0FBQzs7O09BQUE7SUFFRCw2QkFBVyxHQUFYLFVBQVksS0FBWTtRQUN0QixJQUFJLElBQUksQ0FBQyxvQkFBb0IsQ0FBQyxLQUFLLENBQUMsRUFBRTtZQUNwQyxJQUFJLENBQUMsZUFBZSxDQUFDLEtBQUssQ0FBQyxDQUFBO1NBQzVCO0lBQ0gsQ0FBQztJQUVELHNCQUFJLDhCQUFTO2FBQWI7WUFDRSxPQUFPLElBQUksQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFBO1FBQzlCLENBQUM7OztPQUFBO0lBRUQsc0JBQUksMkJBQU07YUFBVjtZQUNFLElBQU0sTUFBTSxHQUFJLElBQUksQ0FBQyxVQUFrQixDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQTtZQUN4RCxJQUFJLE9BQU8sTUFBTSxJQUFJLFVBQVUsRUFBRTtnQkFDL0IsT0FBTyxNQUFNLENBQUE7YUFDZDtZQUNELE1BQU0sSUFBSSxLQUFLLENBQUMsY0FBVyxJQUFJLENBQUMsTUFBTSx5Q0FBa0MsSUFBSSxDQUFDLFVBQVUsT0FBRyxDQUFDLENBQUE7UUFDN0YsQ0FBQzs7O09BQUE7SUFFTyxpQ0FBZSxHQUF2QixVQUF3QixLQUFZO1FBQ2xDLElBQUk7WUFDRixJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsVUFBVSxFQUFFLEtBQUssQ0FBQyxDQUFBO1NBQ3pDO1FBQUMsT0FBTyxLQUFLLEVBQUU7WUFDUixJQUFBLFNBQWlELEVBQS9DLDBCQUFVLEVBQUUsMEJBQVUsRUFBRSxvQkFBTyxFQUFFLGdCQUFLLENBQVM7WUFDdkQsSUFBTSxNQUFNLEdBQUcsRUFBRSxVQUFVLFlBQUEsRUFBRSxVQUFVLFlBQUEsRUFBRSxPQUFPLFNBQUEsRUFBRSxLQUFLLE9BQUEsRUFBRSxLQUFLLE9BQUEsRUFBRSxDQUFBO1lBQ2hFLElBQUksQ0FBQyxPQUFPLENBQUMsV0FBVyxDQUFDLEtBQUssRUFBRSx1QkFBb0IsSUFBSSxDQUFDLE1BQU0sT0FBRyxFQUFFLE1BQU0sQ0FBQyxDQUFBO1NBQzVFO0lBQ0gsQ0FBQztJQUVPLHNDQUFvQixHQUE1QixVQUE2QixLQUFZO1FBQ3ZDLElBQU0sV0FBVyxHQUFHLEtBQUssQ0FBQyxNQUFNLENBQUE7UUFDaEMsSUFBSSxJQUFJLENBQUMsT0FBTyxLQUFLLFdBQVcsRUFBRTtZQUNoQyxPQUFPLElBQUksQ0FBQTtTQUNaO2FBQU0sSUFBSSxXQUFXLFlBQVksT0FBTyxJQUFJLElBQUksQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDLFdBQVcsQ0FBQyxFQUFFO1lBQy9FLE9BQU8sSUFBSSxDQUFDLEtBQUssQ0FBQyxlQUFlLENBQUMsV0FBVyxDQUFDLENBQUE7U0FDL0M7YUFBTTtZQUNMLE9BQU8sSUFBSSxDQUFBO1NBQ1o7SUFDSCxDQUFDO0lBRUQsc0JBQVksK0JBQVU7YUFBdEI7WUFDRSxPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsVUFBVSxDQUFBO1FBQ2hDLENBQUM7OztPQUFBO0lBRUQsc0JBQVksK0JBQVU7YUFBdEI7WUFDRSxPQUFPLElBQUksQ0FBQyxNQUFNLENBQUMsVUFBVSxDQUFBO1FBQy9CLENBQUM7OztPQUFBO0lBRUQsc0JBQVksNEJBQU87YUFBbkI7WUFDRSxPQUFPLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFBO1FBQzNCLENBQUM7OztPQUFBO0lBRUQsc0JBQVksMEJBQUs7YUFBakI7WUFDRSxPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFBO1FBQzNCLENBQUM7OztPQUFBO0lBQ0gsY0FBQztBQUFELENBQUMsQUEzRUQsSUEyRUMifQ==","var ElementObserver = /** @class */ (function () {\n    function ElementObserver(element, delegate) {\n        var _this = this;\n        this.element = element;\n        this.started = false;\n        this.delegate = delegate;\n        this.elements = new Set;\n        this.mutationObserver = new MutationObserver(function (mutations) { return _this.processMutations(mutations); });\n    }\n    ElementObserver.prototype.start = function () {\n        if (!this.started) {\n            this.started = true;\n            this.mutationObserver.observe(this.element, { attributes: true, childList: true, subtree: true });\n            this.refresh();\n        }\n    };\n    ElementObserver.prototype.stop = function () {\n        if (this.started) {\n            this.mutationObserver.takeRecords();\n            this.mutationObserver.disconnect();\n            this.started = false;\n        }\n    };\n    ElementObserver.prototype.refresh = function () {\n        if (this.started) {\n            var matches = new Set(this.matchElementsInTree());\n            for (var _i = 0, _a = Array.from(this.elements); _i < _a.length; _i++) {\n                var element = _a[_i];\n                if (!matches.has(element)) {\n                    this.removeElement(element);\n                }\n            }\n            for (var _b = 0, _c = Array.from(matches); _b < _c.length; _b++) {\n                var element = _c[_b];\n                this.addElement(element);\n            }\n        }\n    };\n    // Mutation record processing\n    ElementObserver.prototype.processMutations = function (mutations) {\n        if (this.started) {\n            for (var _i = 0, mutations_1 = mutations; _i < mutations_1.length; _i++) {\n                var mutation = mutations_1[_i];\n                this.processMutation(mutation);\n            }\n        }\n    };\n    ElementObserver.prototype.processMutation = function (mutation) {\n        if (mutation.type == \"attributes\") {\n            this.processAttributeChange(mutation.target, mutation.attributeName);\n        }\n        else if (mutation.type == \"childList\") {\n            this.processRemovedNodes(mutation.removedNodes);\n            this.processAddedNodes(mutation.addedNodes);\n        }\n    };\n    ElementObserver.prototype.processAttributeChange = function (node, attributeName) {\n        var element = node;\n        if (this.elements.has(element)) {\n            if (this.delegate.elementAttributeChanged && this.matchElement(element)) {\n                this.delegate.elementAttributeChanged(element, attributeName);\n            }\n            else {\n                this.removeElement(element);\n            }\n        }\n        else if (this.matchElement(element)) {\n            this.addElement(element);\n        }\n    };\n    ElementObserver.prototype.processRemovedNodes = function (nodes) {\n        for (var _i = 0, _a = Array.from(nodes); _i < _a.length; _i++) {\n            var node = _a[_i];\n            var element = this.elementFromNode(node);\n            if (element) {\n                this.processTree(element, this.removeElement);\n            }\n        }\n    };\n    ElementObserver.prototype.processAddedNodes = function (nodes) {\n        for (var _i = 0, _a = Array.from(nodes); _i < _a.length; _i++) {\n            var node = _a[_i];\n            var element = this.elementFromNode(node);\n            if (element && this.elementIsActive(element)) {\n                this.processTree(element, this.addElement);\n            }\n        }\n    };\n    // Element matching\n    ElementObserver.prototype.matchElement = function (element) {\n        return this.delegate.matchElement(element);\n    };\n    ElementObserver.prototype.matchElementsInTree = function (tree) {\n        if (tree === void 0) { tree = this.element; }\n        return this.delegate.matchElementsInTree(tree);\n    };\n    ElementObserver.prototype.processTree = function (tree, processor) {\n        for (var _i = 0, _a = this.matchElementsInTree(tree); _i < _a.length; _i++) {\n            var element = _a[_i];\n            processor.call(this, element);\n        }\n    };\n    ElementObserver.prototype.elementFromNode = function (node) {\n        if (node.nodeType == Node.ELEMENT_NODE) {\n            return node;\n        }\n    };\n    ElementObserver.prototype.elementIsActive = function (element) {\n        if (element.isConnected != this.element.isConnected) {\n            return false;\n        }\n        else {\n            return this.element.contains(element);\n        }\n    };\n    // Element tracking\n    ElementObserver.prototype.addElement = function (element) {\n        if (!this.elements.has(element)) {\n            if (this.elementIsActive(element)) {\n                this.elements.add(element);\n                if (this.delegate.elementMatched) {\n                    this.delegate.elementMatched(element);\n                }\n            }\n        }\n    };\n    ElementObserver.prototype.removeElement = function (element) {\n        if (this.elements.has(element)) {\n            this.elements.delete(element);\n            if (this.delegate.elementUnmatched) {\n                this.delegate.elementUnmatched(element);\n            }\n        }\n    };\n    return ElementObserver;\n}());\nexport { ElementObserver };\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZWxlbWVudF9vYnNlcnZlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9lbGVtZW50X29ic2VydmVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQVNBO0lBUUUseUJBQVksT0FBZ0IsRUFBRSxRQUFpQztRQUEvRCxpQkFPQztRQU5DLElBQUksQ0FBQyxPQUFPLEdBQUcsT0FBTyxDQUFBO1FBQ3RCLElBQUksQ0FBQyxPQUFPLEdBQUcsS0FBSyxDQUFBO1FBQ3BCLElBQUksQ0FBQyxRQUFRLEdBQUcsUUFBUSxDQUFBO1FBRXhCLElBQUksQ0FBQyxRQUFRLEdBQUcsSUFBSSxHQUFHLENBQUE7UUFDdkIsSUFBSSxDQUFDLGdCQUFnQixHQUFHLElBQUksZ0JBQWdCLENBQUMsVUFBQyxTQUFTLElBQUssT0FBQSxLQUFJLENBQUMsZ0JBQWdCLENBQUMsU0FBUyxDQUFDLEVBQWhDLENBQWdDLENBQUMsQ0FBQTtJQUMvRixDQUFDO0lBRUQsK0JBQUssR0FBTDtRQUNFLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFO1lBQ2pCLElBQUksQ0FBQyxPQUFPLEdBQUcsSUFBSSxDQUFBO1lBQ25CLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxFQUFFLFVBQVUsRUFBRSxJQUFJLEVBQUUsU0FBUyxFQUFFLElBQUksRUFBRSxPQUFPLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQTtZQUNqRyxJQUFJLENBQUMsT0FBTyxFQUFFLENBQUE7U0FDZjtJQUNILENBQUM7SUFFRCw4QkFBSSxHQUFKO1FBQ0UsSUFBSSxJQUFJLENBQUMsT0FBTyxFQUFFO1lBQ2hCLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxXQUFXLEVBQUUsQ0FBQTtZQUNuQyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsVUFBVSxFQUFFLENBQUE7WUFDbEMsSUFBSSxDQUFDLE9BQU8sR0FBRyxLQUFLLENBQUE7U0FDckI7SUFDSCxDQUFDO0lB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","import { ElementObserver } from \"./element_observer\";\nvar AttributeObserver = /** @class */ (function () {\n    function AttributeObserver(element, attributeName, delegate) {\n        this.attributeName = attributeName;\n        this.delegate = delegate;\n        this.elementObserver = new ElementObserver(element, this);\n    }\n    Object.defineProperty(AttributeObserver.prototype, \"element\", {\n        get: function () {\n            return this.elementObserver.element;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AttributeObserver.prototype, \"selector\", {\n        get: function () {\n            return \"[\" + this.attributeName + \"]\";\n        },\n        enumerable: true,\n        configurable: true\n    });\n    AttributeObserver.prototype.start = function () {\n        this.elementObserver.start();\n    };\n    AttributeObserver.prototype.stop = function () {\n        this.elementObserver.stop();\n    };\n    AttributeObserver.prototype.refresh = function () {\n        this.elementObserver.refresh();\n    };\n    Object.defineProperty(AttributeObserver.prototype, \"started\", {\n        get: function () {\n            return this.elementObserver.started;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    // Element observer delegate\n    AttributeObserver.prototype.matchElement = function (element) {\n        return element.hasAttribute(this.attributeName);\n    };\n    AttributeObserver.prototype.matchElementsInTree = function (tree) {\n        var match = this.matchElement(tree) ? [tree] : [];\n        var matches = Array.from(tree.querySelectorAll(this.selector));\n        return match.concat(matches);\n    };\n    AttributeObserver.prototype.elementMatched = function (element) {\n        if (this.delegate.elementMatchedAttribute) {\n            this.delegate.elementMatchedAttribute(element, this.attributeName);\n        }\n    };\n    AttributeObserver.prototype.elementUnmatched = function (element) {\n        if (this.delegate.elementUnmatchedAttribute) {\n            this.delegate.elementUnmatchedAttribute(element, this.attributeName);\n        }\n    };\n    AttributeObserver.prototype.elementAttributeChanged = function (element, attributeName) {\n        if (this.delegate.elementAttributeValueChanged && this.attributeName == attributeName) {\n            this.delegate.elementAttributeValueChanged(element, attributeName);\n        }\n    };\n    return AttributeObserver;\n}());\nexport { AttributeObserver };\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXR0cmlidXRlX29ic2VydmVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL2F0dHJpYnV0ZV9vYnNlcnZlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsZUFBZSxFQUEyQixNQUFNLG9CQUFvQixDQUFBO0FBUTdFO0lBTUUsMkJBQVksT0FBZ0IsRUFBRSxhQUFxQixFQUFFLFFBQW1DO1FBQ3RGLElBQUksQ0FBQyxhQUFhLEdBQUcsYUFBYSxDQUFBO1FBQ2xDLElBQUksQ0FBQyxRQUFRLEdBQUcsUUFBUSxDQUFBO1FBRXhCLElBQUksQ0FBQyxlQUFlLEdBQUcsSUFBSSxlQUFlLENBQUMsT0FBTyxFQUFFLElBQUksQ0FBQyxDQUFBO0lBQzNELENBQUM7SUFFRCxzQkFBSSxzQ0FBTzthQUFYO1lBQ0UsT0FBTyxJQUFJLENBQUMsZUFBZSxDQUFDLE9BQU8sQ0FBQTtRQUNyQyxDQUFDOzs7T0FBQTtJQUVELHNCQUFJLHVDQUFRO2FBQVo7WUFDRSxPQUFPLE1BQUksSUFBSSxDQUFDLGFBQWEsTUFBRyxDQUFBO1FBQ2xDLENBQUM7OztPQUFBO0lBRUQsaUNBQUssR0FBTDtRQUNFLElBQUksQ0FBQyxlQUFlLENBQUMsS0FBSyxFQUFFLENBQUE7SUFDOUIsQ0FBQztJQUVELGdDQUFJLEdBQUo7UUFDRSxJQUFJLENBQUMsZUFBZSxDQUFDLElBQUksRUFBRSxDQUFBO0lBQzdCLENBQUM7SUFFRCxtQ0FBTyxHQUFQO1FBQ0UsSUFBSSxDQUFDLGVBQWUsQ0FBQyxPQUFPLEVBQUUsQ0FBQTtJQUNoQyxDQUFDO0lBRUQsc0JBQUksc0NBQU87YUFBWDtZQUNFLE9BQU8sSUFBSSxDQUFDLGVBQWUsQ0FBQyxPQUFPLENBQUE7UUFDckMsQ0FBQzs7O09BQUE7SUFFRCw0QkFBNEI7SUFFNUIsd0NBQVksR0FBWixVQUFhLE9BQWdCO1FBQzNCLE9BQU8sT0FBTyxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLENBQUE7SUFDakQsQ0FBQztJQUVELCtDQUFtQixHQUFuQixVQUFvQixJQUFhO1FBQy9CLElBQU0sS0FBSyxHQUFHLElBQUksQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQTtRQUNuRCxJQUFNLE9BQU8sR0FBRyxLQUFLLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQTtRQUNoRSxPQUFPLEtBQUssQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUE7SUFDOUIsQ0FBQztJQUVELDBDQUFjLEdBQWQsVUFBZSxPQUFnQjtRQUM3QixJQUFJLElBQUksQ0FBQyxRQUFRLENBQUMsdUJBQXVCLEVBQUU7WUFDekMsSUFBSSxDQUFDLFFBQVEsQ0FBQyx1QkFBdUIsQ0FBQyxPQUFPLEVBQUUsSUFBSSxDQUFDLGFBQWEsQ0FBQyxDQUFBO1NBQ25FO0lBQ0gsQ0FBQztJQUVELDRDQUFnQixHQUFoQixVQUFpQixPQUFnQjtRQUMvQixJQUFJLElBQUksQ0FBQyxRQUFRLENBQUMseUJBQXlCLEVBQUU7WUFDM0MsSUFBSSxDQUFDLFFBQVEsQ0FBQyx5QkFBeUIsQ0FBQyxPQUFPLEVBQUUsSUFBSSxDQUFDLGFBQWEsQ0FBQyxDQUFBO1NBQ3JFO0lBQ0gsQ0FBQztJQUVELG1EQUF1QixHQUF2QixVQUF3QixPQUFnQixFQUFFLGFBQXFCO1FBQzdELElBQUksSUFBSSxDQUFDLFFBQVEsQ0FBQyw0QkFBNEIsSUFBSSxJQUFJLENBQUMsYUFBYSxJQUFJLGFBQWEsRUFBRTtZQUNyRixJQUFJLENBQUMsUUFBUSxDQUFDLDRCQUE0QixDQUFDLE9BQU8sRUFBRSxhQUFhLENBQUMsQ0FBQTtTQUNuRTtJQUNILENBQUM7SUFDSCx3QkFBQztBQUFELENBQUMsQUFsRUQsSUFrRUMifQ==","export function add(map, key, value) {\n    fetch(map, key).add(value);\n}\nexport function del(map, key, value) {\n    fetch(map, key).delete(value);\n    prune(map, key);\n}\nexport function fetch(map, key) {\n    var values = map.get(key);\n    if (!values) {\n        values = new Set();\n        map.set(key, values);\n    }\n    return values;\n}\nexport function prune(map, key) {\n    var values = map.get(key);\n    if (values != null && values.size == 0) {\n        map.delete(key);\n    }\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2V0X29wZXJhdGlvbnMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvc2V0X29wZXJhdGlvbnMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsTUFBTSxjQUFvQixHQUFtQixFQUFFLEdBQU0sRUFBRSxLQUFRO0lBQzdELEtBQUssQ0FBQyxHQUFHLEVBQUUsR0FBRyxDQUFDLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFBO0FBQzVCLENBQUM7QUFFRCxNQUFNLGNBQW9CLEdBQW1CLEVBQUUsR0FBTSxFQUFFLEtBQVE7SUFDN0QsS0FBSyxDQUFDLEdBQUcsRUFBRSxHQUFHLENBQUMsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUE7SUFDN0IsS0FBSyxDQUFDLEdBQUcsRUFBRSxHQUFHLENBQUMsQ0FBQTtBQUNqQixDQUFDO0FBRUQsTUFBTSxnQkFBc0IsR0FBbUIsRUFBRSxHQUFNO0lBQ3JELElBQUksTUFBTSxHQUFHLEdBQUcsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUE7SUFDekIsSUFBSSxDQUFDLE1BQU0sRUFBRTtRQUNYLE1BQU0sR0FBRyxJQUFJLEdBQUcsRUFBRSxDQUFBO1FBQ2xCLEdBQUcsQ0FBQyxHQUFHLENBQUMsR0FBRyxFQUFFLE1BQU0sQ0FBQyxDQUFBO0tBQ3JCO0lBQ0QsT0FBTyxNQUFNLENBQUE7QUFDZixDQUFDO0FBRUQsTUFBTSxnQkFBc0IsR0FBbUIsRUFBRSxHQUFNO0lBQ3JELElBQU0sTUFBTSxHQUFHLEdBQUcsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUE7SUFDM0IsSUFBSSxNQUFNLElBQUksSUFBSSxJQUFJLE1BQU0sQ0FBQyxJQUFJLElBQUksQ0FBQyxFQUFFO1FBQ3RDLEdBQUcsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUE7S0FDaEI7QUFDSCxDQUFDIn0=","import { add, del } from \"./set_operations\";\nvar Multimap = /** @class */ (function () {\n    function Multimap() {\n        this.valuesByKey = new Map();\n    }\n    Object.defineProperty(Multimap.prototype, \"values\", {\n        get: function () {\n            var sets = Array.from(this.valuesByKey.values());\n            return sets.reduce(function (values, set) { return values.concat(Array.from(set)); }, []);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Multimap.prototype, \"size\", {\n        get: function () {\n            var sets = Array.from(this.valuesByKey.values());\n            return sets.reduce(function (size, set) { return size + set.size; }, 0);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Multimap.prototype.add = function (key, value) {\n        add(this.valuesByKey, key, value);\n    };\n    Multimap.prototype.delete = function (key, value) {\n        del(this.valuesByKey, key, value);\n    };\n    Multimap.prototype.has = function (key, value) {\n        var values = this.valuesByKey.get(key);\n        return values != null && values.has(value);\n    };\n    Multimap.prototype.hasKey = function (key) {\n        return this.valuesByKey.has(key);\n    };\n    Multimap.prototype.hasValue = function (value) {\n        var sets = Array.from(this.valuesByKey.values());\n        return sets.some(function (set) { return set.has(value); });\n    };\n    Multimap.prototype.getValuesForKey = function (key) {\n        var values = this.valuesByKey.get(key);\n        return values ? Array.from(values) : [];\n    };\n    Multimap.prototype.getKeysForValue = function (value) {\n        return Array.from(this.valuesByKey)\n            .filter(function (_a) {\n            var key = _a[0], values = _a[1];\n            return values.has(value);\n        })\n            .map(function (_a) {\n            var key = _a[0], values = _a[1];\n            return key;\n        });\n    };\n    return Multimap;\n}());\nexport { Multimap };\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibXVsdGltYXAuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvbXVsdGltYXAudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsTUFBTSxrQkFBa0IsQ0FBQTtBQUUzQztJQUdFO1FBQ0UsSUFBSSxDQUFDLFdBQVcsR0FBRyxJQUFJLEdBQUcsRUFBYSxDQUFBO0lBQ3pDLENBQUM7SUFFRCxzQkFBSSw0QkFBTTthQUFWO1lBQ0UsSUFBTSxJQUFJLEdBQUcsS0FBSyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLE1BQU0sRUFBRSxDQUFDLENBQUE7WUFDbEQsT0FBTyxJQUFJLENBQUMsTUFBTSxDQUFDLFVBQUMsTUFBTSxFQUFFLEdBQUcsSUFBSyxPQUFBLE1BQU0sQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxFQUE5QixDQUE4QixFQUFRLEVBQUUsQ0FBQyxDQUFBO1FBQy9FLENBQUM7OztPQUFBO0lBRUQsc0JBQUksMEJBQUk7YUFBUjtZQUNFLElBQU0sSUFBSSxHQUFHLEtBQUssQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxDQUFBO1lBQ2xELE9BQU8sSUFBSSxDQUFDLE1BQU0sQ0FBQyxVQUFDLElBQUksRUFBRSxHQUFHLElBQUssT0FBQSxJQUFJLEdBQUcsR0FBRyxDQUFDLElBQUksRUFBZixDQUFlLEVBQUUsQ0FBQyxDQUFDLENBQUE7UUFDdkQsQ0FBQzs7O09BQUE7SUFFRCxzQkFBRyxHQUFILFVBQUksR0FBTSxFQUFFLEtBQVE7UUFDbEIsR0FBRyxDQUFDLElBQUksQ0FBQyxXQUFXLEVBQUUsR0FBRyxFQUFFLEtBQUssQ0FBQyxDQUFBO0lBQ25DLENBQUM7SUFFRCx5QkFBTSxHQUFOLFVBQU8sR0FBTSxFQUFFLEtBQVE7UUFDckIsR0FBRyxDQUFDLElBQUksQ0FBQyxXQUFXLEVBQUUsR0FBRyxFQUFFLEtBQUssQ0FBQyxDQUFBO0lBQ25DLENBQUM7SUFFRCxzQkFBRyxHQUFILFVBQUksR0FBTSxFQUFFLEtBQVE7UUFDbEIsSUFBTSxNQUFNLEdBQUcsSUFBSSxDQUFDLFdBQVcsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUE7UUFDeEMsT0FBTyxNQUFNLElBQUksSUFBSSxJQUFJLE1BQU0sQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUE7SUFDNUMsQ0FBQztJQUVELHlCQUFNLEdBQU4sVUFBTyxHQUFNO1FBQ1gsT0FBTyxJQUFJLENBQUMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQTtJQUNsQyxDQUFDO0lBRUQsMkJBQVEsR0FBUixVQUFTLEtBQVE7UUFDZixJQUFNLElBQUksR0FBRyxLQUFLLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsTUFBTSxFQUFFLENBQUMsQ0FBQTtRQUNsRCxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsVUFBQSxHQUFHLElBQUksT0FBQSxHQUFHLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxFQUFkLENBQWMsQ0FBQyxDQUFBO0lBQ3pDLENBQUM7SUFFRCxrQ0FBZSxHQUFmLFVBQWdCLEdBQU07UUFDcEIsSUFBTSxNQUFNLEdBQUcsSUFBSSxDQUFDLFdBQVcsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUE7UUFDeEMsT0FBTyxNQUFNLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQTtJQUN6QyxDQUFDO0lBRUQsa0NBQWUsR0FBZixVQUFnQixLQUFRO1FBQ3RCLE9BQU8sS0FBSyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDO2FBQ2hDLE1BQU0sQ0FBQyxVQUFDLEVBQWE7Z0JBQVosV0FBRyxFQUFFLGNBQU07WUFBTSxPQUFBLE1BQU0sQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDO1FBQWpCLENBQWlCLENBQUM7YUFDNUMsR0FBRyxDQUFDLFVBQUMsRUFBYTtnQkFBWixXQUFHLEVBQUUsY0FBTTtZQUFNLE9BQUEsR0FBRztRQUFILENBQUcsQ0FBQyxDQUFBO0lBQ2hDLENBQUM7SUFDSCxlQUFDO0FBQUQsQ0FBQyxBQWpERCxJQWlEQyJ9","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { Multimap } from \"./multimap\";\nimport { add, del } from \"./set_operations\";\nvar IndexedMultimap = /** @class */ (function (_super) {\n    __extends(IndexedMultimap, _super);\n    function IndexedMultimap() {\n        var _this = _super.call(this) || this;\n        _this.keysByValue = new Map;\n        return _this;\n    }\n    Object.defineProperty(IndexedMultimap.prototype, \"values\", {\n        get: function () {\n            return Array.from(this.keysByValue.keys());\n        },\n        enumerable: true,\n        configurable: true\n    });\n    IndexedMultimap.prototype.add = function (key, value) {\n        _super.prototype.add.call(this, key, value);\n        add(this.keysByValue, value, key);\n    };\n    IndexedMultimap.prototype.delete = function (key, value) {\n        _super.prototype.delete.call(this, key, value);\n        del(this.keysByValue, value, key);\n    };\n    IndexedMultimap.prototype.hasValue = function (value) {\n        return this.keysByValue.has(value);\n    };\n    IndexedMultimap.prototype.getKeysForValue = function (value) {\n        var set = this.keysByValue.get(value);\n        return set ? Array.from(set) : [];\n    };\n    return IndexedMultimap;\n}(Multimap));\nexport { IndexedMultimap };\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXhlZF9tdWx0aW1hcC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9pbmRleGVkX211bHRpbWFwLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFBQSxPQUFPLEVBQUUsUUFBUSxFQUFFLE1BQU0sWUFBWSxDQUFBO0FBQ3JDLE9BQU8sRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLE1BQU0sa0JBQWtCLENBQUE7QUFFM0M7SUFBMkMsbUNBQWM7SUFHdkQ7UUFBQSxZQUNFLGlCQUFPLFNBRVI7UUFEQyxLQUFJLENBQUMsV0FBVyxHQUFHLElBQUksR0FBRyxDQUFBOztJQUM1QixDQUFDO0lBRUQsc0JBQUksbUNBQU07YUFBVjtZQUNFLE9BQU8sS0FBSyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLElBQUksRUFBRSxDQUFDLENBQUE7UUFDNUMsQ0FBQzs7O09BQUE7SUFFRCw2QkFBRyxHQUFILFVBQUksR0FBTSxFQUFFLEtBQVE7UUFDbEIsaUJBQU0sR0FBRyxZQUFDLEdBQUcsRUFBRSxLQUFLLENBQUMsQ0FBQTtRQUNyQixHQUFHLENBQUMsSUFBSSxDQUFDLFdBQVcsRUFBRSxLQUFLLEVBQUUsR0FBRyxDQUFDLENBQUE7SUFDbkMsQ0FBQztJQUVELGdDQUFNLEdBQU4sVUFBTyxHQUFNLEVBQUUsS0FBUTtRQUNyQixpQkFBTSxNQUFNLFlBQUMsR0FBRyxFQUFFLEtBQUssQ0FBQyxDQUFBO1FBQ3hCLEdBQUcsQ0FBQyxJQUFJLENBQUMsV0FBVyxFQUFFLEtBQUssRUFBRSxHQUFHLENBQUMsQ0FBQTtJQUNuQyxDQUFDO0lBRUQsa0NBQVEsR0FBUixVQUFTLEtBQVE7UUFDZixPQUFPLElBQUksQ0FBQyxXQUFXLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFBO0lBQ3BDLENBQUM7SUFFRCx5Q0FBZSxHQUFmLFVBQWdCLEtBQVE7UUFDdEIsSUFBTSxHQUFHLEdBQUcsSUFBSSxDQUFDLFdBQVcsQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUE7UUFDdkMsT0FBTyxHQUFHLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQTtJQUNuQyxDQUFDO0lBQ0gsc0JBQUM7QUFBRCxDQUFDLEFBOUJELENBQTJDLFFBQVEsR0E4QmxEIn0=","import { AttributeObserver } from \"./attribute_observer\";\nimport { Multimap } from \"@stimulus/multimap\";\nvar TokenListObserver = /** @class */ (function () {\n    function TokenListObserver(element, attributeName, delegate) {\n        this.attributeObserver = new AttributeObserver(element, attributeName, this);\n        this.delegate = delegate;\n        this.tokensByElement = new Multimap;\n    }\n    Object.defineProperty(TokenListObserver.prototype, \"started\", {\n        get: function () {\n            return this.attributeObserver.started;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    TokenListObserver.prototype.start = function () {\n        this.attributeObserver.start();\n    };\n    TokenListObserver.prototype.stop = function () {\n        this.attributeObserver.stop();\n    };\n    TokenListObserver.prototype.refresh = function () {\n        this.attributeObserver.refresh();\n    };\n    Object.defineProperty(TokenListObserver.prototype, \"element\", {\n        get: function () {\n            return this.attributeObserver.element;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TokenListObserver.prototype, \"attributeName\", {\n        get: function () {\n            return this.attributeObserver.attributeName;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    // Attribute observer delegate\n    TokenListObserver.prototype.elementMatchedAttribute = function (element) {\n        this.tokensMatched(this.readTokensForElement(element));\n    };\n    TokenListObserver.prototype.elementAttributeValueChanged = function (element) {\n        var _a = this.refreshTokensForElement(element), unmatchedTokens = _a[0], matchedTokens = _a[1];\n        this.tokensUnmatched(unmatchedTokens);\n        this.tokensMatched(matchedTokens);\n    };\n    TokenListObserver.prototype.elementUnmatchedAttribute = function (element) {\n        this.tokensUnmatched(this.tokensByElement.getValuesForKey(element));\n    };\n    TokenListObserver.prototype.tokensMatched = function (tokens) {\n        var _this = this;\n        tokens.forEach(function (token) { return _this.tokenMatched(token); });\n    };\n    TokenListObserver.prototype.tokensUnmatched = function (tokens) {\n        var _this = this;\n        tokens.forEach(function (token) { return _this.tokenUnmatched(token); });\n    };\n    TokenListObserver.prototype.tokenMatched = function (token) {\n        this.delegate.tokenMatched(token);\n        this.tokensByElement.add(token.element, token);\n    };\n    TokenListObserver.prototype.tokenUnmatched = function (token) {\n        this.delegate.tokenUnmatched(token);\n        this.tokensByElement.delete(token.element, token);\n    };\n    TokenListObserver.prototype.refreshTokensForElement = function (element) {\n        var previousTokens = this.tokensByElement.getValuesForKey(element);\n        var currentTokens = this.readTokensForElement(element);\n        var firstDifferingIndex = zip(previousTokens, currentTokens)\n            .findIndex(function (_a) {\n            var previousToken = _a[0], currentToken = _a[1];\n            return !tokensAreEqual(previousToken, currentToken);\n        });\n        if (firstDifferingIndex == -1) {\n            return [[], []];\n        }\n        else {\n            return [previousTokens.slice(firstDifferingIndex), currentTokens.slice(firstDifferingIndex)];\n        }\n    };\n    TokenListObserver.prototype.readTokensForElement = function (element) {\n        var attributeName = this.attributeName;\n        var tokenString = element.getAttribute(attributeName) || \"\";\n        return parseTokenString(tokenString, element, attributeName);\n    };\n    return TokenListObserver;\n}());\nexport { TokenListObserver };\nfunction parseTokenString(tokenString, element, attributeName) {\n    return tokenString.trim().split(/\\s+/).filter(function (content) { return content.length; })\n        .map(function (content, index) { return ({ element: element, attributeName: attributeName, content: content, index: index }); });\n}\nfunction zip(left, right) {\n    var length = Math.max(left.length, right.length);\n    return Array.from({ length: length }, function (_, index) { return [left[index], right[index]]; });\n}\nfunction tokensAreEqual(left, right) {\n    return left && right && left.index == right.index && left.content == right.content;\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidG9rZW5fbGlzdF9vYnNlcnZlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy90b2tlbl9saXN0X29ic2VydmVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxpQkFBaUIsRUFBNkIsTUFBTSxzQkFBc0IsQ0FBQTtBQUNuRixPQUFPLEVBQUUsUUFBUSxFQUFFLE1BQU0sb0JBQW9CLENBQUE7QUFjN0M7SUFLRSwyQkFBWSxPQUFnQixFQUFFLGFBQXFCLEVBQUUsUUFBbUM7UUFDdEYsSUFBSSxDQUFDLGlCQUFpQixHQUFHLElBQUksaUJBQWlCLENBQUMsT0FBTyxFQUFFLGFBQWEsRUFBRSxJQUFJLENBQUMsQ0FBQTtRQUM1RSxJQUFJLENBQUMsUUFBUSxHQUFHLFFBQVEsQ0FBQTtRQUN4QixJQUFJLENBQUMsZUFBZSxHQUFHLElBQUksUUFBUSxDQUFBO0lBQ3JDLENBQUM7SUFFRCxzQkFBSSxzQ0FBTzthQUFYO1lBQ0UsT0FBTyxJQUFJLENBQUMsaUJBQWlCLENBQUMsT0FBTyxDQUFBO1FBQ3ZDLENBQUM7OztPQUFBO0lBRUQsaUNBQUssR0FBTDtRQUNFLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxLQUFLLEVBQUUsQ0FBQTtJQUNoQyxDQUFDO0lBRUQsZ0NBQUksR0FBSjtRQUNFLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxJQUFJLEVBQUUsQ0FBQTtJQUMvQixDQUFDO0lBRUQsbUNBQU8sR0FBUDtRQUNFLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxPQUFPLEVBQUUsQ0FBQTtJQUNsQyxDQUFDO0lBRUQsc0JBQUksc0NBQU87YUFBWDtZQUNFLE9BQU8sSUFBSSxDQUFDLGlCQUFpQixDQUFDLE9BQU8sQ0FBQTtRQUN2QyxDQUFDOzs7T0FBQTtJQUVELHNCQUFJLDRDQUFhO2FBQWpCO1lBQ0UsT0FBTyxJQUFJLENBQUMsaUJBQWlCLENBQUMsYUFBYSxDQUFBO1FBQzdDLENBQUM7OztPQUFBO0lBRUQsOEJBQThCO0lB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","import { TokenListObserver } from \"./token_list_observer\";\nvar ValueListObserver = /** @class */ (function () {\n    function ValueListObserver(element, attributeName, delegate) {\n        this.tokenListObserver = new TokenListObserver(element, attributeName, this);\n        this.delegate = delegate;\n        this.parseResultsByToken = new WeakMap;\n        this.valuesByTokenByElement = new WeakMap;\n    }\n    Object.defineProperty(ValueListObserver.prototype, \"started\", {\n        get: function () {\n            return this.tokenListObserver.started;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    ValueListObserver.prototype.start = function () {\n        this.tokenListObserver.start();\n    };\n    ValueListObserver.prototype.stop = function () {\n        this.tokenListObserver.stop();\n    };\n    ValueListObserver.prototype.refresh = function () {\n        this.tokenListObserver.refresh();\n    };\n    Object.defineProperty(ValueListObserver.prototype, \"element\", {\n        get: function () {\n            return this.tokenListObserver.element;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ValueListObserver.prototype, \"attributeName\", {\n        get: function () {\n            return this.tokenListObserver.attributeName;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    ValueListObserver.prototype.tokenMatched = function (token) {\n        var element = token.element;\n        var value = this.fetchParseResultForToken(token).value;\n        if (value) {\n            this.fetchValuesByTokenForElement(element).set(token, value);\n            this.delegate.elementMatchedValue(element, value);\n        }\n    };\n    ValueListObserver.prototype.tokenUnmatched = function (token) {\n        var element = token.element;\n        var value = this.fetchParseResultForToken(token).value;\n        if (value) {\n            this.fetchValuesByTokenForElement(element).delete(token);\n            this.delegate.elementUnmatchedValue(element, value);\n        }\n    };\n    ValueListObserver.prototype.fetchParseResultForToken = function (token) {\n        var parseResult = this.parseResultsByToken.get(token);\n        if (!parseResult) {\n            parseResult = this.parseToken(token);\n            this.parseResultsByToken.set(token, parseResult);\n        }\n        return parseResult;\n    };\n    ValueListObserver.prototype.fetchValuesByTokenForElement = function (element) {\n        var valuesByToken = this.valuesByTokenByElement.get(element);\n        if (!valuesByToken) {\n            valuesByToken = new Map;\n            this.valuesByTokenByElement.set(element, valuesByToken);\n        }\n        return valuesByToken;\n    };\n    ValueListObserver.prototype.parseToken = function (token) {\n        try {\n            var value = this.delegate.parseValueForToken(token);\n            return { value: value };\n        }\n        catch (error) {\n            return { error: error };\n        }\n    };\n    return ValueListObserver;\n}());\nexport { ValueListObserver };\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmFsdWVfbGlzdF9vYnNlcnZlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy92YWx1ZV9saXN0X29ic2VydmVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBUyxpQkFBaUIsRUFBNkIsTUFBTSx1QkFBdUIsQ0FBQTtBQWEzRjtJQU1FLDJCQUFZLE9BQWdCLEVBQUUsYUFBcUIsRUFBRSxRQUFzQztRQUN6RixJQUFJLENBQUMsaUJBQWlCLEdBQUcsSUFBSSxpQkFBaUIsQ0FBQyxPQUFPLEVBQUUsYUFBYSxFQUFFLElBQUksQ0FBQyxDQUFBO1FBQzVFLElBQUksQ0FBQyxRQUFRLEdBQUcsUUFBUSxDQUFBO1FBQ3hCLElBQUksQ0FBQyxtQkFBbUIsR0FBRyxJQUFJLE9BQU8sQ0FBQTtRQUN0QyxJQUFJLENBQUMsc0JBQXNCLEdBQUcsSUFBSSxPQUFPLENBQUE7SUFDM0MsQ0FBQztJQUVELHNCQUFJLHNDQUFPO2FBQVg7WUFDRSxPQUFPLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxPQUFPLENBQUE7UUFDdkMsQ0FBQzs7O09BQUE7SUFFRCxpQ0FBSyxHQUFMO1FBQ0UsSUFBSSxDQUFDLGlCQUFpQixDQUFDLEtBQUssRUFBRSxDQUFBO0lBQ2hDLENBQUM7SUFFRCxnQ0FBSSxHQUFKO1FBQ0UsSUFBSSxDQUFDLGlCQUFpQixDQUFDLElBQUksRUFBRSxDQUFBO0lBQy9CLENBQUM7SUFFRCxtQ0FBTyxHQUFQO1FBQ0UsSUFBSSxDQUFDLGlCQUFpQixDQUFDLE9BQU8sRUFBRSxDQUFBO0lBQ2xDLENBQUM7SUFFRCxzQkFBSSxzQ0FBTzthQUFYO1lBQ0UsT0FBTyxJQUFJLENBQUMsaUJBQWlCLENBQUMsT0FBTyxDQUFBO1FBQ3ZDLENBQUM7OztPQUFBO0lBRUQsc0JBQUksNENBQWE7YUFBakI7WUFDRSxPQUFPLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxhQUFhLENBQUE7UUFDN0MsQ0FBQzs7O09BQUE7SUFFRCx3Q0FBWSxHQUFaLFVBQWEsS0FBWTtRQUNmLElBQUEsdUJBQU8sQ0FBVTtRQUNqQixJQUFBLGtEQUFLLENBQXlDO1FBQ3RELElBQUksS0FBSyxFQUFFO1lBQ1QsSUFBSSxDQUFDLDRCQUE0QixDQUFDLE9BQU8sQ0FBQyxDQUFDLEdBQUcsQ0FBQyxLQUFLLEVBQUUsS0FBSyxDQUFDLENBQUE7WUFDNUQsSUFBSSxDQUFDLFFBQVEsQ0FBQyxtQkFBbUIsQ0FBQyxPQUFPLEVBQUUsS0FBSyxDQUFDLENBQUE7U0FDbEQ7SUFDSCxDQUFDO0lBRUQsMENBQWMsR0FBZCxVQUFlLEtBQVk7UUFDakIsSUFBQSx1QkFBTyxDQUFVO1FBQ2pCLElBQUEsa0RBQUssQ0FBeUM7UUFDdEQsSUFBSSxLQUFLLEVBQUU7WUFDVCxJQUFJLENBQUMsNEJBQTRCLENBQUMsT0FBTyxDQUFDLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFBO1lBQ3hELElBQUksQ0FBQyxRQUFRLENBQUMscUJBQXFCLENBQUMsT0FBTyxFQUFFLEtBQUssQ0FBQyxDQUFBO1NBQ3BEO0lBQ0gsQ0FBQztJQUVPLG9EQUF3QixHQUFoQyxVQUFpQyxLQUFZO1FBQzNDLElBQUksV0FBVyxHQUFHLElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUE7UUFDckQsSUFBSSxDQUFDLFdBQVcsRUFBRTtZQUNoQixXQUFXLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQyxLQUFLLENBQUMsQ0FBQTtZQUNwQyxJQUFJLENBQUMsbUJBQW1CLENBQUMsR0FBRyxDQUFDLEtBQUssRUFBRSxXQUFXLENBQUMsQ0FBQTtTQUNqRDtRQUNELE9BQU8sV0FBVyxDQUFBO0lBQ3BCLENBQUM7SUFFTyx3REFBNEIsR0FBcEMsVUFBcUMsT0FBZ0I7UUFDbkQsSUFBSSxhQUFhLEdBQUcsSUFBSSxDQUFDLHNCQUFzQixDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsQ0FBQTtRQUM1RCxJQUFJLENBQUMsYUFBYSxFQUFFO1lBQ2xCLGFBQWEsR0FBRyxJQUFJLEdBQUcsQ0FBQTtZQUN2QixJQUFJLENBQUMsc0JBQXNCLENBQUMsR0FBRyxDQUFDLE9BQU8sRUFBRSxhQUFhLENBQUMsQ0FBQTtTQUN4RDtRQUNELE9BQU8sYUFBYSxDQUFBO0lBQ3RCLENBQUM7SUFFTyxzQ0FBVSxHQUFsQixVQUFtQixLQUFZO1FBQzdCLElBQUk7WUFDRixJQUFNLEtBQUssR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDLGtCQUFrQixDQUFDLEtBQUssQ0FBQyxDQUFBO1lBQ3JELE9BQU8sRUFBRSxLQUFLLE9BQUEsRUFBRSxDQUFBO1NBQ2pCO1FBQUMsT0FBTyxLQUFLLEVBQUU7WUFDZCxPQUFPLEVBQUUsS0FBSyxPQUFBLEVBQUUsQ0FBQTtTQUNqQjtJQUNILENBQUM7SUFDSCx3QkFBQztBQUFELENBQUMsQUFqRkQsSUFpRkMifQ==","import { Action } from \"./action\";\nimport { Binding } from \"./binding\";\nimport { ValueListObserver } from \"@stimulus/mutation-observers\";\nvar BindingObserver = /** @class */ (function () {\n    function BindingObserver(context, delegate) {\n        this.context = context;\n        this.delegate = delegate;\n        this.bindingsByAction = new Map;\n    }\n    BindingObserver.prototype.start = function () {\n        if (!this.valueListObserver) {\n            this.valueListObserver = new ValueListObserver(this.element, this.actionAttribute, this);\n            this.valueListObserver.start();\n        }\n    };\n    BindingObserver.prototype.stop = function () {\n        if (this.valueListObserver) {\n            this.valueListObserver.stop();\n            delete this.valueListObserver;\n            this.disconnectAllActions();\n        }\n    };\n    Object.defineProperty(BindingObserver.prototype, \"element\", {\n        get: function () {\n            return this.context.element;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BindingObserver.prototype, \"identifier\", {\n        get: function () {\n            return this.context.identifier;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BindingObserver.prototype, \"actionAttribute\", {\n        get: function () {\n            return this.schema.actionAttribute;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BindingObserver.prototype, \"schema\", {\n        get: function () {\n            return this.context.schema;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BindingObserver.prototype, \"bindings\", {\n        get: function () {\n            return Array.from(this.bindingsByAction.values());\n        },\n        enumerable: true,\n        configurable: true\n    });\n    BindingObserver.prototype.connectAction = function (action) {\n        var binding = new Binding(this.context, action);\n        this.bindingsByAction.set(action, binding);\n        this.delegate.bindingConnected(binding);\n    };\n    BindingObserver.prototype.disconnectAction = function (action) {\n        var binding = this.bindingsByAction.get(action);\n        if (binding) {\n            this.bindingsByAction.delete(action);\n            this.delegate.bindingDisconnected(binding);\n        }\n    };\n    BindingObserver.prototype.disconnectAllActions = function () {\n        var _this = this;\n        this.bindings.forEach(function (binding) { return _this.delegate.bindingDisconnected(binding); });\n        this.bindingsByAction.clear();\n    };\n    // Value observer delegate\n    BindingObserver.prototype.parseValueForToken = function (token) {\n        var action = Action.forToken(token);\n        if (action.identifier == this.identifier) {\n            return action;\n        }\n    };\n    BindingObserver.prototype.elementMatchedValue = function (element, action) {\n        this.connectAction(action);\n    };\n    BindingObserver.prototype.elementUnmatchedValue = function (element, action) {\n        this.disconnectAction(action);\n    };\n    return BindingObserver;\n}());\nexport { BindingObserver };\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmluZGluZ19vYnNlcnZlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9iaW5kaW5nX29ic2VydmVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxNQUFNLEVBQUUsTUFBTSxVQUFVLENBQUE7QUFDakMsT0FBTyxFQUFFLE9BQU8sRUFBRSxNQUFNLFdBQVcsQ0FBQTtBQUluQyxPQUFPLEVBQVMsaUJBQWlCLEVBQTZCLE1BQU0sOEJBQThCLENBQUE7QUFPbEc7SUFNRSx5QkFBWSxPQUFnQixFQUFFLFFBQWlDO1FBQzdELElBQUksQ0FBQyxPQUFPLEdBQUcsT0FBTyxDQUFBO1FBQ3RCLElBQUksQ0FBQyxRQUFRLEdBQUcsUUFBUSxDQUFBO1FBQ3hCLElBQUksQ0FBQyxnQkFBZ0IsR0FBRyxJQUFJLEdBQUcsQ0FBQTtJQUNqQyxDQUFDO0lBRUQsK0JBQUssR0FBTDtRQUNFLElBQUksQ0FBQyxJQUFJLENBQUMsaUJBQWlCLEVBQUU7WUFDM0IsSUFBSSxDQUFDLGlCQUFpQixHQUFHLElBQUksaUJBQWlCLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxJQUFJLENBQUMsZUFBZSxFQUFFLElBQUksQ0FBQyxDQUFBO1lBQ3hGLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxLQUFLLEVBQUUsQ0FBQTtTQUMvQjtJQUNILENBQUM7SUFFRCw4QkFBSSxHQUFKO1FBQ0UsSUFBSSxJQUFJLENBQUMsaUJBQWlCLEVBQUU7WUFDMUIsSUFBSSxDQUFDLGlCQUFpQixDQUFDLElBQUksRUFBRSxDQUFBO1lBQzdCLE9BQU8sSUFBSSxDQUFDLGlCQUFpQixDQUFBO1lBQzdCLElBQUksQ0FBQyxvQkFBb0IsRUFBRSxDQUFBO1NBQzVCO0lBQ0gsQ0FBQztJQUVELHNCQUFJLG9DQUFPO2FBQVg7WUFDRSxPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFBO1FBQzdCLENBQUM7OztPQUFBO0lBRUQsc0JBQUksdUNBQVU7YUFBZDtZQUNFLE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQyxVQUFVLENBQUE7UUFDaEMsQ0FBQzs7O09BQUE7SUFFRCxzQkFBSSw0Q0FBZTthQUFuQjtZQUNFLE9BQU8sSUFBSSxDQUFDLE1BQU0sQ0FBQyxlQUFlLENBQUE7UUFDcEMsQ0FBQzs7O09BQUE7SUFFRCxzQkFBSSxtQ0FBTTthQUFWO1lBQ0UsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQTtRQUM1QixDQUFDOzs7T0FBQTtJQUVELHNCQUFJLHFDQUFRO2FBQVo7WUFDRSxPQUFPLEtBQUssQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLGdCQUFnQixDQUFDLE1BQU0sRUFBRSxDQUFDLENBQUE7UUFDbkQsQ0FBQzs7O09BQUE7SUFFTyx1Q0FBYSxHQUFyQixVQUFzQixNQUFjO1FBQ2xDLElBQU0sT0FBTyxHQUFHLElBQUksT0FBTyxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsTUFBTSxDQUFDLENBQUE7UUFDakQsSUFBSSxDQUFDLGdCQUFnQixDQUFDLEdBQUcsQ0FBQyxNQUFNLEVBQUUsT0FBTyxDQUFDLENBQUE7UUFDMUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxnQkFBZ0IsQ0FBQyxPQUFPLENBQUMsQ0FBQTtJQUN6QyxDQUFDO0lBRU8sMENBQWdCLEdBQXhCLFVBQXlCLE1BQWM7UUFDckMsSUFBTSxPQUFPLEdBQUcsSUFBSSxDQUFDLGdCQUFnQixDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsQ0FBQTtRQUNqRCxJQUFJLE9BQU8sRUFBRTtZQUNYLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUE7WUFDcEMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxtQkFBbUIsQ0FBQyxPQUFPLENBQUMsQ0FBQTtTQUMzQztJQUNILENBQUM7SUFFTyw4Q0FBb0IsR0FBNUI7UUFBQSxpQkFHQztRQUZDLElBQUksQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLFVBQUEsT0FBTyxJQUFJLE9BQUEsS0FBSSxDQUFDLFFBQVEsQ0FBQyxtQkFBbUIsQ0FBQyxPQUFPLENBQUMsRUFBMUMsQ0FBMEMsQ0FBQyxDQUFBO1FBQzVFLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxLQUFLLEVBQUUsQ0FBQTtJQUMvQixDQUFDO0lBRUQsMEJBQTBCO0lBRTFCLDRDQUFrQixHQUFsQixVQUFtQixLQUFZO1FBQzdCLElBQU0sTUFBTSxHQUFHLE1BQU0sQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLENBQUE7UUFDckMsSUFBSSxNQUFNLENBQUMsVUFBVSxJQUFJLElBQUksQ0FBQyxVQUFVLEVBQUU7WUFDeEMsT0FBTyxNQUFNLENBQUE7U0FDZDtJQUNILENBQUM7SUFFRCw2Q0FBbUIsR0FBbkIsVUFBb0IsT0FBZ0IsRUFBRSxNQUFjO1FBQ2xELElBQUksQ0FBQyxhQUFhLENBQUMsTUFBTSxDQUFDLENBQUE7SUFDNUIsQ0FBQztJQUVELCtDQUFxQixHQUFyQixVQUFzQixPQUFnQixFQUFFLE1BQWM7UUFDcEQsSUFBSSxDQUFDLGdCQUFnQixDQUFDLE1BQU0sQ0FBQyxDQUFBO0lBQy9CLENBQUM7SUFDSCxzQkFBQztBQUFELENBQUMsQUFsRkQsSUFrRkMifQ==","import { BindingObserver } from \"./binding_observer\";\nvar Context = /** @class */ (function () {\n    function Context(module, scope) {\n        this.module = module;\n        this.scope = scope;\n        this.controller = new module.controllerConstructor(this);\n        this.bindingObserver = new BindingObserver(this, this.dispatcher);\n        try {\n            this.controller.initialize();\n        }\n        catch (error) {\n            this.handleError(error, \"initializing controller\");\n        }\n    }\n    Context.prototype.connect = function () {\n        this.bindingObserver.start();\n        try {\n            this.controller.connect();\n        }\n        catch (error) {\n            this.handleError(error, \"connecting controller\");\n        }\n    };\n    Context.prototype.disconnect = function () {\n        try {\n            this.controller.disconnect();\n        }\n        catch (error) {\n            this.handleError(error, \"disconnecting controller\");\n        }\n        this.bindingObserver.stop();\n    };\n    Object.defineProperty(Context.prototype, \"application\", {\n        get: function () {\n            return this.module.application;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Context.prototype, \"identifier\", {\n        get: function () {\n            return this.module.identifier;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Context.prototype, \"schema\", {\n        get: function () {\n            return this.application.schema;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Context.prototype, \"dispatcher\", {\n        get: function () {\n            return this.application.dispatcher;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Context.prototype, \"element\", {\n        get: function () {\n            return this.scope.element;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Context.prototype, \"parentElement\", {\n        get: function () {\n            return this.element.parentElement;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    // Error handling\n    Context.prototype.handleError = function (error, message, detail) {\n        if (detail === void 0) { detail = {}; }\n        var _a = this, identifier = _a.identifier, controller = _a.controller, element = _a.element;\n        detail = Object.assign({ identifier: identifier, controller: controller, element: element }, detail);\n        this.application.handleError(error, \"Error \" + message, detail);\n    };\n    return Context;\n}());\nexport { Context };\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29udGV4dC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9jb250ZXh0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNBLE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxvQkFBb0IsQ0FBQTtBQVFwRDtJQU1FLGlCQUFZLE1BQWMsRUFBRSxLQUFZO1FBQ3RDLElBQUksQ0FBQyxNQUFNLEdBQUcsTUFBTSxDQUFBO1FBQ3BCLElBQUksQ0FBQyxLQUFLLEdBQUcsS0FBSyxDQUFBO1FBQ2xCLElBQUksQ0FBQyxVQUFVLEdBQUcsSUFBSSxNQUFNLENBQUMscUJBQXFCLENBQUMsSUFBSSxDQUFDLENBQUE7UUFDeEQsSUFBSSxDQUFDLGVBQWUsR0FBRyxJQUFJLGVBQWUsQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFBO1FBRWpFLElBQUk7WUFDRixJQUFJLENBQUMsVUFBVSxDQUFDLFVBQVUsRUFBRSxDQUFBO1NBQzdCO1FBQUMsT0FBTyxLQUFLLEVBQUU7WUFDZCxJQUFJLENBQUMsV0FBVyxDQUFDLEtBQUssRUFBRSx5QkFBeUIsQ0FBQyxDQUFBO1NBQ25EO0lBQ0gsQ0FBQztJQUVELHlCQUFPLEdBQVA7UUFDRSxJQUFJLENBQUMsZUFBZSxDQUFDLEtBQUssRUFBRSxDQUFBO1FBRTVCLElBQUk7WUFDRixJQUFJLENBQUMsVUFBVSxDQUFDLE9BQU8sRUFBRSxDQUFBO1NBQzFCO1FBQUMsT0FBTyxLQUFLLEVBQUU7WUFDZCxJQUFJLENBQUMsV0FBVyxDQUFDLEtBQUssRUFBRSx1QkFBdUIsQ0FBQyxDQUFBO1NBQ2pEO0lBQ0gsQ0FBQztJQUVELDRCQUFVLEdBQVY7UUFDRSxJQUFJO1lBQ0YsSUFBSSxDQUFDLFVBQVUsQ0FBQyxVQUFVLEVBQUUsQ0FBQTtTQUM3QjtRQUFDLE9BQU8sS0FBSyxFQUFFO1lBQ2QsSUFBSSxDQUFDLFdBQVcsQ0FBQyxLQUFLLEVBQUUsMEJBQTBCLENBQUMsQ0FBQTtTQUNwRDtRQUVELElBQUksQ0FBQyxlQUFlLENBQUMsSUFBSSxFQUFFLENBQUE7SUFDN0IsQ0FBQztJQUVELHNCQUFJLGdDQUFXO2FBQWY7WUFDRSxPQUFPLElBQUksQ0FBQyxNQUFNLENBQUMsV0FBVyxDQUFBO1FBQ2hDLENBQUM7OztPQUFBO0lBRUQsc0JBQUksK0JBQVU7YUFBZDtZQUNFLE9BQU8sSUFBSSxDQUFDLE1BQU0sQ0FBQyxVQUFVLENBQUE7UUFDL0IsQ0FBQzs7O09BQUE7SUFFRCxzQkFBSSwyQkFBTTthQUFWO1lBQ0UsT0FBTyxJQUFJLENBQUMsV0FBVyxDQUFDLE1BQU0sQ0FBQTtRQUNoQyxDQUFDOzs7T0FBQTtJQUVELHNCQUFJLCtCQUFVO2FBQWQ7WUFDRSxPQUFPLElBQUksQ0FBQyxXQUFXLENBQUMsVUFBVSxDQUFBO1FBQ3BDLENBQUM7OztPQUFBO0lBRUQsc0JBQUksNEJBQU87YUFBWDtZQUNFLE9BQU8sSUFBSSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUE7UUFDM0IsQ0FBQzs7O09BQUE7SUFFRCxzQkFBSSxrQ0FBYTthQUFqQjtZQUNFLE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQyxhQUFhLENBQUE7UUFDbkMsQ0FBQzs7O09BQUE7SUFFRCxpQkFBaUI7SUFFakIsNkJBQVcsR0FBWCxVQUFZLEtBQVksRUFBRSxPQUFlLEVBQUUsTUFBbUI7UUFBbkIsdUJBQUEsRUFBQSxXQUFtQjtRQUN0RCxJQUFBLFNBQTBDLEVBQXhDLDBCQUFVLEVBQUUsMEJBQVUsRUFBRSxvQkFBTyxDQUFTO1FBQ2hELE1BQU0sR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDLEVBQUUsVUFBVSxZQUFBLEVBQUUsVUFBVSxZQUFBLEVBQUUsT0FBTyxTQUFBLEVBQUUsRUFBRSxNQUFNLENBQUMsQ0FBQTtRQUNuRSxJQUFJLENBQUMsV0FBVyxDQUFDLFdBQVcsQ0FBQyxLQUFLLEVBQUUsV0FBUyxPQUFTLEVBQUUsTUFBTSxDQUFDLENBQUE7SUFDakUsQ0FBQztJQUNILGNBQUM7QUFBRCxDQUFDLEFBdEVELElBc0VDIn0=","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n/** @hidden */\nexport function blessDefinition(definition) {\n    return {\n        identifier: definition.identifier,\n        controllerConstructor: blessControllerConstructor(definition.controllerConstructor)\n    };\n}\nfunction blessControllerConstructor(controllerConstructor) {\n    var constructor = extend(controllerConstructor);\n    constructor.bless();\n    return constructor;\n}\nvar extend = (function () {\n    function extendWithReflect(constructor) {\n        function Controller() {\n            var _newTarget = this && this instanceof Controller ? this.constructor : void 0;\n            return Reflect.construct(constructor, arguments, _newTarget);\n        }\n        Controller.prototype = Object.create(constructor.prototype, {\n            constructor: { value: Controller }\n        });\n        Reflect.setPrototypeOf(Controller, constructor);\n        return Controller;\n    }\n    function testReflectExtension() {\n        var a = function () { this.a.call(this); };\n        var b = extendWithReflect(a);\n        b.prototype.a = function () { };\n        return new b;\n    }\n    try {\n        testReflectExtension();\n        return extendWithReflect;\n    }\n    catch (error) {\n        return function (constructor) { return /** @class */ (function (_super) {\n            __extends(Controller, _super);\n            function Controller() {\n                return _super !== null && _super.apply(this, arguments) || this;\n            }\n            return Controller;\n        }(constructor)); };\n    }\n})();\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGVmaW5pdGlvbi5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9kZWZpbml0aW9uLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFPQSxjQUFjO0FBQ2QsTUFBTSwwQkFBMEIsVUFBc0I7SUFDcEQsT0FBTztRQUNMLFVBQVUsRUFBRSxVQUFVLENBQUMsVUFBVTtRQUNqQyxxQkFBcUIsRUFBRSwwQkFBMEIsQ0FBQyxVQUFVLENBQUMscUJBQXFCLENBQUM7S0FDcEYsQ0FBQTtBQUNILENBQUM7QUFFRCxvQ0FBb0MscUJBQTRDO0lBQzlFLElBQU0sV0FBVyxHQUFHLE1BQU0sQ0FBQyxxQkFBcUIsQ0FBQyxDQUFBO0lBQ2pELFdBQVcsQ0FBQyxLQUFLLEVBQUUsQ0FBQTtJQUNuQixPQUFPLFdBQVcsQ0FBQTtBQUNwQixDQUFDO0FBRUQsSUFBTSxNQUFNLEdBQUcsQ0FBQztJQUdkLDJCQUFzRCxXQUFjO1FBQ2xFOztZQUNFLE9BQU8sT0FBTyxDQUFDLFNBQVMsQ0FBQyxXQUFXLEVBQUUsU0FBUyxhQUFhLENBQUE7UUFDOUQsQ0FBQztRQUVELFVBQVUsQ0FBQyxTQUFTLEdBQUcsTUFBTSxDQUFDLE1BQU0sQ0FBQyxXQUFXLENBQUMsU0FBUyxFQUFFO1lBQzFELFdBQVcsRUFBRSxFQUFFLEtBQUssRUFBRSxVQUFVLEVBQUU7U0FDbkMsQ0FBQyxDQUFBO1FBRUYsT0FBTyxDQUFDLGNBQWMsQ0FBQyxVQUFVLEVBQUUsV0FBVyxDQUFDLENBQUE7UUFDL0MsT0FBTyxVQUFpQixDQUFBO0lBQzFCLENBQUM7SUFFRDtRQUNFLElBQU0sQ0FBQyxHQUFHLGNBQXNCLElBQUksQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFBLENBQUMsQ0FBUSxDQUFBO1FBQzFELElBQU0sQ0FBQyxHQUFHLGlCQUFpQixDQUFDLENBQUMsQ0FBQyxDQUFBO1FBQzlCLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxHQUFHLGNBQVksQ0FBQyxDQUFBO1FBQzdCLE9BQU8sSUFBSSxDQUFDLENBQUE7SUFDZCxDQUFDO0lBRUQsSUFBSTtRQUNGLG9CQUFvQixFQUFFLENBQUE7UUFDdEIsT0FBTyxpQkFBaUIsQ0FBQTtLQUN6QjtJQUFDLE9BQU8sS0FBSyxFQUFFO1FBQ2QsT0FBTyxVQUE0QixXQUFjLElBQUs7WUFBeUIsOEJBQVc7WUFBcEM7O1lBQXNDLENBQUM7WUFBRCxpQkFBQztRQUFELENBQUMsQUFBdkMsQ0FBeUIsV0FBVyxJQUFwQyxDQUF1QyxDQUFBO0tBQzlGO0FBQ0gsQ0FBQyxDQUFDLEVBQUUsQ0FBQSJ9","import { Context } from \"./context\";\nimport { blessDefinition } from \"./definition\";\nvar Module = /** @class */ (function () {\n    function Module(application, definition) {\n        this.application = application;\n        this.definition = blessDefinition(definition);\n        this.contextsByScope = new WeakMap;\n        this.connectedContexts = new Set;\n    }\n    Object.defineProperty(Module.prototype, \"identifier\", {\n        get: function () {\n            return this.definition.identifier;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Module.prototype, \"controllerConstructor\", {\n        get: function () {\n            return this.definition.controllerConstructor;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Module.prototype, \"contexts\", {\n        get: function () {\n            return Array.from(this.connectedContexts);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Module.prototype.connectContextForScope = function (scope) {\n        var context = this.fetchContextForScope(scope);\n        this.connectedContexts.add(context);\n        context.connect();\n    };\n    Module.prototype.disconnectContextForScope = function (scope) {\n        var context = this.contextsByScope.get(scope);\n        if (context) {\n            this.connectedContexts.delete(context);\n            context.disconnect();\n        }\n    };\n    Module.prototype.fetchContextForScope = function (scope) {\n        var context = this.contextsByScope.get(scope);\n        if (!context) {\n            context = new Context(this, scope);\n            this.contextsByScope.set(scope, context);\n        }\n        return context;\n    };\n    return Module;\n}());\nexport { Module };\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibW9kdWxlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL21vZHVsZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFDQSxPQUFPLEVBQUUsT0FBTyxFQUFFLE1BQU0sV0FBVyxDQUFBO0FBRW5DLE9BQU8sRUFBYyxlQUFlLEVBQUUsTUFBTSxjQUFjLENBQUE7QUFHMUQ7SUFNRSxnQkFBWSxXQUF3QixFQUFFLFVBQXNCO1FBQzFELElBQUksQ0FBQyxXQUFXLEdBQUcsV0FBVyxDQUFBO1FBQzlCLElBQUksQ0FBQyxVQUFVLEdBQUcsZUFBZSxDQUFDLFVBQVUsQ0FBQyxDQUFBO1FBQzdDLElBQUksQ0FBQyxlQUFlLEdBQUcsSUFBSSxPQUFPLENBQUE7UUFDbEMsSUFBSSxDQUFDLGlCQUFpQixHQUFHLElBQUksR0FBRyxDQUFBO0lBQ2xDLENBQUM7SUFFRCxzQkFBSSw4QkFBVTthQUFkO1lBQ0UsT0FBTyxJQUFJLENBQUMsVUFBVSxDQUFDLFVBQVUsQ0FBQTtRQUNuQyxDQUFDOzs7T0FBQTtJQUVELHNCQUFJLHlDQUFxQjthQUF6QjtZQUNFLE9BQU8sSUFBSSxDQUFDLFVBQVUsQ0FBQyxxQkFBcUIsQ0FBQTtRQUM5QyxDQUFDOzs7T0FBQTtJQUVELHNCQUFJLDRCQUFRO2FBQVo7WUFDRSxPQUFPLEtBQUssQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLGlCQUFpQixDQUFDLENBQUE7UUFDM0MsQ0FBQzs7O09BQUE7SUFFRCx1Q0FBc0IsR0FBdEIsVUFBdUIsS0FBWTtRQUNqQyxJQUFNLE9BQU8sR0FBRyxJQUFJLENBQUMsb0JBQW9CLENBQUMsS0FBSyxDQUFDLENBQUE7UUFDaEQsSUFBSSxDQUFDLGlCQUFpQixDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsQ0FBQTtRQUNuQyxPQUFPLENBQUMsT0FBTyxFQUFFLENBQUE7SUFDbkIsQ0FBQztJQUVELDBDQUF5QixHQUF6QixVQUEwQixLQUFZO1FBQ3BDLElBQU0sT0FBTyxHQUFHLElBQUksQ0FBQyxlQUFlLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFBO1FBQy9DLElBQUksT0FBTyxFQUFFO1lBQ1gsSUFBSSxDQUFDLGlCQUFpQixDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQTtZQUN0QyxPQUFPLENBQUMsVUFBVSxFQUFFLENBQUE7U0FDckI7SUFDSCxDQUFDO0lBRU8scUNBQW9CLEdBQTVCLFVBQTZCLEtBQVk7UUFDdkMsSUFBSSxPQUFPLEdBQUcsSUFBSSxDQUFDLGVBQWUsQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUE7UUFDN0MsSUFBSSxDQUFDLE9BQU8sRUFBRTtZQUNaLE9BQU8sR0FBRyxJQUFJLE9BQU8sQ0FBQyxJQUFJLEVBQUUsS0FBSyxDQUFDLENBQUE7WUFDbEMsSUFBSSxDQUFDLGVBQWUsQ0FBQyxHQUFHLENBQUMsS0FBSyxFQUFFLE9BQU8sQ0FBQyxDQUFBO1NBQ3pDO1FBQ0QsT0FBTyxPQUFPLENBQUE7SUFDaEIsQ0FBQztJQUNILGFBQUM7QUFBRCxDQUFDLEFBL0NELElBK0NDIn0=","var DataMap = /** @class */ (function () {\n    function DataMap(scope) {\n        this.scope = scope;\n    }\n    Object.defineProperty(DataMap.prototype, \"element\", {\n        get: function () {\n            return this.scope.element;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DataMap.prototype, \"identifier\", {\n        get: function () {\n            return this.scope.identifier;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    DataMap.prototype.get = function (key) {\n        key = this.getFormattedKey(key);\n        return this.element.getAttribute(key);\n    };\n    DataMap.prototype.set = function (key, value) {\n        key = this.getFormattedKey(key);\n        this.element.setAttribute(key, value);\n        return this.get(key);\n    };\n    DataMap.prototype.has = function (key) {\n        key = this.getFormattedKey(key);\n        return this.element.hasAttribute(key);\n    };\n    DataMap.prototype.delete = function (key) {\n        if (this.has(key)) {\n            key = this.getFormattedKey(key);\n            this.element.removeAttribute(key);\n            return true;\n        }\n        else {\n            return false;\n        }\n    };\n    DataMap.prototype.getFormattedKey = function (key) {\n        return \"data-\" + this.identifier + \"-\" + dasherize(key);\n    };\n    return DataMap;\n}());\nexport { DataMap };\nfunction dasherize(value) {\n    return value.replace(/([A-Z])/g, function (_, char) { return \"-\" + char.toLowerCase(); });\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGF0YV9tYXAuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvZGF0YV9tYXAudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBRUE7SUFHRSxpQkFBWSxLQUFZO1FBQ3RCLElBQUksQ0FBQyxLQUFLLEdBQUcsS0FBSyxDQUFBO0lBQ3BCLENBQUM7SUFFRCxzQkFBSSw0QkFBTzthQUFYO1lBQ0UsT0FBTyxJQUFJLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQTtRQUMzQixDQUFDOzs7T0FBQTtJQUVELHNCQUFJLCtCQUFVO2FBQWQ7WUFDRSxPQUFPLElBQUksQ0FBQyxLQUFLLENBQUMsVUFBVSxDQUFBO1FBQzlCLENBQUM7OztPQUFBO0lBRUQscUJBQUcsR0FBSCxVQUFJLEdBQVc7UUFDYixHQUFHLEdBQUcsSUFBSSxDQUFDLGVBQWUsQ0FBQyxHQUFHLENBQUMsQ0FBQTtRQUMvQixPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsWUFBWSxDQUFDLEdBQUcsQ0FBQyxDQUFBO0lBQ3ZDLENBQUM7SUFFRCxxQkFBRyxHQUFILFVBQUksR0FBVyxFQUFFLEtBQWE7UUFDNUIsR0FBRyxHQUFHLElBQUksQ0FBQyxlQUFlLENBQUMsR0FBRyxDQUFDLENBQUE7UUFDL0IsSUFBSSxDQUFDLE9BQU8sQ0FBQyxZQUFZLENBQUMsR0FBRyxFQUFFLEtBQUssQ0FBQyxDQUFBO1FBQ3JDLE9BQU8sSUFBSSxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQTtJQUN0QixDQUFDO0lBRUQscUJBQUcsR0FBSCxVQUFJLEdBQVc7UUFDYixHQUFHLEdBQUcsSUFBSSxDQUFDLGVBQWUsQ0FBQyxHQUFHLENBQUMsQ0FBQTtRQUMvQixPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsWUFBWSxDQUFDLEdBQUcsQ0FBQyxDQUFBO0lBQ3ZDLENBQUM7SUFFRCx3QkFBTSxHQUFOLFVBQU8sR0FBVztRQUNoQixJQUFJLElBQUksQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLEVBQUU7WUFDakIsR0FBRyxHQUFHLElBQUksQ0FBQyxlQUFlLENBQUMsR0FBRyxDQUFDLENBQUE7WUFDL0IsSUFBSSxDQUFDLE9BQU8sQ0FBQyxlQUFlLENBQUMsR0FBRyxDQUFDLENBQUE7WUFDakMsT0FBTyxJQUFJLENBQUE7U0FDWjthQUFNO1lBQ0wsT0FBTyxLQUFLLENBQUE7U0FDYjtJQUNILENBQUM7SUFFTyxpQ0FBZSxHQUF2QixVQUF3QixHQUFXO1FBQ2pDLE9BQU8sVUFBUSxJQUFJLENBQUMsVUFBVSxTQUFJLFNBQVMsQ0FBQyxHQUFHLENBQUcsQ0FBQTtJQUNwRCxDQUFDO0lBQ0gsY0FBQztBQUFELENBQUMsQUE1Q0QsSUE0Q0M7O0FBRUQsbUJBQW1CLEtBQWE7SUFDOUIsT0FBTyxLQUFLLENBQUMsT0FBTyxDQUFDLFVBQVUsRUFBRSxVQUFDLENBQUMsRUFBRSxJQUFJLElBQUssT0FBQSxNQUFJLElBQUksQ0FBQyxXQUFXLEVBQUksRUFBeEIsQ0FBd0IsQ0FBQyxDQUFBO0FBQ3pFLENBQUMifQ==","/** @hidden */\nexport function attributeValueContainsToken(attributeName, token) {\n    return \"[\" + attributeName + \"~=\\\"\" + token + \"\\\"]\";\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2VsZWN0b3JzLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL3NlbGVjdG9ycy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxjQUFjO0FBQ2QsTUFBTSxzQ0FBc0MsYUFBcUIsRUFBRSxLQUFhO0lBQzlFLE9BQU8sTUFBSSxhQUFhLFlBQU0sS0FBSyxRQUFJLENBQUE7QUFDekMsQ0FBQyJ9","import { attributeValueContainsToken } from \"./selectors\";\nvar TargetSet = /** @class */ (function () {\n    function TargetSet(scope) {\n        this.scope = scope;\n    }\n    Object.defineProperty(TargetSet.prototype, \"element\", {\n        get: function () {\n            return this.scope.element;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TargetSet.prototype, \"identifier\", {\n        get: function () {\n            return this.scope.identifier;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TargetSet.prototype, \"schema\", {\n        get: function () {\n            return this.scope.schema;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    TargetSet.prototype.has = function (targetName) {\n        return this.find(targetName) != null;\n    };\n    TargetSet.prototype.find = function () {\n        var targetNames = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            targetNames[_i] = arguments[_i];\n        }\n        var selector = this.getSelectorForTargetNames(targetNames);\n        return this.scope.findElement(selector);\n    };\n    TargetSet.prototype.findAll = function () {\n        var targetNames = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            targetNames[_i] = arguments[_i];\n        }\n        var selector = this.getSelectorForTargetNames(targetNames);\n        return this.scope.findAllElements(selector);\n    };\n    TargetSet.prototype.getSelectorForTargetNames = function (targetNames) {\n        var _this = this;\n        return targetNames.map(function (targetName) { return _this.getSelectorForTargetName(targetName); }).join(\", \");\n    };\n    TargetSet.prototype.getSelectorForTargetName = function (targetName) {\n        var targetDescriptor = this.identifier + \".\" + targetName;\n        return attributeValueContainsToken(this.schema.targetAttribute, targetDescriptor);\n    };\n    return TargetSet;\n}());\nexport { TargetSet };\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGFyZ2V0X3NldC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy90YXJnZXRfc2V0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUVBLE9BQU8sRUFBRSwyQkFBMkIsRUFBRSxNQUFNLGFBQWEsQ0FBQTtBQUV6RDtJQUdFLG1CQUFZLEtBQVk7UUFDdEIsSUFBSSxDQUFDLEtBQUssR0FBRyxLQUFLLENBQUE7SUFDcEIsQ0FBQztJQUVELHNCQUFJLDhCQUFPO2FBQVg7WUFDRSxPQUFPLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFBO1FBQzNCLENBQUM7OztPQUFBO0lBRUQsc0JBQUksaUNBQVU7YUFBZDtZQUNFLE9BQU8sSUFBSSxDQUFDLEtBQUssQ0FBQyxVQUFVLENBQUE7UUFDOUIsQ0FBQzs7O09BQUE7SUFFRCxzQkFBSSw2QkFBTTthQUFWO1lBQ0UsT0FBTyxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQTtRQUMxQixDQUFDOzs7T0FBQTtJQUVELHVCQUFHLEdBQUgsVUFBSSxVQUFrQjtRQUNwQixPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLElBQUksSUFBSSxDQUFBO0lBQ3RDLENBQUM7SUFFRCx3QkFBSSxHQUFKO1FBQUsscUJBQXdCO2FBQXhCLFVBQXdCLEVBQXhCLHFCQUF3QixFQUF4QixJQUF3QjtZQUF4QixnQ0FBd0I7O1FBQzNCLElBQU0sUUFBUSxHQUFHLElBQUksQ0FBQyx5QkFBeUIsQ0FBQyxXQUFXLENBQUMsQ0FBQTtRQUM1RCxPQUFPLElBQUksQ0FBQyxLQUFLLENBQUMsV0FBVyxDQUFDLFFBQVEsQ0FBQyxDQUFBO0lBQ3pDLENBQUM7SUFFRCwyQkFBTyxHQUFQO1FBQVEscUJBQXdCO2FBQXhCLFVBQXdCLEVBQXhCLHFCQUF3QixFQUF4QixJQUF3QjtZQUF4QixnQ0FBd0I7O1FBQzlCLElBQU0sUUFBUSxHQUFHLElBQUksQ0FBQyx5QkFBeUIsQ0FBQyxXQUFXLENBQUMsQ0FBQTtRQUM1RCxPQUFPLElBQUksQ0FBQyxLQUFLLENBQUMsZUFBZSxDQUFDLFFBQVEsQ0FBQyxDQUFBO0lBQzdDLENBQUM7SUFFTyw2Q0FBeUIsR0FBakMsVUFBa0MsV0FBcUI7UUFBdkQsaUJBRUM7UUFEQyxPQUFPLFdBQVcsQ0FBQyxHQUFHLENBQUMsVUFBQSxVQUFVLElBQUksT0FBQSxLQUFJLENBQUMsd0JBQXdCLENBQUMsVUFBVSxDQUFDLEVBQXpDLENBQXlDLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUE7SUFDNUYsQ0FBQztJQUVPLDRDQUF3QixHQUFoQyxVQUFpQyxVQUFrQjtRQUNqRCxJQUFNLGdCQUFnQixHQUFNLElBQUksQ0FBQyxVQUFVLFNBQUksVUFBWSxDQUFBO1FBQzNELE9BQU8sMkJBQTJCLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxlQUFlLEVBQUUsZ0JBQWdCLENBQUMsQ0FBQTtJQUNuRixDQUFDO0lBQ0gsZ0JBQUM7QUFBRCxDQUFDLEFBekNELElBeUNDIn0=","import { DataMap } from \"./data_map\";\nimport { TargetSet } from \"./target_set\";\nimport { attributeValueContainsToken } from \"./selectors\";\nvar Scope = /** @class */ (function () {\n    function Scope(schema, identifier, element) {\n        this.schema = schema;\n        this.identifier = identifier;\n        this.element = element;\n        this.targets = new TargetSet(this);\n        this.data = new DataMap(this);\n    }\n    Scope.prototype.findElement = function (selector) {\n        return this.findAllElements(selector)[0];\n    };\n    Scope.prototype.findAllElements = function (selector) {\n        var head = this.element.matches(selector) ? [this.element] : [];\n        var tail = this.filterElements(Array.from(this.element.querySelectorAll(selector)));\n        return head.concat(tail);\n    };\n    Scope.prototype.filterElements = function (elements) {\n        var _this = this;\n        return elements.filter(function (element) { return _this.containsElement(element); });\n    };\n    Scope.prototype.containsElement = function (element) {\n        return element.closest(this.controllerSelector) === this.element;\n    };\n    Object.defineProperty(Scope.prototype, \"controllerSelector\", {\n        get: function () {\n            return attributeValueContainsToken(this.schema.controllerAttribute, this.identifier);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return Scope;\n}());\nexport { Scope };\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2NvcGUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvc2NvcGUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLE9BQU8sRUFBRSxNQUFNLFlBQVksQ0FBQTtBQUVwQyxPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sY0FBYyxDQUFBO0FBQ3hDLE9BQU8sRUFBRSwyQkFBMkIsRUFBRSxNQUFNLGFBQWEsQ0FBQTtBQUV6RDtJQU9FLGVBQVksTUFBYyxFQUFFLFVBQWtCLEVBQUUsT0FBZ0I7UUFDOUQsSUFBSSxDQUFDLE1BQU0sR0FBRyxNQUFNLENBQUE7UUFDcEIsSUFBSSxDQUFDLFVBQVUsR0FBRyxVQUFVLENBQUE7UUFDNUIsSUFBSSxDQUFDLE9BQU8sR0FBRyxPQUFPLENBQUE7UUFDdEIsSUFBSSxDQUFDLE9BQU8sR0FBRyxJQUFJLFNBQVMsQ0FBQyxJQUFJLENBQUMsQ0FBQTtRQUNsQyxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFBO0lBQy9CLENBQUM7SUFFRCwyQkFBVyxHQUFYLFVBQVksUUFBZ0I7UUFDMUIsT0FBTyxJQUFJLENBQUMsZUFBZSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFBO0lBQzFDLENBQUM7SUFFRCwrQkFBZSxHQUFmLFVBQWdCLFFBQWdCO1FBQzlCLElBQU0sSUFBSSxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFBO1FBQ2pFLElBQU0sSUFBSSxHQUFHLElBQUksQ0FBQyxjQUFjLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLGdCQUFnQixDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQTtRQUNyRixPQUFPLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUE7SUFDMUIsQ0FBQztJQUVELDhCQUFjLEdBQWQsVUFBZSxRQUFtQjtRQUFsQyxpQkFFQztRQURDLE9BQU8sUUFBUSxDQUFDLE1BQU0sQ0FBQyxVQUFBLE9BQU8sSUFBSSxPQUFBLEtBQUksQ0FBQyxlQUFlLENBQUMsT0FBTyxDQUFDLEVBQTdCLENBQTZCLENBQUMsQ0FBQTtJQUNsRSxDQUFDO0lBRUQsK0JBQWUsR0FBZixVQUFnQixPQUFnQjtRQUM5QixPQUFPLE9BQU8sQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLGtCQUFrQixDQUFDLEtBQUssSUFBSSxDQUFDLE9BQU8sQ0FBQTtJQUNsRSxDQUFDO0lBRUQsc0JBQVkscUNBQWtCO2FBQTlCO1lBQ0UsT0FBTywyQkFBMkIsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLG1CQUFtQixFQUFFLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQTtRQUN0RixDQUFDOzs7T0FBQTtJQUNILFlBQUM7QUFBRCxDQUFDLEFBcENELElBb0NDIn0=","import { Scope } from \"./scope\";\nimport { ValueListObserver } from \"@stimulus/mutation-observers\";\nvar ScopeObserver = /** @class */ (function () {\n    function ScopeObserver(element, schema, delegate) {\n        this.element = element;\n        this.schema = schema;\n        this.delegate = delegate;\n        this.valueListObserver = new ValueListObserver(this.element, this.controllerAttribute, this);\n        this.scopesByIdentifierByElement = new WeakMap;\n        this.scopeReferenceCounts = new WeakMap;\n    }\n    ScopeObserver.prototype.start = function () {\n        this.valueListObserver.start();\n    };\n    ScopeObserver.prototype.stop = function () {\n        this.valueListObserver.stop();\n    };\n    Object.defineProperty(ScopeObserver.prototype, \"controllerAttribute\", {\n        get: function () {\n            return this.schema.controllerAttribute;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    // Value observer delegate\n    /** @hidden */\n    ScopeObserver.prototype.parseValueForToken = function (token) {\n        var element = token.element, identifier = token.content;\n        var scopesByIdentifier = this.fetchScopesByIdentifierForElement(element);\n        var scope = scopesByIdentifier.get(identifier);\n        if (!scope) {\n            scope = new Scope(this.schema, identifier, element);\n            scopesByIdentifier.set(identifier, scope);\n        }\n        return scope;\n    };\n    /** @hidden */\n    ScopeObserver.prototype.elementMatchedValue = function (element, value) {\n        var referenceCount = (this.scopeReferenceCounts.get(value) || 0) + 1;\n        this.scopeReferenceCounts.set(value, referenceCount);\n        if (referenceCount == 1) {\n            this.delegate.scopeConnected(value);\n        }\n    };\n    /** @hidden */\n    ScopeObserver.prototype.elementUnmatchedValue = function (element, value) {\n        var referenceCount = this.scopeReferenceCounts.get(value);\n        if (referenceCount) {\n            this.scopeReferenceCounts.set(value, referenceCount - 1);\n            if (referenceCount == 1) {\n                this.delegate.scopeDisconnected(value);\n            }\n        }\n    };\n    ScopeObserver.prototype.fetchScopesByIdentifierForElement = function (element) {\n        var scopesByIdentifier = this.scopesByIdentifierByElement.get(element);\n        if (!scopesByIdentifier) {\n            scopesByIdentifier = new Map;\n            this.scopesByIdentifierByElement.set(element, scopesByIdentifier);\n        }\n        return scopesByIdentifier;\n    };\n    return ScopeObserver;\n}());\nexport { ScopeObserver };\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2NvcGVfb2JzZXJ2ZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvc2NvcGVfb2JzZXJ2ZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBRUEsT0FBTyxFQUFFLEtBQUssRUFBRSxNQUFNLFNBQVMsQ0FBQTtBQUMvQixPQUFPLEVBQVMsaUJBQWlCLEVBQTZCLE1BQU0sOEJBQThCLENBQUE7QUFPbEc7SUFRRSx1QkFBWSxPQUFnQixFQUFFLE1BQWMsRUFBRSxRQUErQjtRQUMzRSxJQUFJLENBQUMsT0FBTyxHQUFHLE9BQU8sQ0FBQTtRQUN0QixJQUFJLENBQUMsTUFBTSxHQUFHLE1BQU0sQ0FBQTtRQUNwQixJQUFJLENBQUMsUUFBUSxHQUFHLFFBQVEsQ0FBQTtRQUN4QixJQUFJLENBQUMsaUJBQWlCLEdBQUcsSUFBSSxpQkFBaUIsQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLElBQUksQ0FBQyxtQkFBbUIsRUFBRSxJQUFJLENBQUMsQ0FBQTtRQUM1RixJQUFJLENBQUMsMkJBQTJCLEdBQUcsSUFBSSxPQUFPLENBQUE7UUFDOUMsSUFBSSxDQUFDLG9CQUFvQixHQUFHLElBQUksT0FBTyxDQUFBO0lBQ3pDLENBQUM7SUFFRCw2QkFBSyxHQUFMO1FBQ0UsSUFBSSxDQUFDLGlCQUFpQixDQUFDLEtBQUssRUFBRSxDQUFBO0lBQ2hDLENBQUM7SUFFRCw0QkFBSSxHQUFKO1FBQ0UsSUFBSSxDQUFDLGlCQUFpQixDQUFDLElBQUksRUFBRSxDQUFBO0lBQy9CLENBQUM7SUFFRCxzQkFBSSw4Q0FBbUI7YUFBdkI7WUFDRSxPQUFPLElBQUksQ0FBQyxNQUFNLENBQUMsbUJBQW1CLENBQUE7UUFDeEMsQ0FBQzs7O09BQUE7SUFFRCwwQkFBMEI7SUFFMUIsY0FBYztJQUNkLDBDQUFrQixHQUFsQixVQUFtQixLQUFZO1FBQ3JCLElBQUEsdUJBQU8sRUFBRSwwQkFBbUIsQ0FBVTtRQUM5QyxJQUFNLGtCQUFrQixHQUFHLElBQUksQ0FBQyxpQ0FBaUMsQ0FBQyxPQUFPLENBQUMsQ0FBQTtRQUUxRSxJQUFJLEtBQUssR0FBRyxrQkFBa0IsQ0FBQyxHQUFHLENBQUMsVUFBVSxDQUFDLENBQUE7UUFDOUMsSUFBSSxDQUFDLEtBQUssRUFBRTtZQUNWLEtBQUssR0FBRyxJQUFJLEtBQUssQ0FBQyxJQUFJLENBQUMsTUFBTSxFQUFFLFVBQVUsRUFBRSxPQUFPLENBQUMsQ0FBQTtZQUNuRCxrQkFBa0IsQ0FBQyxHQUFHLENBQUMsVUFBVSxFQUFFLEtBQUssQ0FBQyxDQUFBO1NBQzFDO1FBRUQsT0FBTyxLQUFLLENBQUE7SUFDZCxDQUFDO0lBRUQsY0FBYztJQUNkLDJDQUFtQixHQUFuQixVQUFvQixPQUFnQixFQUFFLEtBQVk7UUFDaEQsSUFBTSxjQUFjLEdBQUcsQ0FBQyxJQUFJLENBQUMsb0JBQW9CLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQTtRQUN0RSxJQUFJLENBQUMsb0JBQW9CLENBQUMsR0FBRyxDQUFDLEtBQUssRUFBRSxjQUFjLENBQUMsQ0FBQTtRQUNwRCxJQUFJLGNBQWMsSUFBSSxDQUFDLEVBQUU7WUFDdkIsSUFBSSxDQUFDLFFBQVEsQ0FBQyxjQUFjLENBQUMsS0FBSyxDQUFDLENBQUE7U0FDcEM7SUFDSCxDQUFDO0lBRUQsY0FBYztJQUNkLDZDQUFxQixHQUFyQixVQUFzQixPQUFnQixFQUFFLEtBQVk7UUFDbEQsSUFBTSxjQUFjLEdBQUcsSUFBSSxDQUFDLG9CQUFvQixDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQTtRQUMzRCxJQUFJLGNBQWMsRUFBRTtZQUNsQixJQUFJLENBQUMsb0JBQW9CLENBQUMsR0FBRyxDQUFDLEtBQUssRUFBRSxjQUFjLEdBQUcsQ0FBQyxDQUFDLENBQUE7WUFDeEQsSUFBSSxjQUFjLElBQUksQ0FBQyxFQUFFO2dCQUN2QixJQUFJLENBQUMsUUFBUSxDQUFDLGlCQUFpQixDQUFDLEtBQUssQ0FBQyxDQUFBO2FBQ3ZDO1NBQ0Y7SUFDSCxDQUFDO0lBRU8seURBQWlDLEdBQXpDLFVBQTBDLE9BQWdCO1FBQ3hELElBQUksa0JBQWtCLEdBQUcsSUFBSSxDQUFDLDJCQUEyQixDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsQ0FBQTtRQUN0RSxJQUFJLENBQUMsa0JBQWtCLEVBQUU7WUFDdkIsa0JBQWtCLEdBQUcsSUFBSSxHQUFHLENBQUE7WUFDNUIsSUFBSSxDQUFDLDJCQUEyQixDQUFDLEdBQUcsQ0FBQyxPQUFPLEVBQUUsa0JBQWtCLENBQUMsQ0FBQTtTQUNsRTtRQUNELE9BQU8sa0JBQWtCLENBQUE7SUFDM0IsQ0FBQztJQUNILG9CQUFDO0FBQUQsQ0FBQyxBQXpFRCxJQXlFQyJ9","import { Module } from \"./module\";\nimport { Multimap } from \"@stimulus/multimap\";\nimport { ScopeObserver } from \"./scope_observer\";\nvar Router = /** @class */ (function () {\n    function Router(application) {\n        this.application = application;\n        this.scopeObserver = new ScopeObserver(this.element, this.schema, this);\n        this.scopesByIdentifier = new Multimap;\n        this.modulesByIdentifier = new Map;\n    }\n    Object.defineProperty(Router.prototype, \"element\", {\n        get: function () {\n            return this.application.element;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Router.prototype, \"schema\", {\n        get: function () {\n            return this.application.schema;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Router.prototype, \"controllerAttribute\", {\n        get: function () {\n            return this.schema.controllerAttribute;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Router.prototype, \"modules\", {\n        get: function () {\n            return Array.from(this.modulesByIdentifier.values());\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Router.prototype, \"contexts\", {\n        get: function () {\n            return this.modules.reduce(function (contexts, module) { return contexts.concat(module.contexts); }, []);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Router.prototype.start = function () {\n        this.scopeObserver.start();\n    };\n    Router.prototype.stop = function () {\n        this.scopeObserver.stop();\n    };\n    Router.prototype.loadDefinition = function (definition) {\n        this.unloadIdentifier(definition.identifier);\n        var module = new Module(this.application, definition);\n        this.connectModule(module);\n    };\n    Router.prototype.unloadIdentifier = function (identifier) {\n        var module = this.modulesByIdentifier.get(identifier);\n        if (module) {\n            this.disconnectModule(module);\n        }\n    };\n    Router.prototype.getContextForElementAndIdentifier = function (element, identifier) {\n        var module = this.modulesByIdentifier.get(identifier);\n        if (module) {\n            return module.contexts.find(function (context) { return context.element == element; });\n        }\n    };\n    // Error handler delegate\n    /** @hidden */\n    Router.prototype.handleError = function (error, message, detail) {\n        this.application.handleError(error, message, detail);\n    };\n    // Scope observer delegate\n    /** @hidden */\n    Router.prototype.scopeConnected = function (scope) {\n        this.scopesByIdentifier.add(scope.identifier, scope);\n        var module = this.modulesByIdentifier.get(scope.identifier);\n        if (module) {\n            module.connectContextForScope(scope);\n        }\n    };\n    /** @hidden */\n    Router.prototype.scopeDisconnected = function (scope) {\n        this.scopesByIdentifier.delete(scope.identifier, scope);\n        var module = this.modulesByIdentifier.get(scope.identifier);\n        if (module) {\n            module.disconnectContextForScope(scope);\n        }\n    };\n    // Modules\n    Router.prototype.connectModule = function (module) {\n        this.modulesByIdentifier.set(module.identifier, module);\n        var scopes = this.scopesByIdentifier.getValuesForKey(module.identifier);\n        scopes.forEach(function (scope) { return module.connectContextForScope(scope); });\n    };\n    Router.prototype.disconnectModule = function (module) {\n        this.modulesByIdentifier.delete(module.identifier);\n        var scopes = this.scopesByIdentifier.getValuesForKey(module.identifier);\n        scopes.forEach(function (scope) { return module.disconnectContextForScope(scope); });\n    };\n    return Router;\n}());\nexport { Router };\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicm91dGVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL3JvdXRlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFHQSxPQUFPLEVBQUUsTUFBTSxFQUFFLE1BQU0sVUFBVSxDQUFBO0FBQ2pDLE9BQU8sRUFBRSxRQUFRLEVBQUUsTUFBTSxvQkFBb0IsQ0FBQTtBQUc3QyxPQUFPLEVBQUUsYUFBYSxFQUF5QixNQUFNLGtCQUFrQixDQUFBO0FBRXZFO0lBTUUsZ0JBQVksV0FBd0I7UUFDbEMsSUFBSSxDQUFDLFdBQVcsR0FBRyxXQUFXLENBQUE7UUFDOUIsSUFBSSxDQUFDLGFBQWEsR0FBRyxJQUFJLGFBQWEsQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLElBQUksQ0FBQyxNQUFNLEVBQUUsSUFBSSxDQUFDLENBQUE7UUFDdkUsSUFBSSxDQUFDLGtCQUFrQixHQUFHLElBQUksUUFBUSxDQUFBO1FBQ3RDLElBQUksQ0FBQyxtQkFBbUIsR0FBRyxJQUFJLEdBQUcsQ0FBQTtJQUNwQyxDQUFDO0lBRUQsc0JBQUksMkJBQU87YUFBWDtZQUNFLE9BQU8sSUFBSSxDQUFDLFdBQVcsQ0FBQyxPQUFPLENBQUE7UUFDakMsQ0FBQzs7O09BQUE7SUFFRCxzQkFBSSwwQkFBTTthQUFWO1lBQ0UsT0FBTyxJQUFJLENBQUMsV0FBVyxDQUFDLE1BQU0sQ0FBQTtRQUNoQyxDQUFDOzs7T0FBQTtJQUVELHNCQUFJLHVDQUFtQjthQUF2QjtZQUNFLE9BQU8sSUFBSSxDQUFDLE1BQU0sQ0FBQyxtQkFBbUIsQ0FBQTtRQUN4QyxDQUFDOzs7T0FBQTtJQUVELHNCQUFJLDJCQUFPO2FBQVg7WUFDRSxPQUFPLEtBQUssQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLG1CQUFtQixDQUFDLE1BQU0sRUFBRSxDQUFDLENBQUE7UUFDdEQsQ0FBQzs7O09BQUE7SUFFRCxzQkFBSSw0QkFBUTthQUFaO1lBQ0UsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxVQUFDLFFBQVEsRUFBRSxNQUFNLElBQUssT0FBQSxRQUFRLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsRUFBaEMsQ0FBZ0MsRUFBRSxFQUFlLENBQUMsQ0FBQTtRQUNyRyxDQUFDOzs7T0FBQTtJQUVELHNCQUFLLEdBQUw7UUFDRSxJQUFJLENBQUMsYUFBYSxDQUFDLEtBQUssRUFBRSxDQUFBO0lBQzVCLENBQUM7SUFFRCxxQkFBSSxHQUFKO1FBQ0UsSUFBSSxDQUFDLGFBQWEsQ0FBQyxJQUFJLEVBQUUsQ0FBQTtJQUMzQixDQUFDO0lBRUQsK0JBQWMsR0FBZCxVQUFlLFVBQXNCO1FBQ25DLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxVQUFVLENBQUMsVUFBVSxDQUFDLENBQUE7UUFDNUMsSUFBTSxNQUFNLEdBQUcsSUFBSSxNQUFNLENBQUMsSUFBSSxDQUFDLFdBQVcsRUFBRSxVQUFVLENBQUMsQ0FBQTtRQUN2RCxJQUFJLENBQUMsYUFBYSxDQUFDLE1BQU0sQ0FBQyxDQUFBO0lBQzVCLENBQUM7SUFFRCxpQ0FBZ0IsR0FBaEIsVUFBaUIsVUFBa0I7UUFDakMsSUFBTSxNQUFNLEdBQUcsSUFBSSxDQUFDLG1CQUFtQixDQUFDLEdBQUcsQ0FBQyxVQUFVLENBQUMsQ0FBQTtRQUN2RCxJQUFJLE1BQU0sRUFBRTtZQUNWLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxNQUFNLENBQUMsQ0FBQTtTQUM5QjtJQUNILENBQUM7SUFFRCxrREFBaUMsR0FBakMsVUFBa0MsT0FBZ0IsRUFBRSxVQUFrQjtRQUNwRSxJQUFNLE1BQU0sR0FBRyxJQUFJLENBQUMsbUJBQW1CLENBQUMsR0FBRyxDQUFDLFVBQVUsQ0FBQyxDQUFBO1FBQ3ZELElBQUksTUFBTSxFQUFFO1lBQ1YsT0FBTyxNQUFNLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxVQUFBLE9BQU8sSUFBSSxPQUFBLE9BQU8sQ0FBQyxPQUFPLElBQUksT0FBTyxFQUExQixDQUEwQixDQUFDLENBQUE7U0FDbkU7SUFDSCxDQUFDO0lBRUQseUJBQXlCO0lBRXpCLGNBQWM7SUFDZCw0QkFBVyxHQUFYLFVBQVksS0FBWSxFQUFFLE9BQWUsRUFBRSxNQUFXO1FBQ3BELElBQUksQ0FBQyxXQUFXLENBQUMsV0FBVyxDQUFDLEtBQUssRUFBRSxPQUFPLEVBQUUsTUFBTSxDQUFDLENBQUE7SUFDdEQsQ0FBQztJQUVELDBCQUEwQjtJQUUxQixjQUFjO0lBQ2QsK0JBQWMsR0FBZCxVQUFlLEtBQVk7UUFDekIsSUFBSSxDQUFDLGtCQUFrQixDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsVUFBVSxFQUFFLEtBQUssQ0FBQyxDQUFBO1FBQ3BELElBQU0sTUFBTSxHQUFHLElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLFVBQVUsQ0FBQyxDQUFBO1FBQzdELElBQUksTUFBTSxFQUFFO1lBQ1YsTUFBTSxDQUFDLHNCQUFzQixDQUFDLEtBQUssQ0FBQyxDQUFBO1NBQ3JDO0lBQ0gsQ0FBQztJQUVELGNBQWM7SUFDZCxrQ0FBaUIsR0FBakIsVUFBa0IsS0FBWTtRQUM1QixJQUFJLENBQUMsa0JBQWtCLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxVQUFVLEVBQUUsS0FBSyxDQUFDLENBQUE7UUFDdkQsSUFBTSxNQUFNLEdBQUcsSUFBSSxDQUFDLG1CQUFtQixDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsVUFBVSxDQUFDLENBQUE7UUFDN0QsSUFBSSxNQUFNLEVBQUU7WUFDVixNQUFNLENBQUMseUJBQXlCLENBQUMsS0FBSyxDQUFDLENBQUE7U0FDeEM7SUFDSCxDQUFDO0lBRUQsVUFBVTtJQUVGLDhCQUFhLEdBQXJCLFVBQXNCLE1BQWM7UUFDbEMsSUFBSSxDQUFDLG1CQUFtQixDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsVUFBVSxFQUFFLE1BQU0sQ0FBQyxDQUFBO1FBQ3ZELElBQU0sTUFBTSxHQUFHLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxlQUFlLENBQUMsTUFBTSxDQUFDLFVBQVUsQ0FBQyxDQUFBO1FBQ3pFLE1BQU0sQ0FBQyxPQUFPLENBQUMsVUFBQSxLQUFLLElBQUksT0FBQSxNQUFNLENBQUMsc0JBQXNCLENBQUMsS0FBSyxDQUFDLEVBQXBDLENBQW9DLENBQUMsQ0FBQTtJQUMvRCxDQUFDO0lBRU8saUNBQWdCLEdBQXhCLFVBQXlCLE1BQWM7UUFDckMsSUFBSSxDQUFDLG1CQUFtQixDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsVUFBVSxDQUFDLENBQUE7UUFDbEQsSUFBTSxNQUFNLEdBQUcsSUFBSSxDQUFDLGtCQUFrQixDQUFDLGVBQWUsQ0FBQyxNQUFNLENBQUMsVUFBVSxDQUFDLENBQUE7UUFDekUsTUFBTSxDQUFDLE9BQU8sQ0FBQyxVQUFBLEtBQUssSUFBSSxPQUFBLE1BQU0sQ0FBQyx5QkFBeUIsQ0FBQyxLQUFLLENBQUMsRUFBdkMsQ0FBdUMsQ0FBQyxDQUFBO0lBQ2xFLENBQUM7SUFDSCxhQUFDO0FBQUQsQ0FBQyxBQXJHRCxJQXFHQyJ9","export var defaultSchema = {\n    controllerAttribute: \"data-controller\",\n    actionAttribute: \"data-action\",\n    targetAttribute: \"data-target\"\n};\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2NoZW1hLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL3NjaGVtYS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFNQSxNQUFNLENBQUMsSUFBTSxhQUFhLEdBQVc7SUFDbkMsbUJBQW1CLEVBQUUsaUJBQWlCO0lBQ3RDLGVBQWUsRUFBRSxhQUFhO0lBQzlCLGVBQWUsRUFBRSxhQUFhO0NBQy9CLENBQUEifQ==","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = y[op[0] & 2 ? \"return\" : op[0] ? \"throw\" : \"next\"]) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [0, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nimport { Dispatcher } from \"./dispatcher\";\nimport { Router } from \"./router\";\nimport { defaultSchema } from \"./schema\";\nvar Application = /** @class */ (function () {\n    function Application(element, schema) {\n        if (element === void 0) { element = document.documentElement; }\n        if (schema === void 0) { schema = defaultSchema; }\n        this.element = element;\n        this.schema = schema;\n        this.dispatcher = new Dispatcher(this);\n        this.router = new Router(this);\n    }\n    Application.start = function (element, schema) {\n        var application = new Application(element, schema);\n        application.start();\n        return application;\n    };\n    Application.prototype.start = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, domReady()];\n                    case 1:\n                        _a.sent();\n                        this.router.start();\n                        this.dispatcher.start();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    Application.prototype.stop = function () {\n        this.router.stop();\n        this.dispatcher.stop();\n    };\n    Application.prototype.register = function (identifier, controllerConstructor) {\n        this.load({ identifier: identifier, controllerConstructor: controllerConstructor });\n    };\n    Application.prototype.load = function (head) {\n        var _this = this;\n        var rest = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n            rest[_i - 1] = arguments[_i];\n        }\n        var definitions = Array.isArray(head) ? head : [head].concat(rest);\n        definitions.forEach(function (definition) { return _this.router.loadDefinition(definition); });\n    };\n    Application.prototype.unload = function (head) {\n        var _this = this;\n        var rest = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n            rest[_i - 1] = arguments[_i];\n        }\n        var identifiers = Array.isArray(head) ? head : [head].concat(rest);\n        identifiers.forEach(function (identifier) { return _this.router.unloadIdentifier(identifier); });\n    };\n    Object.defineProperty(Application.prototype, \"controllers\", {\n        // Controllers\n        get: function () {\n            return this.router.contexts.map(function (context) { return context.controller; });\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Application.prototype.getControllerForElementAndIdentifier = function (element, identifier) {\n        var context = this.router.getContextForElementAndIdentifier(element, identifier);\n        return context ? context.controller : null;\n    };\n    // Error handling\n    Application.prototype.handleError = function (error, message, detail) {\n        console.error(\"%s\\n\\n%o\\n\\n%o\", message, error, detail);\n    };\n    return Application;\n}());\nexport { Application };\nfunction domReady() {\n    return new Promise(function (resolve) {\n        if (document.readyState == \"loading\") {\n            document.addEventListener(\"DOMContentLoaded\", resolve);\n        }\n        else {\n            resolve();\n        }\n    });\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXBwbGljYXRpb24uanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvYXBwbGljYXRpb24udHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFFQSxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sY0FBYyxDQUFBO0FBRXpDLE9BQU8sRUFBRSxNQUFNLEVBQUUsTUFBTSxVQUFVLENBQUE7QUFDakMsT0FBTyxFQUFVLGFBQWEsRUFBRSxNQUFNLFVBQVUsQ0FBQTtBQUVoRDtJQVlFLHFCQUFZLE9BQTJDLEVBQUUsTUFBOEI7UUFBM0Usd0JBQUEsRUFBQSxVQUFtQixRQUFRLENBQUMsZUFBZTtRQUFFLHVCQUFBLEVBQUEsc0JBQThCO1FBQ3JGLElBQUksQ0FBQyxPQUFPLEdBQUcsT0FBTyxDQUFBO1FBQ3RCLElBQUksQ0FBQyxNQUFNLEdBQUcsTUFBTSxDQUFBO1FBQ3BCLElBQUksQ0FBQyxVQUFVLEdBQUcsSUFBSSxVQUFVLENBQUMsSUFBSSxDQUFDLENBQUE7UUFDdEMsSUFBSSxDQUFDLE1BQU0sR0FBRyxJQUFJLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQTtJQUNoQyxDQUFDO0lBWE0saUJBQUssR0FBWixVQUFhLE9BQWlCLEVBQUUsTUFBZTtRQUM3QyxJQUFNLFdBQVcsR0FBRyxJQUFJLFdBQVcsQ0FBQyxPQUFPLEVBQUUsTUFBTSxDQUFDLENBQUE7UUFDcEQsV0FBVyxDQUFDLEtBQUssRUFBRSxDQUFBO1FBQ25CLE9BQU8sV0FBVyxDQUFBO0lBQ3BCLENBQUM7SUFTSywyQkFBSyxHQUFYOzs7OzRCQUNFLHFCQUFNLFFBQVEsRUFBRSxFQUFBOzt3QkFBaEIsU0FBZ0IsQ0FBQTt3QkFDaEIsSUFBSSxDQUFDLE1BQU0sQ0FBQyxLQUFLLEVBQUUsQ0FBQTt3QkFDbkIsSUFBSSxDQUFDLFVBQVUsQ0FBQyxLQUFLLEVBQUUsQ0FBQTs7Ozs7S0FDeEI7SUFFRCwwQkFBSSxHQUFKO1FBQ0UsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLEVBQUUsQ0FBQTtRQUNsQixJQUFJLENBQUMsVUFBVSxDQUFDLElBQUksRUFBRSxDQUFBO0lBQ3hCLENBQUM7SUFFRCw4QkFBUSxHQUFSLFVBQVMsVUFBa0IsRUFBRSxxQkFBNEM7UUFDdkUsSUFBSSxDQUFDLElBQUksQ0FBQyxFQUFFLFVBQVUsWUFBQSxFQUFFLHFCQUFxQix1QkFBQSxFQUFFLENBQUMsQ0FBQTtJQUNsRCxDQUFDO0lBSUQsMEJBQUksR0FBSixVQUFLLElBQStCO1FBQXBDLGlCQUdDO1FBSHFDLGNBQXFCO2FBQXJCLFVBQXFCLEVBQXJCLHFCQUFxQixFQUFyQixJQUFxQjtZQUFyQiw2QkFBcUI7O1FBQ3pELElBQU0sV0FBVyxHQUFHLEtBQUssQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLEVBQUUsSUFBSSxTQUFLLElBQUksQ0FBQyxDQUFBO1FBQ2hFLFdBQVcsQ0FBQyxPQUFPLENBQUMsVUFBQSxVQUFVLElBQUksT0FBQSxLQUFJLENBQUMsTUFBTSxDQUFDLGNBQWMsQ0FBQyxVQUFVLENBQUMsRUFBdEMsQ0FBc0MsQ0FBQyxDQUFBO0lBQzNFLENBQUM7SUFJRCw0QkFBTSxHQUFOLFVBQU8sSUFBdUI7UUFBOUIsaUJBR0M7UUFIK0IsY0FBaUI7YUFBakIsVUFBaUIsRUFBakIscUJBQWlCLEVBQWpCLElBQWlCO1lBQWpCLDZCQUFpQjs7UUFDL0MsSUFBTSxXQUFXLEdBQUcsS0FBSyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsRUFBRSxJQUFJLFNBQUssSUFBSSxDQUFDLENBQUE7UUFDaEUsV0FBVyxDQUFDLE9BQU8sQ0FBQyxVQUFBLFVBQVUsSUFBSSxPQUFBLEtBQUksQ0FBQyxNQUFNLENBQUMsZ0JBQWdCLENBQUMsVUFBVSxDQUFDLEVBQXhDLENBQXdDLENBQUMsQ0FBQTtJQUM3RSxDQUFDO0lBSUQsc0JBQUksb0NBQVc7UUFGZixjQUFjO2FBRWQ7WUFDRSxPQUFPLElBQUksQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLEdBQUcsQ0FBQyxVQUFBLE9BQU8sSUFBSSxPQUFBLE9BQU8sQ0FBQyxVQUFVLEVBQWxCLENBQWtCLENBQUMsQ0FBQTtRQUNoRSxDQUFDOzs7T0FBQTtJQUVELDBEQUFvQyxHQUFwQyxVQUFxQyxPQUFnQixFQUFFLFVBQWtCO1FBQ3ZFLElBQU0sT0FBTyxHQUFHLElBQUksQ0FBQyxNQUFNLENBQUMsaUNBQWlDLENBQUMsT0FBTyxFQUFFLFVBQVUsQ0FBQyxDQUFBO1FBQ2xGLE9BQU8sT0FBTyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUE7SUFDNUMsQ0FBQztJQUVELGlCQUFpQjtJQUVqQixpQ0FBVyxHQUFYLFVBQVksS0FBWSxFQUFFLE9BQWUsRUFBRSxNQUFjO1FBQ3ZELE9BQU8sQ0FBQyxLQUFLLENBQUMsZ0JBQWdCLEVBQUUsT0FBTyxFQUFFLEtBQUssRUFBRSxNQUFNLENBQUMsQ0FBQTtJQUN6RCxDQUFDO0lBQ0gsa0JBQUM7QUFBRCxDQUFDLEFBaEVELElBZ0VDOztBQUVEO0lBQ0UsT0FBTyxJQUFJLE9BQU8sQ0FBQyxVQUFBLE9BQU87UUFDeEIsSUFBSSxRQUFRLENBQUMsVUFBVSxJQUFJLFNBQVMsRUFBRTtZQUNwQyxRQUFRLENBQUMsZ0JBQWdCLENBQUMsa0JBQWtCLEVBQUUsT0FBTyxDQUFDLENBQUE7U0FDdkQ7YUFBTTtZQUNMLE9BQU8sRUFBRSxDQUFBO1NBQ1Y7SUFDSCxDQUFDLENBQUMsQ0FBQTtBQUNKLENBQUMifQ==","/** @hidden */\nexport function defineTargetProperties(constructor) {\n    var prototype = constructor.prototype;\n    var targetNames = getTargetNamesForConstructor(constructor);\n    targetNames.forEach(function (name) {\n        var _a;\n        return defineLinkedProperties(prototype, (_a = {},\n            _a[name + \"Target\"] = {\n                get: function () {\n                    var target = this.targets.find(name);\n                    if (target) {\n                        return target;\n                    }\n                    else {\n                        throw new Error(\"Missing target element \\\"\" + this.identifier + \".\" + name + \"\\\"\");\n                    }\n                }\n            },\n            _a[name + \"Targets\"] = {\n                get: function () {\n                    return this.targets.findAll(name);\n                }\n            },\n            _a[\"has\" + capitalize(name) + \"Target\"] = {\n                get: function () {\n                    return this.targets.has(name);\n                }\n            },\n            _a));\n    });\n}\nfunction getTargetNamesForConstructor(constructor) {\n    var ancestors = getAncestorsForConstructor(constructor);\n    return Array.from(ancestors.reduce(function (targetNames, constructor) {\n        getOwnTargetNamesForConstructor(constructor).forEach(function (name) { return targetNames.add(name); });\n        return targetNames;\n    }, new Set));\n}\nfunction getAncestorsForConstructor(constructor) {\n    var ancestors = [];\n    while (constructor) {\n        ancestors.push(constructor);\n        constructor = Object.getPrototypeOf(constructor);\n    }\n    return ancestors;\n}\nfunction getOwnTargetNamesForConstructor(constructor) {\n    var definition = constructor[\"targets\"];\n    return Array.isArray(definition) ? definition : [];\n}\nfunction defineLinkedProperties(object, properties) {\n    Object.keys(properties).forEach(function (name) {\n        if (!(name in object)) {\n            var descriptor = properties[name];\n            Object.defineProperty(object, name, descriptor);\n        }\n    });\n}\nfunction capitalize(name) {\n    return name.charAt(0).toUpperCase() + name.slice(1);\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGFyZ2V0X3Byb3BlcnRpZXMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvdGFyZ2V0X3Byb3BlcnRpZXMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBRUEsY0FBYztBQUNkLE1BQU0saUNBQWlDLFdBQXFCO0lBQzFELElBQU0sU0FBUyxHQUFHLFdBQVcsQ0FBQyxTQUFTLENBQUE7SUFDdkMsSUFBTSxXQUFXLEdBQUcsNEJBQTRCLENBQUMsV0FBVyxDQUFDLENBQUE7SUFDN0QsV0FBVyxDQUFDLE9BQU8sQ0FBQyxVQUFBLElBQUk7O1FBQUksT0FBQSxzQkFBc0IsQ0FBQyxTQUFTO1lBQzFELEdBQUksSUFBSSxXQUFRLElBQUc7Z0JBQ2pCLEdBQUc7b0JBQ0QsSUFBTSxNQUFNLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUE7b0JBQ3RDLElBQUksTUFBTSxFQUFFO3dCQUNWLE9BQU8sTUFBTSxDQUFBO3FCQUNkO3lCQUFNO3dCQUNMLE1BQU0sSUFBSSxLQUFLLENBQUMsOEJBQTJCLElBQUksQ0FBQyxVQUFVLFNBQUksSUFBSSxPQUFHLENBQUMsQ0FBQTtxQkFDdkU7Z0JBQ0gsQ0FBQzthQUNGO1lBQ0QsR0FBSSxJQUFJLFlBQVMsSUFBRztnQkFDbEIsR0FBRztvQkFDRCxPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFBO2dCQUNuQyxDQUFDO2FBQ0Y7WUFDRCxHQUFDLFFBQU0sVUFBVSxDQUFDLElBQUksQ0FBQyxXQUFRLElBQUc7Z0JBQ2hDLEdBQUc7b0JBQ0QsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsQ0FBQTtnQkFDL0IsQ0FBQzthQUNGO2dCQUNEO0lBckIwQixDQXFCMUIsQ0FBQyxDQUFBO0FBQ0wsQ0FBQztBQUVELHNDQUFzQyxXQUFxQjtJQUN6RCxJQUFNLFNBQVMsR0FBRywwQkFBMEIsQ0FBQyxXQUFXLENBQUMsQ0FBQTtJQUN6RCxPQUFPLEtBQUssQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxVQUFDLFdBQVcsRUFBRSxXQUFXO1FBQzFELCtCQUErQixDQUFDLFdBQVcsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxVQUFBLElBQUksSUFBSSxPQUFBLFdBQVcsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLEVBQXJCLENBQXFCLENBQUMsQ0FBQTtRQUNuRixPQUFPLFdBQVcsQ0FBQTtJQUNwQixDQUFDLEVBQUUsSUFBSSxHQUFrQixDQUFDLENBQUMsQ0FBQTtBQUM3QixDQUFDO0FBRUQsb0NBQW9DLFdBQXFCO0lBQ3ZELElBQU0sU0FBUyxHQUFlLEVBQUUsQ0FBQTtJQUNoQyxPQUFPLFdBQVcsRUFBRTtRQUNsQixTQUFTLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFBO1FBQzNCLFdBQVcsR0FBRyxNQUFNLENBQUMsY0FBYyxDQUFDLFdBQVcsQ0FBQyxDQUFBO0tBQ2pEO0lBQ0QsT0FBTyxTQUFTLENBQUE7QUFDbEIsQ0FBQztBQUVELHlDQUF5QyxXQUFxQjtJQUM1RCxJQUFNLFVBQVUsR0FBSSxXQUFtQixDQUFDLFNBQVMsQ0FBQyxDQUFBO0lBQ2xELE9BQU8sS0FBSyxDQUFDLE9BQU8sQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUE7QUFDcEQsQ0FBQztBQUVELGdDQUFnQyxNQUFXLEVBQUUsVUFBaUM7SUFDNUUsTUFBTSxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQyxPQUFPLENBQUMsVUFBQyxJQUFJO1FBQ25DLElBQUksQ0FBQyxDQUFDLElBQUksSUFBSSxNQUFNLENBQUMsRUFBRTtZQUNyQixJQUFNLFVBQVUsR0FBRyxVQUFVLENBQUMsSUFBSSxDQUFDLENBQUE7WUFDbkMsTUFBTSxDQUFDLGNBQWMsQ0FBQyxNQUFNLEVBQUUsSUFBSSxFQUFFLFVBQVUsQ0FBQyxDQUFBO1NBQ2hEO0lBQ0gsQ0FBQyxDQUFDLENBQUE7QUFDSixDQUFDO0FBRUQsb0JBQW9CLElBQVk7SUFDOUIsT0FBTyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLFdBQVcsRUFBRSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUE7QUFDckQsQ0FBQyJ9","import { defineTargetProperties } from \"./target_properties\";\nvar Controller = /** @class */ (function () {\n    function Controller(context) {\n        this.context = context;\n    }\n    Controller.bless = function () {\n        defineTargetProperties(this);\n    };\n    Object.defineProperty(Controller.prototype, \"application\", {\n        get: function () {\n            return this.context.application;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Controller.prototype, \"scope\", {\n        get: function () {\n            return this.context.scope;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Controller.prototype, \"element\", {\n        get: function () {\n            return this.scope.element;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Controller.prototype, \"identifier\", {\n        get: function () {\n            return this.scope.identifier;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Controller.prototype, \"targets\", {\n        get: function () {\n            return this.scope.targets;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Controller.prototype, \"data\", {\n        get: function () {\n            return this.scope.data;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Controller.prototype.initialize = function () {\n        // Override in your subclass to set up initial controller state\n    };\n    Controller.prototype.connect = function () {\n        // Override in your subclass to respond when the controller is connected to the DOM\n    };\n    Controller.prototype.disconnect = function () {\n        // Override in your subclass to respond when the controller is disconnected from the DOM\n    };\n    Controller.targets = [];\n    return Controller;\n}());\nexport { Controller };\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29udHJvbGxlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9jb250cm9sbGVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUtBLE9BQU8sRUFBRSxzQkFBc0IsRUFBRSxNQUFNLHFCQUFxQixDQUFBO0FBTzVEO0lBU0Usb0JBQVksT0FBZ0I7UUFDMUIsSUFBSSxDQUFDLE9BQU8sR0FBRyxPQUFPLENBQUE7SUFDeEIsQ0FBQztJQU5NLGdCQUFLLEdBQVo7UUFDRSxzQkFBc0IsQ0FBQyxJQUFJLENBQUMsQ0FBQTtJQUM5QixDQUFDO0lBTUQsc0JBQUksbUNBQVc7YUFBZjtZQUNFLE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQyxXQUFXLENBQUE7UUFDakMsQ0FBQzs7O09BQUE7SUFFRCxzQkFBSSw2QkFBSzthQUFUO1lBQ0UsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQTtRQUMzQixDQUFDOzs7T0FBQTtJQUVELHNCQUFJLCtCQUFPO2FBQVg7WUFDRSxPQUFPLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFBO1FBQzNCLENBQUM7OztPQUFBO0lBRUQsc0JBQUksa0NBQVU7YUFBZDtZQUNFLE9BQU8sSUFBSSxDQUFDLEtBQUssQ0FBQyxVQUFVLENBQUE7UUFDOUIsQ0FBQzs7O09BQUE7SUFFRCxzQkFBSSwrQkFBTzthQUFYO1lBQ0UsT0FBTyxJQUFJLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQTtRQUMzQixDQUFDOzs7T0FBQTtJQUVELHNCQUFJLDRCQUFJO2FBQVI7WUFDRSxPQUFPLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFBO1FBQ3hCLENBQUM7OztPQUFBO0lBRUQsK0JBQVUsR0FBVjtRQUNFLCtEQUErRDtJQUNqRSxDQUFDO0lBRUQsNEJBQU8sR0FBUDtRQUNFLG1GQUFtRjtJQUNyRixDQUFDO0lBRUQsK0JBQVUsR0FBVjtRQUNFLHdGQUF3RjtJQUMxRixDQUFDO0lBOUNNLGtCQUFPLEdBQWEsRUFBRSxDQUFBO0lBK0MvQixpQkFBQztDQUFBLEFBaERELElBZ0RDO1NBaERZLFVBQVUifQ==","/**\n * Fizzy UI utils v2.0.7\n * MIT license\n */\n\n/*jshint browser: true, undef: true, unused: true, strict: true */\n\n( function( window, factory ) {\n  // universal module definition\n  /*jshint strict: false */ /*globals define, module, require */\n\n  if ( typeof define == 'function' && define.amd ) {\n    // AMD\n    define( [\n      'desandro-matches-selector/matches-selector'\n    ], function( matchesSelector ) {\n      return factory( window, matchesSelector );\n    });\n  } else if ( typeof module == 'object' && module.exports ) {\n    // CommonJS\n    module.exports = factory(\n      window,\n      require('desandro-matches-selector')\n    );\n  } else {\n    // browser global\n    window.fizzyUIUtils = factory(\n      window,\n      window.matchesSelector\n    );\n  }\n\n}( window, function factory( window, matchesSelector ) {\n\n'use strict';\n\nvar utils = {};\n\n// ----- extend ----- //\n\n// extends objects\nutils.extend = function( a, b ) {\n  for ( var prop in b ) {\n    a[ prop ] = b[ prop ];\n  }\n  return a;\n};\n\n// ----- modulo ----- //\n\nutils.modulo = function( num, div ) {\n  return ( ( num % div ) + div ) % div;\n};\n\n// ----- makeArray ----- //\n\nvar arraySlice = Array.prototype.slice;\n\n// turn element or nodeList into an array\nutils.makeArray = function( obj ) {\n  if ( Array.isArray( obj ) ) {\n    // use object if already an array\n    return obj;\n  }\n  // return empty array if undefined or null. #6\n  if ( obj === null || obj === undefined ) {\n    return [];\n  }\n\n  var isArrayLike = typeof obj == 'object' && typeof obj.length == 'number';\n  if ( isArrayLike ) {\n    // convert nodeList to array\n    return arraySlice.call( obj );\n  }\n\n  // array of single index\n  return [ obj ];\n};\n\n// ----- removeFrom ----- //\n\nutils.removeFrom = function( ary, obj ) {\n  var index = ary.indexOf( obj );\n  if ( index != -1 ) {\n    ary.splice( index, 1 );\n  }\n};\n\n// ----- getParent ----- //\n\nutils.getParent = function( elem, selector ) {\n  while ( elem.parentNode && elem != document.body ) {\n    elem = elem.parentNode;\n    if ( matchesSelector( elem, selector ) ) {\n      return elem;\n    }\n  }\n};\n\n// ----- getQueryElement ----- //\n\n// use element as selector string\nutils.getQueryElement = function( elem ) {\n  if ( typeof elem == 'string' ) {\n    return document.querySelector( elem );\n  }\n  return elem;\n};\n\n// ----- handleEvent ----- //\n\n// enable .ontype to trigger from .addEventListener( elem, 'type' )\nutils.handleEvent = function( event ) {\n  var method = 'on' + event.type;\n  if ( this[ method ] ) {\n    this[ method ]( event );\n  }\n};\n\n// ----- filterFindElements ----- //\n\nutils.filterFindElements = function( elems, selector ) {\n  // make array of elems\n  elems = utils.makeArray( elems );\n  var ffElems = [];\n\n  elems.forEach( function( elem ) {\n    // check that elem is an actual element\n    if ( !( elem instanceof HTMLElement ) ) {\n      return;\n    }\n    // add elem if no selector\n    if ( !selector ) {\n      ffElems.push( elem );\n      return;\n    }\n    // filter & find items if we have a selector\n    // filter\n    if ( matchesSelector( elem, selector ) ) {\n      ffElems.push( elem );\n    }\n    // find children\n    var childElems = elem.querySelectorAll( selector );\n    // concat childElems to filterFound array\n    for ( var i=0; i < childElems.length; i++ ) {\n      ffElems.push( childElems[i] );\n    }\n  });\n\n  return ffElems;\n};\n\n// ----- debounceMethod ----- //\n\nutils.debounceMethod = function( _class, methodName, threshold ) {\n  threshold = threshold || 100;\n  // original method\n  var method = _class.prototype[ methodName ];\n  var timeoutName = methodName + 'Timeout';\n\n  _class.prototype[ methodName ] = function() {\n    var timeout = this[ timeoutName ];\n    clearTimeout( timeout );\n\n    var args = arguments;\n    var _this = this;\n    this[ timeoutName ] = setTimeout( function() {\n      method.apply( _this, args );\n      delete _this[ timeoutName ];\n    }, threshold );\n  };\n};\n\n// ----- docReady ----- //\n\nutils.docReady = function( callback ) {\n  var readyState = document.readyState;\n  if ( readyState == 'complete' || readyState == 'interactive' ) {\n    // do async to allow for other scripts to run. metafizzy/flickity#441\n    setTimeout( callback );\n  } else {\n    document.addEventListener( 'DOMContentLoaded', callback );\n  }\n};\n\n// ----- htmlInit ----- //\n\n// http://jamesroberts.name/blog/2010/02/22/string-functions-for-javascript-trim-to-camel-case-to-dashed-and-to-underscore/\nutils.toDashed = function( str ) {\n  return str.replace( /(.)([A-Z])/g, function( match, $1, $2 ) {\n    return $1 + '-' + $2;\n  }).toLowerCase();\n};\n\nvar console = window.console;\n/**\n * allow user to initialize classes via [data-namespace] or .js-namespace class\n * htmlInit( Widget, 'widgetName' )\n * options are parsed from data-namespace-options\n */\nutils.htmlInit = function( WidgetClass, namespace ) {\n  utils.docReady( function() {\n    var dashedNamespace = utils.toDashed( namespace );\n    var dataAttr = 'data-' + dashedNamespace;\n    var dataAttrElems = document.querySelectorAll( '[' + dataAttr + ']' );\n    var jsDashElems = document.querySelectorAll( '.js-' + dashedNamespace );\n    var elems = utils.makeArray( dataAttrElems )\n      .concat( utils.makeArray( jsDashElems ) );\n    var dataOptionsAttr = dataAttr + '-options';\n    var jQuery = window.jQuery;\n\n    elems.forEach( function( elem ) {\n      var attr = elem.getAttribute( dataAttr ) ||\n        elem.getAttribute( dataOptionsAttr );\n      var options;\n      try {\n        options = attr && JSON.parse( attr );\n      } catch ( error ) {\n        // log error, do not initialize\n        if ( console ) {\n          console.error( 'Error parsing ' + dataAttr + ' on ' + elem.className +\n          ': ' + error );\n        }\n        return;\n      }\n      // initialize\n      var instance = new WidgetClass( elem, options );\n      // make available via $().data('namespace')\n      if ( jQuery ) {\n        jQuery.data( elem, namespace, instance );\n      }\n    });\n\n  });\n};\n\n// -----  ----- //\n\nreturn utils;\n\n}));\n","import { Controller } from 'stimulus'\n\nexport default class extends Controller {\n  static targets = ['element']\n\n  play() {\n    this.elementTarget.play()\n  }\n\n  pause() {\n    this.elementTarget.pause()\n  }\n}\n","import { Controller } from 'stimulus'\n\nexport default class extends Controller {\n  initialize() {\n    const menu = this.element\n    menu.onchange = () => {\n      if (menu.options[menu.selectedIndex].value !== '') {\n        location.href = menu.options[menu.selectedIndex].value\n      }\n    }\n  }\n}\n","/*!\n * Masonry v4.2.2\n * Cascading grid layout library\n * https://masonry.desandro.com\n * MIT License\n * by David DeSandro\n */\n\n( function( window, factory ) {\n  // universal module definition\n  /* jshint strict: false */ /*globals define, module, require */\n  if ( typeof define == 'function' && define.amd ) {\n    // AMD\n    define( [\n        'outlayer/outlayer',\n        'get-size/get-size'\n      ],\n      factory );\n  } else if ( typeof module == 'object' && module.exports ) {\n    // CommonJS\n    module.exports = factory(\n      require('outlayer'),\n      require('get-size')\n    );\n  } else {\n    // browser global\n    window.Masonry = factory(\n      window.Outlayer,\n      window.getSize\n    );\n  }\n\n}( window, function factory( Outlayer, getSize ) {\n\n'use strict';\n\n// -------------------------- masonryDefinition -------------------------- //\n\n  // create an Outlayer layout class\n  var Masonry = Outlayer.create('masonry');\n  // isFitWidth -> fitWidth\n  Masonry.compatOptions.fitWidth = 'isFitWidth';\n\n  var proto = Masonry.prototype;\n\n  proto._resetLayout = function() {\n    this.getSize();\n    this._getMeasurement( 'columnWidth', 'outerWidth' );\n    this._getMeasurement( 'gutter', 'outerWidth' );\n    this.measureColumns();\n\n    // reset column Y\n    this.colYs = [];\n    for ( var i=0; i < this.cols; i++ ) {\n      this.colYs.push( 0 );\n    }\n\n    this.maxY = 0;\n    this.horizontalColIndex = 0;\n  };\n\n  proto.measureColumns = function() {\n    this.getContainerWidth();\n    // if columnWidth is 0, default to outerWidth of first item\n    if ( !this.columnWidth ) {\n      var firstItem = this.items[0];\n      var firstItemElem = firstItem && firstItem.element;\n      // columnWidth fall back to item of first element\n      this.columnWidth = firstItemElem && getSize( firstItemElem ).outerWidth ||\n        // if first elem has no width, default to size of container\n        this.containerWidth;\n    }\n\n    var columnWidth = this.columnWidth += this.gutter;\n\n    // calculate columns\n    var containerWidth = this.containerWidth + this.gutter;\n    var cols = containerWidth / columnWidth;\n    // fix rounding errors, typically with gutters\n    var excess = columnWidth - containerWidth % columnWidth;\n    // if overshoot is less than a pixel, round up, otherwise floor it\n    var mathMethod = excess && excess < 1 ? 'round' : 'floor';\n    cols = Math[ mathMethod ]( cols );\n    this.cols = Math.max( cols, 1 );\n  };\n\n  proto.getContainerWidth = function() {\n    // container is parent if fit width\n    var isFitWidth = this._getOption('fitWidth');\n    var container = isFitWidth ? this.element.parentNode : this.element;\n    // check that this.size and size are there\n    // IE8 triggers resize on body size change, so they might not be\n    var size = getSize( container );\n    this.containerWidth = size && size.innerWidth;\n  };\n\n  proto._getItemLayoutPosition = function( item ) {\n    item.getSize();\n    // how many columns does this brick span\n    var remainder = item.size.outerWidth % this.columnWidth;\n    var mathMethod = remainder && remainder < 1 ? 'round' : 'ceil';\n    // round if off by 1 pixel, otherwise use ceil\n    var colSpan = Math[ mathMethod ]( item.size.outerWidth / this.columnWidth );\n    colSpan = Math.min( colSpan, this.cols );\n    // use horizontal or top column position\n    var colPosMethod = this.options.horizontalOrder ?\n      '_getHorizontalColPosition' : '_getTopColPosition';\n    var colPosition = this[ colPosMethod ]( colSpan, item );\n    // position the brick\n    var position = {\n      x: this.columnWidth * colPosition.col,\n      y: colPosition.y\n    };\n    // apply setHeight to necessary columns\n    var setHeight = colPosition.y + item.size.outerHeight;\n    var setMax = colSpan + colPosition.col;\n    for ( var i = colPosition.col; i < setMax; i++ ) {\n      this.colYs[i] = setHeight;\n    }\n\n    return position;\n  };\n\n  proto._getTopColPosition = function( colSpan ) {\n    var colGroup = this._getTopColGroup( colSpan );\n    // get the minimum Y value from the columns\n    var minimumY = Math.min.apply( Math, colGroup );\n\n    return {\n      col: colGroup.indexOf( minimumY ),\n      y: minimumY,\n    };\n  };\n\n  /**\n   * @param {Number} colSpan - number of columns the element spans\n   * @returns {Array} colGroup\n   */\n  proto._getTopColGroup = function( colSpan ) {\n    if ( colSpan < 2 ) {\n      // if brick spans only one column, use all the column Ys\n      return this.colYs;\n    }\n\n    var colGroup = [];\n    // how many different places could this brick fit horizontally\n    var groupCount = this.cols + 1 - colSpan;\n    // for each group potential horizontal position\n    for ( var i = 0; i < groupCount; i++ ) {\n      colGroup[i] = this._getColGroupY( i, colSpan );\n    }\n    return colGroup;\n  };\n\n  proto._getColGroupY = function( col, colSpan ) {\n    if ( colSpan < 2 ) {\n      return this.colYs[ col ];\n    }\n    // make an array of colY values for that one group\n    var groupColYs = this.colYs.slice( col, col + colSpan );\n    // and get the max value of the array\n    return Math.max.apply( Math, groupColYs );\n  };\n\n  // get column position based on horizontal index. #873\n  proto._getHorizontalColPosition = function( colSpan, item ) {\n    var col = this.horizontalColIndex % this.cols;\n    var isOver = colSpan > 1 && col + colSpan > this.cols;\n    // shift to next row if item can't fit on current row\n    col = isOver ? 0 : col;\n    // don't let zero-size items take up space\n    var hasSize = item.size.outerWidth && item.size.outerHeight;\n    this.horizontalColIndex = hasSize ? col + colSpan : this.horizontalColIndex;\n\n    return {\n      col: col,\n      y: this._getColGroupY( col, colSpan ),\n    };\n  };\n\n  proto._manageStamp = function( stamp ) {\n    var stampSize = getSize( stamp );\n    var offset = this._getElementOffset( stamp );\n    // get the columns that this stamp affects\n    var isOriginLeft = this._getOption('originLeft');\n    var firstX = isOriginLeft ? offset.left : offset.right;\n    var lastX = firstX + stampSize.outerWidth;\n    var firstCol = Math.floor( firstX / this.columnWidth );\n    firstCol = Math.max( 0, firstCol );\n    var lastCol = Math.floor( lastX / this.columnWidth );\n    // lastCol should not go over if multiple of columnWidth #425\n    lastCol -= lastX % this.columnWidth ? 0 : 1;\n    lastCol = Math.min( this.cols - 1, lastCol );\n    // set colYs to bottom of the stamp\n\n    var isOriginTop = this._getOption('originTop');\n    var stampMaxY = ( isOriginTop ? offset.top : offset.bottom ) +\n      stampSize.outerHeight;\n    for ( var i = firstCol; i <= lastCol; i++ ) {\n      this.colYs[i] = Math.max( stampMaxY, this.colYs[i] );\n    }\n  };\n\n  proto._getContainerSize = function() {\n    this.maxY = Math.max.apply( Math, this.colYs );\n    var size = {\n      height: this.maxY\n    };\n\n    if ( this._getOption('fitWidth') ) {\n      size.width = this._getContainerFitWidth();\n    }\n\n    return size;\n  };\n\n  proto._getContainerFitWidth = function() {\n    var unusedCols = 0;\n    // count unused columns\n    var i = this.cols;\n    while ( --i ) {\n      if ( this.colYs[i] !== 0 ) {\n        break;\n      }\n      unusedCols++;\n    }\n    // fit container to columns that have been used\n    return ( this.cols - unusedCols ) * this.columnWidth - this.gutter;\n  };\n\n  proto.needsResizeLayout = function() {\n    var previousWidth = this.containerWidth;\n    this.getContainerWidth();\n    return previousWidth != this.containerWidth;\n  };\n\n  return Masonry;\n\n}));\n","var map = {\n\t\"./audio_controller.js\": \"aNHe\",\n\t\"./gallery-grid_controller.js\": \"O1e8\",\n\t\"./gdpr_controller.js\": \"7vuP\",\n\t\"./jump-menu_controller.js\": \"exri\",\n\t\"./modal_controller.js\": \"Es/6\",\n\t\"./nav-mobile_controller.js\": \"uZgh\",\n\t\"./slideshow_controller.js\": \"rQqv\"\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = \"oCoR\";","/*!\n * JavaScript Cookie v2.2.1\n * https://github.com/js-cookie/js-cookie\n *\n * Copyright 2006, 2015 Klaus Hartl & Fagner Brack\n * Released under the MIT license\n */\n;(function (factory) {\n\tvar registeredInModuleLoader;\n\tif (typeof define === 'function' && define.amd) {\n\t\tdefine(factory);\n\t\tregisteredInModuleLoader = true;\n\t}\n\tif (typeof exports === 'object') {\n\t\tmodule.exports = factory();\n\t\tregisteredInModuleLoader = true;\n\t}\n\tif (!registeredInModuleLoader) {\n\t\tvar OldCookies = window.Cookies;\n\t\tvar api = window.Cookies = factory();\n\t\tapi.noConflict = function () {\n\t\t\twindow.Cookies = OldCookies;\n\t\t\treturn api;\n\t\t};\n\t}\n}(function () {\n\tfunction extend () {\n\t\tvar i = 0;\n\t\tvar result = {};\n\t\tfor (; i < arguments.length; i++) {\n\t\t\tvar attributes = arguments[ i ];\n\t\t\tfor (var key in attributes) {\n\t\t\t\tresult[key] = attributes[key];\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tfunction decode (s) {\n\t\treturn s.replace(/(%[0-9A-Z]{2})+/g, decodeURIComponent);\n\t}\n\n\tfunction init (converter) {\n\t\tfunction api() {}\n\n\t\tfunction set (key, value, attributes) {\n\t\t\tif (typeof document === 'undefined') {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tattributes = extend({\n\t\t\t\tpath: '/'\n\t\t\t}, api.defaults, attributes);\n\n\t\t\tif (typeof attributes.expires === 'number') {\n\t\t\t\tattributes.expires = new Date(new Date() * 1 + attributes.expires * 864e+5);\n\t\t\t}\n\n\t\t\t// We're using \"expires\" because \"max-age\" is not supported by IE\n\t\t\tattributes.expires = attributes.expires ? attributes.expires.toUTCString() : '';\n\n\t\t\ttry {\n\t\t\t\tvar result = JSON.stringify(value);\n\t\t\t\tif (/^[\\{\\[]/.test(result)) {\n\t\t\t\t\tvalue = result;\n\t\t\t\t}\n\t\t\t} catch (e) {}\n\n\t\t\tvalue = converter.write ?\n\t\t\t\tconverter.write(value, key) :\n\t\t\t\tencodeURIComponent(String(value))\n\t\t\t\t\t.replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g, decodeURIComponent);\n\n\t\t\tkey = encodeURIComponent(String(key))\n\t\t\t\t.replace(/%(23|24|26|2B|5E|60|7C)/g, decodeURIComponent)\n\t\t\t\t.replace(/[\\(\\)]/g, escape);\n\n\t\t\tvar stringifiedAttributes = '';\n\t\t\tfor (var attributeName in attributes) {\n\t\t\t\tif (!attributes[attributeName]) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tstringifiedAttributes += '; ' + attributeName;\n\t\t\t\tif (attributes[attributeName] === true) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\t// Considers RFC 6265 section 5.2:\n\t\t\t\t// ...\n\t\t\t\t// 3.  If the remaining unparsed-attributes contains a %x3B (\";\")\n\t\t\t\t//     character:\n\t\t\t\t// Consume the characters of the unparsed-attributes up to,\n\t\t\t\t// not including, the first %x3B (\";\") character.\n\t\t\t\t// ...\n\t\t\t\tstringifiedAttributes += '=' + attributes[attributeName].split(';')[0];\n\t\t\t}\n\n\t\t\treturn (document.cookie = key + '=' + value + stringifiedAttributes);\n\t\t}\n\n\t\tfunction get (key, json) {\n\t\t\tif (typeof document === 'undefined') {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar jar = {};\n\t\t\t// To prevent the for loop in the first place assign an empty array\n\t\t\t// in case there are no cookies at all.\n\t\t\tvar cookies = document.cookie ? document.cookie.split('; ') : [];\n\t\t\tvar i = 0;\n\n\t\t\tfor (; i < cookies.length; i++) {\n\t\t\t\tvar parts = cookies[i].split('=');\n\t\t\t\tvar cookie = parts.slice(1).join('=');\n\n\t\t\t\tif (!json && cookie.charAt(0) === '\"') {\n\t\t\t\t\tcookie = cookie.slice(1, -1);\n\t\t\t\t}\n\n\t\t\t\ttry {\n\t\t\t\t\tvar name = decode(parts[0]);\n\t\t\t\t\tcookie = (converter.read || converter)(cookie, name) ||\n\t\t\t\t\t\tdecode(cookie);\n\n\t\t\t\t\tif (json) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tcookie = JSON.parse(cookie);\n\t\t\t\t\t\t} catch (e) {}\n\t\t\t\t\t}\n\n\t\t\t\t\tjar[name] = cookie;\n\n\t\t\t\t\tif (key === name) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {}\n\t\t\t}\n\n\t\t\treturn key ? jar[key] : jar;\n\t\t}\n\n\t\tapi.set = set;\n\t\tapi.get = function (key) {\n\t\t\treturn get(key, false /* read as raw */);\n\t\t};\n\t\tapi.getJSON = function (key) {\n\t\t\treturn get(key, true /* read as json */);\n\t\t};\n\t\tapi.remove = function (key, attributes) {\n\t\t\tset(key, '', extend(attributes, {\n\t\t\t\texpires: -1\n\t\t\t}));\n\t\t};\n\n\t\tapi.defaults = {};\n\n\t\tapi.withConverter = init;\n\n\t\treturn api;\n\t}\n\n\treturn init(function () {});\n}));\n","import { Controller } from 'stimulus'\n\nexport default class extends Controller {\n  static targets = ['slide', 'nav']\n\n  initialize() {\n    this.showCurrentSlide()\n    this.initAutoPlay()\n  }\n\n  initAutoPlay() {\n    const self = this\n    self.timer = setInterval(() => {\n      self.index++\n      if (self.index === self.slideTargets.length) {\n        self.index = 0\n      }\n    }, 6000)\n  }\n\n  goToSlide(event) {\n    this.index = event.currentTarget.dataset.index\n    clearInterval(this.timer)\n    this.initAutoPlay()\n  }\n\n  showCurrentSlide() {\n    this.slideTargets.forEach((element, index) => {\n      if (index === this.index) {\n        element.classList.replace('invisible', 'visible')\n        element.classList.replace('opacity-0', 'opacity-100')\n      } else {\n        element.classList.replace('visible', 'invisible')\n        element.classList.replace('opacity-100', 'opacity-0')\n      }\n    })\n    this.navTargets.forEach((element, index) => {\n      if (index === this.index) {\n        element.classList.add('bg-white')\n      } else {\n        element.classList.remove('bg-white')\n      }\n    })\n  }\n\n  nextSlide() {\n    if (this.index < this.slideTargets.length - 1) {\n      this.index++\n    }\n  }\n\n  previousSlide() {\n    if (this.index > 0) {\n      this.index--\n    }\n  }\n\n  get index() {\n    return this.data.has('index') ? parseInt(this.data.get('index')) : 0\n  }\n\n  set index(value) {\n    this.data.set('index', value)\n    this.showCurrentSlide()\n  }\n}\n","import { Controller } from 'stimulus'\n\nexport default class extends Controller {\n  static targets = ['menu']\n\n  open() {\n    const mobileNav = this.menuTarget\n    mobileNav.setAttribute('aria-hidden', 'false')\n    mobileNav.classList.add('nav-mobile--is-active')\n    mobileNav.focus()\n  }\n\n  close(event) {\n    if (event.keyCode === 27 || event.type === 'click') {\n      const mobileNav = this.menuTarget\n      mobileNav.setAttribute('aria-hidden', 'true')\n      mobileNav.classList.remove('nav-mobile--is-active')\n    }\n  }\n}\n","/*!\n * imagesLoaded v4.1.4\n * JavaScript is all like \"You images are done yet or what?\"\n * MIT License\n */\n\n( function( window, factory ) { 'use strict';\n  // universal module definition\n\n  /*global define: false, module: false, require: false */\n\n  if ( typeof define == 'function' && define.amd ) {\n    // AMD\n    define( [\n      'ev-emitter/ev-emitter'\n    ], function( EvEmitter ) {\n      return factory( window, EvEmitter );\n    });\n  } else if ( typeof module == 'object' && module.exports ) {\n    // CommonJS\n    module.exports = factory(\n      window,\n      require('ev-emitter')\n    );\n  } else {\n    // browser global\n    window.imagesLoaded = factory(\n      window,\n      window.EvEmitter\n    );\n  }\n\n})( typeof window !== 'undefined' ? window : this,\n\n// --------------------------  factory -------------------------- //\n\nfunction factory( window, EvEmitter ) {\n\n'use strict';\n\nvar $ = window.jQuery;\nvar console = window.console;\n\n// -------------------------- helpers -------------------------- //\n\n// extend objects\nfunction extend( a, b ) {\n  for ( var prop in b ) {\n    a[ prop ] = b[ prop ];\n  }\n  return a;\n}\n\nvar arraySlice = Array.prototype.slice;\n\n// turn element or nodeList into an array\nfunction makeArray( obj ) {\n  if ( Array.isArray( obj ) ) {\n    // use object if already an array\n    return obj;\n  }\n\n  var isArrayLike = typeof obj == 'object' && typeof obj.length == 'number';\n  if ( isArrayLike ) {\n    // convert nodeList to array\n    return arraySlice.call( obj );\n  }\n\n  // array of single index\n  return [ obj ];\n}\n\n// -------------------------- imagesLoaded -------------------------- //\n\n/**\n * @param {Array, Element, NodeList, String} elem\n * @param {Object or Function} options - if function, use as callback\n * @param {Function} onAlways - callback function\n */\nfunction ImagesLoaded( elem, options, onAlways ) {\n  // coerce ImagesLoaded() without new, to be new ImagesLoaded()\n  if ( !( this instanceof ImagesLoaded ) ) {\n    return new ImagesLoaded( elem, options, onAlways );\n  }\n  // use elem as selector string\n  var queryElem = elem;\n  if ( typeof elem == 'string' ) {\n    queryElem = document.querySelectorAll( elem );\n  }\n  // bail if bad element\n  if ( !queryElem ) {\n    console.error( 'Bad element for imagesLoaded ' + ( queryElem || elem ) );\n    return;\n  }\n\n  this.elements = makeArray( queryElem );\n  this.options = extend( {}, this.options );\n  // shift arguments if no options set\n  if ( typeof options == 'function' ) {\n    onAlways = options;\n  } else {\n    extend( this.options, options );\n  }\n\n  if ( onAlways ) {\n    this.on( 'always', onAlways );\n  }\n\n  this.getImages();\n\n  if ( $ ) {\n    // add jQuery Deferred object\n    this.jqDeferred = new $.Deferred();\n  }\n\n  // HACK check async to allow time to bind listeners\n  setTimeout( this.check.bind( this ) );\n}\n\nImagesLoaded.prototype = Object.create( EvEmitter.prototype );\n\nImagesLoaded.prototype.options = {};\n\nImagesLoaded.prototype.getImages = function() {\n  this.images = [];\n\n  // filter & find items if we have an item selector\n  this.elements.forEach( this.addElementImages, this );\n};\n\n/**\n * @param {Node} element\n */\nImagesLoaded.prototype.addElementImages = function( elem ) {\n  // filter siblings\n  if ( elem.nodeName == 'IMG' ) {\n    this.addImage( elem );\n  }\n  // get background image on element\n  if ( this.options.background === true ) {\n    this.addElementBackgroundImages( elem );\n  }\n\n  // find children\n  // no non-element nodes, #143\n  var nodeType = elem.nodeType;\n  if ( !nodeType || !elementNodeTypes[ nodeType ] ) {\n    return;\n  }\n  var childImgs = elem.querySelectorAll('img');\n  // concat childElems to filterFound array\n  for ( var i=0; i < childImgs.length; i++ ) {\n    var img = childImgs[i];\n    this.addImage( img );\n  }\n\n  // get child background images\n  if ( typeof this.options.background == 'string' ) {\n    var children = elem.querySelectorAll( this.options.background );\n    for ( i=0; i < children.length; i++ ) {\n      var child = children[i];\n      this.addElementBackgroundImages( child );\n    }\n  }\n};\n\nvar elementNodeTypes = {\n  1: true,\n  9: true,\n  11: true\n};\n\nImagesLoaded.prototype.addElementBackgroundImages = function( elem ) {\n  var style = getComputedStyle( elem );\n  if ( !style ) {\n    // Firefox returns null if in a hidden iframe https://bugzil.la/548397\n    return;\n  }\n  // get url inside url(\"...\")\n  var reURL = /url\\((['\"])?(.*?)\\1\\)/gi;\n  var matches = reURL.exec( style.backgroundImage );\n  while ( matches !== null ) {\n    var url = matches && matches[2];\n    if ( url ) {\n      this.addBackground( url, elem );\n    }\n    matches = reURL.exec( style.backgroundImage );\n  }\n};\n\n/**\n * @param {Image} img\n */\nImagesLoaded.prototype.addImage = function( img ) {\n  var loadingImage = new LoadingImage( img );\n  this.images.push( loadingImage );\n};\n\nImagesLoaded.prototype.addBackground = function( url, elem ) {\n  var background = new Background( url, elem );\n  this.images.push( background );\n};\n\nImagesLoaded.prototype.check = function() {\n  var _this = this;\n  this.progressedCount = 0;\n  this.hasAnyBroken = false;\n  // complete if no images\n  if ( !this.images.length ) {\n    this.complete();\n    return;\n  }\n\n  function onProgress( image, elem, message ) {\n    // HACK - Chrome triggers event before object properties have changed. #83\n    setTimeout( function() {\n      _this.progress( image, elem, message );\n    });\n  }\n\n  this.images.forEach( function( loadingImage ) {\n    loadingImage.once( 'progress', onProgress );\n    loadingImage.check();\n  });\n};\n\nImagesLoaded.prototype.progress = function( image, elem, message ) {\n  this.progressedCount++;\n  this.hasAnyBroken = this.hasAnyBroken || !image.isLoaded;\n  // progress event\n  this.emitEvent( 'progress', [ this, image, elem ] );\n  if ( this.jqDeferred && this.jqDeferred.notify ) {\n    this.jqDeferred.notify( this, image );\n  }\n  // check if completed\n  if ( this.progressedCount == this.images.length ) {\n    this.complete();\n  }\n\n  if ( this.options.debug && console ) {\n    console.log( 'progress: ' + message, image, elem );\n  }\n};\n\nImagesLoaded.prototype.complete = function() {\n  var eventName = this.hasAnyBroken ? 'fail' : 'done';\n  this.isComplete = true;\n  this.emitEvent( eventName, [ this ] );\n  this.emitEvent( 'always', [ this ] );\n  if ( this.jqDeferred ) {\n    var jqMethod = this.hasAnyBroken ? 'reject' : 'resolve';\n    this.jqDeferred[ jqMethod ]( this );\n  }\n};\n\n// --------------------------  -------------------------- //\n\nfunction LoadingImage( img ) {\n  this.img = img;\n}\n\nLoadingImage.prototype = Object.create( EvEmitter.prototype );\n\nLoadingImage.prototype.check = function() {\n  // If complete is true and browser supports natural sizes,\n  // try to check for image status manually.\n  var isComplete = this.getIsImageComplete();\n  if ( isComplete ) {\n    // report based on naturalWidth\n    this.confirm( this.img.naturalWidth !== 0, 'naturalWidth' );\n    return;\n  }\n\n  // If none of the checks above matched, simulate loading on detached element.\n  this.proxyImage = new Image();\n  this.proxyImage.addEventListener( 'load', this );\n  this.proxyImage.addEventListener( 'error', this );\n  // bind to image as well for Firefox. #191\n  this.img.addEventListener( 'load', this );\n  this.img.addEventListener( 'error', this );\n  this.proxyImage.src = this.img.src;\n};\n\nLoadingImage.prototype.getIsImageComplete = function() {\n  // check for non-zero, non-undefined naturalWidth\n  // fixes Safari+InfiniteScroll+Masonry bug infinite-scroll#671\n  return this.img.complete && this.img.naturalWidth;\n};\n\nLoadingImage.prototype.confirm = function( isLoaded, message ) {\n  this.isLoaded = isLoaded;\n  this.emitEvent( 'progress', [ this, this.img, message ] );\n};\n\n// ----- events ----- //\n\n// trigger specified handler for event type\nLoadingImage.prototype.handleEvent = function( event ) {\n  var method = 'on' + event.type;\n  if ( this[ method ] ) {\n    this[ method ]( event );\n  }\n};\n\nLoadingImage.prototype.onload = function() {\n  this.confirm( true, 'onload' );\n  this.unbindEvents();\n};\n\nLoadingImage.prototype.onerror = function() {\n  this.confirm( false, 'onerror' );\n  this.unbindEvents();\n};\n\nLoadingImage.prototype.unbindEvents = function() {\n  this.proxyImage.removeEventListener( 'load', this );\n  this.proxyImage.removeEventListener( 'error', this );\n  this.img.removeEventListener( 'load', this );\n  this.img.removeEventListener( 'error', this );\n};\n\n// -------------------------- Background -------------------------- //\n\nfunction Background( url, element ) {\n  this.url = url;\n  this.element = element;\n  this.img = new Image();\n}\n\n// inherit LoadingImage prototype\nBackground.prototype = Object.create( LoadingImage.prototype );\n\nBackground.prototype.check = function() {\n  this.img.addEventListener( 'load', this );\n  this.img.addEventListener( 'error', this );\n  this.img.src = this.url;\n  // check if image is already complete\n  var isComplete = this.getIsImageComplete();\n  if ( isComplete ) {\n    this.confirm( this.img.naturalWidth !== 0, 'naturalWidth' );\n    this.unbindEvents();\n  }\n};\n\nBackground.prototype.unbindEvents = function() {\n  this.img.removeEventListener( 'load', this );\n  this.img.removeEventListener( 'error', this );\n};\n\nBackground.prototype.confirm = function( isLoaded, message ) {\n  this.isLoaded = isLoaded;\n  this.emitEvent( 'progress', [ this, this.element, message ] );\n};\n\n// -------------------------- jQuery -------------------------- //\n\nImagesLoaded.makeJQueryPlugin = function( jQuery ) {\n  jQuery = jQuery || window.jQuery;\n  if ( !jQuery ) {\n    return;\n  }\n  // set local variable\n  $ = jQuery;\n  // $().imagesLoaded()\n  $.fn.imagesLoaded = function( options, callback ) {\n    var instance = new ImagesLoaded( this, options, callback );\n    return instance.jqDeferred.promise( $(this) );\n  };\n};\n// try making plugin\nImagesLoaded.makeJQueryPlugin();\n\n// --------------------------  -------------------------- //\n\nreturn ImagesLoaded;\n\n});\n","/**\n * matchesSelector v2.0.2\n * matchesSelector( element, '.selector' )\n * MIT license\n */\n\n/*jshint browser: true, strict: true, undef: true, unused: true */\n\n( function( window, factory ) {\n  /*global define: false, module: false */\n  'use strict';\n  // universal module definition\n  if ( typeof define == 'function' && define.amd ) {\n    // AMD\n    define( factory );\n  } else if ( typeof module == 'object' && module.exports ) {\n    // CommonJS\n    module.exports = factory();\n  } else {\n    // browser global\n    window.matchesSelector = factory();\n  }\n\n}( window, function factory() {\n  'use strict';\n\n  var matchesMethod = ( function() {\n    var ElemProto = window.Element.prototype;\n    // check for the standard method name first\n    if ( ElemProto.matches ) {\n      return 'matches';\n    }\n    // check un-prefixed\n    if ( ElemProto.matchesSelector ) {\n      return 'matchesSelector';\n    }\n    // check vendor prefixes\n    var prefixes = [ 'webkit', 'moz', 'ms', 'o' ];\n\n    for ( var i=0; i < prefixes.length; i++ ) {\n      var prefix = prefixes[i];\n      var method = prefix + 'MatchesSelector';\n      if ( ElemProto[ method ] ) {\n        return method;\n      }\n    }\n  })();\n\n  return function matchesSelector( elem, selector ) {\n    return elem[ matchesMethod ]( selector );\n  };\n\n}));\n","(function(a, b) {\n  'object' == typeof exports && 'undefined' != typeof module\n    ? (module.exports = b())\n    : 'function' == typeof define && define.amd ? define(b) : (a.retinajs = b());\n})(this, function() {\n  'use strict';\n  function a(a) {\n    return Array.prototype.slice.call(a);\n  }\n  function b(a) {\n    var b = parseInt(a, 10);\n    return k < b ? k : b;\n  }\n  function c(a) {\n    return (\n      a.hasAttribute('data-no-resize') ||\n        (0 === a.offsetWidth && 0 === a.offsetHeight\n          ? (a.setAttribute('width', a.naturalWidth), a.setAttribute('height', a.naturalHeight))\n          : (a.setAttribute('width', a.offsetWidth), a.setAttribute('height', a.offsetHeight))),\n      a\n    );\n  }\n  function d(a, b) {\n    var d = a.nodeName.toLowerCase(),\n      e = document.createElement('img');\n    e.addEventListener('load', function() {\n      'img' === d ? c(a).setAttribute('src', b) : (a.style.backgroundImage = 'url(' + b + ')');\n    }),\n      e.setAttribute('src', b),\n      a.setAttribute(o, !0);\n  }\n  function e(a, c) {\n    var e = 2 < arguments.length && void 0 !== arguments[2] ? arguments[2] : 1,\n      f = b(e);\n    if (c && 1 < f) {\n      var g = c.replace(l, '@' + f + 'x$1');\n      d(a, g);\n    }\n  }\n  function f(a, b, c) {\n    1 < k && d(a, c);\n  }\n  function g(b) {\n    return b\n      ? 'function' == typeof b.forEach ? b : a(b)\n      : 'undefined' == typeof document ? [] : a(document.querySelectorAll(n));\n  }\n  function h(a) {\n    return a.style.backgroundImage.replace(m, '$2');\n  }\n  function i(a) {\n    g(a).forEach(function(a) {\n      if (!a.getAttribute(o)) {\n        var b = 'img' === a.nodeName.toLowerCase(),\n          c = b ? a.getAttribute('src') : h(a),\n          d = a.getAttribute('data-rjs'),\n          g = !isNaN(parseInt(d, 10));\n        if (null === d) return;\n        g ? e(a, c, d) : f(a, c, d);\n      }\n    });\n  }\n  var j = 'undefined' != typeof window,\n    k = Math.round(j ? window.devicePixelRatio || 1 : 1),\n    l = /(\\.[A-z]{3,4}\\/?(\\?.*)?)$/,\n    m = /url\\(('|\")?([^)'\"]+)('|\")?\\)/i,\n    n = '[data-rjs]',\n    o = 'data-rjs-processed';\n  return (\n    j &&\n      (window.addEventListener('load', function() {\n        i();\n      }),\n      (window.retinajs = i)),\n    i\n  );\n});\n"],"sourceRoot":""}